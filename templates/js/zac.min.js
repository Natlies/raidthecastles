(function(){var require=function(file,cwd){var resolved=require.resolve(file,cwd||"/");var mod=require.modules[resolved];if(!mod)throw new Error("Failed to resolve module "+file+", tried "+resolved);var cached=require.cache[resolved];var res=cached?cached.exports:mod();return res};require.paths=[];require.modules={};require.cache={};require.extensions=[".js",".coffee",".json"];require._core={assert:true,events:true,fs:true,path:true,vm:true};require.resolve=function(){return function(x,cwd){if(!cwd)cwd="/";if(require._core[x])return x;var path=require.modules.path();cwd=path.resolve("/",cwd);var y=cwd||"/";if(x.match(/^(?:\.\.?\/|\/)/)){var m=loadAsFileSync(path.resolve(y,x))||loadAsDirectorySync(path.resolve(y,x));if(m)return m}var n=loadNodeModulesSync(x,y);if(n)return n;throw new Error("Cannot find module '"+x+"'");function loadAsFileSync(x){x=path.normalize(x);if(require.modules[x]){return x}for(var i=0;i<require.extensions.length;i++){var ext=require.extensions[i];if(require.modules[x+ext])return x+ext}}function loadAsDirectorySync(x){x=x.replace(/\/+$/,"");var pkgfile=path.normalize(x+"/package.json");if(require.modules[pkgfile]){var pkg=require.modules[pkgfile]();var b=pkg.browserify;if(typeof b==="object"&&b.main){var m=loadAsFileSync(path.resolve(x,b.main));if(m)return m}else if(typeof b==="string"){var m=loadAsFileSync(path.resolve(x,b));if(m)return m}else if(pkg.main){var m=loadAsFileSync(path.resolve(x,pkg.main));if(m)return m}}return loadAsFileSync(x+"/index")}function loadNodeModulesSync(x,start){var dirs=nodeModulesPathsSync(start);for(var i=0;i<dirs.length;i++){var dir=dirs[i];var m=loadAsFileSync(dir+"/"+x);if(m)return m;var n=loadAsDirectorySync(dir+"/"+x);if(n)return n}var m=loadAsFileSync(x);if(m)return m}function nodeModulesPathsSync(start){var parts;if(start==="/")parts=[""];else parts=path.normalize(start).split("/");var dirs=[];for(var i=parts.length-1;i>=0;i--){if(parts[i]==="node_modules")continue;var dir=parts.slice(0,i+1).join("/")+"/node_modules";dirs.push(dir)}return dirs}}}();require.alias=function(from,to){var path=require.modules.path();var res=null;try{res=require.resolve(from+"/package.json","/")}catch(err){res=require.resolve(from,"/")}var basedir=path.dirname(res);var keys=(Object.keys||function(obj){var res=[];for(var key in obj)res.push(key);return res})(require.modules);for(var i=0;i<keys.length;i++){var key=keys[i];if(key.slice(0,basedir.length+1)===basedir+"/"){var f=key.slice(basedir.length);require.modules[to+f]=require.modules[basedir+f]}else if(key===basedir){require.modules[to]=require.modules[basedir]}}};(function(){var process={};var global=typeof window!=="undefined"?window:{};var definedProcess=false;require.define=function(filename,fn){if(!definedProcess&&require.modules.__browserify_process){process=require.modules.__browserify_process();definedProcess=true}var dirname=require._core[filename]?"":require.modules.path().dirname(filename);var require_=function(file){var requiredModule=require(file,dirname);var cached=require.cache[require.resolve(file,dirname)];if(cached&&cached.parent===null){cached.parent=module_}return requiredModule};require_.resolve=function(name){return require.resolve(name,dirname)};require_.modules=require.modules;require_.define=require.define;require_.cache=require.cache;var module_={id:filename,filename:filename,exports:{},loaded:false,parent:null};require.modules[filename]=function(){require.cache[filename]=module_;fn.call(module_.exports,require_,module_,module_.exports,dirname,filename,process,global);module_.loaded=true;return module_.exports}}})();require.define("path",function(require,module,exports,__dirname,__filename,process,global){function filter(xs,fn){var res=[];for(var i=0;i<xs.length;i++){if(fn(xs[i],i,xs))res.push(xs[i])}return res}function normalizeArray(parts,allowAboveRoot){var up=0;for(var i=parts.length;i>=0;i--){var last=parts[i];if(last=="."){parts.splice(i,1)}else if(last===".."){parts.splice(i,1);up++}else if(up){parts.splice(i,1);up--}}if(allowAboveRoot){for(;up--;up){parts.unshift("..")}}return parts}var splitPathRe=/^(.+\/(?!$)|\/)?((?:.+?)?(\.[^.]*)?)$/;exports.resolve=function(){var resolvedPath="",resolvedAbsolute=false;for(var i=arguments.length;i>=-1&&!resolvedAbsolute;i--){var path=i>=0?arguments[i]:process.cwd();if(typeof path!=="string"||!path){continue}resolvedPath=path+"/"+resolvedPath;resolvedAbsolute=path.charAt(0)==="/"}resolvedPath=normalizeArray(filter(resolvedPath.split("/"),function(p){return!!p}),!resolvedAbsolute).join("/");return(resolvedAbsolute?"/":"")+resolvedPath||"."};exports.normalize=function(path){var isAbsolute=path.charAt(0)==="/",trailingSlash=path.slice(-1)==="/";path=normalizeArray(filter(path.split("/"),function(p){return!!p}),!isAbsolute).join("/");if(!path&&!isAbsolute){path="."}if(path&&trailingSlash){path+="/"}return(isAbsolute?"/":"")+path};exports.join=function(){var paths=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(paths,function(p,index){return p&&typeof p==="string"}).join("/"))};exports.dirname=function(path){var dir=splitPathRe.exec(path)[1]||"";var isWindows=false;if(!dir){return"."}else if(dir.length===1||isWindows&&dir.length<=3&&dir.charAt(1)===":"){return dir}else{return dir.substring(0,dir.length-1)}};exports.basename=function(path,ext){var f=splitPathRe.exec(path)[2]||"";if(ext&&f.substr(-1*ext.length)===ext){f=f.substr(0,f.length-ext.length)}return f};exports.extname=function(path){return splitPathRe.exec(path)[3]||""}});require.define("__browserify_process",function(require,module,exports,__dirname,__filename,process,global){var process=module.exports={};process.nextTick=function(){var canSetImmediate=typeof window!=="undefined"&&window.setImmediate;var canPost=typeof window!=="undefined"&&window.postMessage&&window.addEventListener;if(canSetImmediate){return function(f){return window.setImmediate(f)}}if(canPost){var queue=[];window.addEventListener("message",function(ev){if(ev.source===window&&ev.data==="browserify-tick"){ev.stopPropagation();if(queue.length>0){var fn=queue.shift();fn()}}},true);return function nextTick(fn){queue.push(fn);window.postMessage("browserify-tick","*")}}return function nextTick(fn){setTimeout(fn,0)}}();process.title="browser";process.browser=true;process.env={};process.argv=[];process.binding=function(name){if(name==="evals")return require("vm");else throw new Error("No such module. (Possibly not yet loaded)")};(function(){var cwd="/";var path;process.cwd=function(){return cwd};process.chdir=function(dir){if(!path)path=require("path");cwd=path.resolve(dir,cwd)}})()});require.define("/src/core/namespace.coffee",function(require,module,exports,__dirname,__filename,process,global){(function(){var _base,_base1,_base2,_base3,_base4;if(window.zynga==null){window.zynga={}}if(zynga.ads==null){zynga.ads={}}if((_base=zynga.ads).globals==null){_base.globals={}}if((_base1=zynga.ads.globals).debug==null){_base1.debug={}}if((_base2=zynga.ads.globals)["private"]==null){_base2["private"]={}}if((_base3=zynga.ads).internalAssets==null){_base3.internalAssets={}}if((_base4=zynga.ads.internalAssets).css==null){_base4.css={}}}).call(this)});require.define("/src/core/app.coffee",function(require,module,exports,__dirname,__filename,process,global){(function(){var DEFAULT_TIMEOUT,FB_CLIENT_ID,FIND_SDK_TIMER,FORCE_INITIALIZE_TIMER,INITIALIZE_TIMER,INITIALIZING_TIMER,RETRY_INTERVAL,ZYNGA_ALL_SN_ID,ZYNGA_CLIENT_ID,ZYNGA_COM_SN_ID,callIfReady,facebook,getClientId,getId,getSNId,getZID,hasDAPI,hasSNAPI,hasZDK,is1P,is3P,isArray,logger,manualAuthResponse,manuallyInitialized,map,pollForFBId,reset,snapi,state,timeoutId,timer,zdk;facebook=require("../util/facebook");isArray=require("../util/array").isArray;logger=require("./logger");map=require("../util/array").map;snapi=require("../util/snapi");timer=require("./timer");zdk=require("../util/zdk");FIND_SDK_TIMER=""+__filename+"#initialize";INITIALIZE_TIMER=""+__filename+"#initialize";INITIALIZING_TIMER=""+__filename+"#initialize:state=initializing";FORCE_INITIALIZE_TIMER=""+__filename+"#forceInitialize";FB_CLIENT_ID=1;ZYNGA_CLIENT_ID=6;manuallyInitialized=function(){var _ref,_ref1;return(typeof zynga!=="undefined"&&zynga!==null?(_ref=zynga.ads)!=null?(_ref1=_ref.globals)!=null?_ref1.appData:void 0:void 0:void 0)!=null};hasZDK=function(){return(typeof zynga!=="undefined"&&zynga!==null?zynga.api:void 0)!=null};hasSNAPI=function(){return typeof SNAPI!=="undefined"&&SNAPI!==null};hasDAPI=function(){return typeof DAPI!=="undefined"&&DAPI!==null};is1P=function(){return hasSNAPI()||hasZDK()};is3P=function(){return!is1P()&&(typeof Zynga!=="undefined"&&Zynga!==null?Zynga.events:void 0)!=null};getZID=function(){var _ref,_ref1;if(manuallyInitialized()){return zynga.ads.globals.appData.zid}else if(hasZDK()){return zynga.api.getUser()}else if(is3P()){return Zynga.zid}else if(hasSNAPI()){return(_ref=typeof SNAPI.getCurrentUser==="function"?SNAPI.getCurrentUser():void 0)!=null?_ref:typeof SNAPI.getCurrentUserId==="function"?SNAPI.getCurrentUserId():void 0}else if(hasDAPI()){return(_ref1=typeof DAPI!=="undefined"&&DAPI!==null?typeof DAPI.getCurrentUser==="function"?DAPI.getCurrentUser():void 0:void 0)!=null?_ref1:typeof DAPI!=="undefined"&&DAPI!==null?typeof DAPI.getZid==="function"?DAPI.getZid():void 0:void 0}};getId=function(){var _ref;if(manuallyInitialized()){return zynga.ads.globals.appData.appId}else if(hasZDK()){return zynga.api.getApp()}else if(is3P()){return(_ref=Zynga.appId)!=null?_ref:Zynga.getAppId()}else if(hasSNAPI()){return SNAPI.getAppId()}};getSNId=function(){if(manuallyInitialized()){return zynga.ads.globals.appData.snId}else if(hasZDK()){return zynga.api.getConfig().snId}else if(hasSNAPI()){return SNAPI.getSNID()}else{return null}};pollForFBId=function(){var zid,zidArray;if(hasSNAPI()&&SNAPI.getSNUIDs!=null){zidArray=[];zid=exports.getZID();zidArray.push(zid);return SNAPI.getSNUIDs(zidArray,SNAPI.FACEBOOK,function(map){var _ref,_ref1;return typeof zynga!=="undefined"&&zynga!==null?(_ref=zynga.ads)!=null?(_ref1=_ref.globals)!=null?_ref1.fbId=map[zid]:void 0:void 0:void 0})}};exports.getFBId=function(){var _ref,_ref1;return typeof zynga!=="undefined"&&zynga!==null?(_ref=zynga.ads)!=null?(_ref1=_ref.globals)!=null?_ref1.fbId:void 0:void 0:void 0};manualAuthResponse=function(){if(exports.getClientId()===FB_CLIENT_ID){return{accessToken:zynga.ads.globals.appData.session,userID:exports.getZID()}}else{return{zyngaSession:zynga.ads.globals.appData.session,zid:exports.getZID()}}};exports.getAuthResponse=function(callback,pollingInterval,timeout){if(pollingInterval==null){pollingInterval=1e3}if(timeout==null){timeout=3e4}return exports.initialize(function(){var connections;connections=typeof SNAPI!=="undefined"&&SNAPI!==null?typeof SNAPI.getAllConnections==="function"?SNAPI.getAllConnections():void 0:void 0;if(manuallyInitialized()){return process.nextTick(function(){return callback(null,manualAuthResponse())})}else if(hasZDK()){return zdk.getAuthResponse(callback,timeout)}else if((connections!=null?connections[snapi.FACEBOOK_SNID]:void 0)!=null||(connections!=null?connections[snapi.ZDC_SNID]:void 0)!=null){return snapi.getAuthResponse(callback,connections)}else{return facebook.getAuthResponse(callback,pollingInterval,timeout)}})};ZYNGA_COM_SN_ID=18;ZYNGA_ALL_SN_ID=104;getClientId=function(){switch(getSNId()){case ZYNGA_COM_SN_ID:case ZYNGA_ALL_SN_ID:return ZYNGA_CLIENT_ID;default:return FB_CLIENT_ID}};RETRY_INTERVAL=2500;DEFAULT_TIMEOUT=6e4;state=null;timeoutId=null;reset=function(){state="uninitialized";return timeoutId=null};reset();exports.initializeManually=function(zid,appId,snId,session,callback){var force_timer,_base;force_timer=timer.start(FORCE_INITIALIZE_TIMER);if(state===!"uninitialized"&&state===!"timeout"){process.nextTick(function(){return callback(new Error("Tried to manually initialize app when it had already commenced or completed initialization. Most likely an API method such as zynga.ads.Static.create() was called before zynga.ads.App.initialize()"))});return}if(!(zid!=null&&appId!=null&&snId!=null&&session!=null)){process.nextTick(function(){return callback(new Error("Tried to initialize app without zid, appId, snId, and/or session"))});return}if((_base=zynga.ads.globals).appData==null){_base.appData={}}zynga.ads.globals.appData.zid=zid;zynga.ads.globals.appData.appId=appId;zynga.ads.globals.appData.snId=snId;zynga.ads.globals.appData.session=session;state="ready";if(force_timer!=null){force_timer.complete()}return callback()};exports.initialize=function(callback){var completeHandler,nextStep,retryTimeoutId,sdkReadyHandler,timer_find_sdk,timer_initialize,timer_initializing;timer_initialize=timer.start(INITIALIZE_TIMER);retryTimeoutId=null;timer_find_sdk=null;timer_initializing=null;completeHandler=function(error){if(timer_initialize!=null){timer_initialize.complete()}clearTimeout(retryTimeoutId);clearTimeout(timeoutId);pollForFBId();return process.nextTick(function(){return callback(error)})};sdkReadyHandler=function(){if(getId()==null){logger.log("App ID was not found. ZAC cannot initialize connection to DAPI. The following functions are used to search for app id: zynga.api.getApp(), Zynga.appId, Zynga.getAppId(), SNAPI.getAppId()");return}state="ready";if(timer_find_sdk!=null){timer_find_sdk.complete()}if(timer_initializing!=null){timer_initializing.complete()}return process.nextTick(nextStep)};nextStep=function(){var message;switch(state){case"uninitialized":timeoutId=setTimeout(function(){state="timeout";return nextStep()},DEFAULT_TIMEOUT);state="findingSDK";timer_find_sdk=timer.start(FIND_SDK_TIMER);return process.nextTick(nextStep);case"findingSDK":if(manuallyInitialized()){state="initializing";timer_initializing=timer.start(""+__filename+"#initialize:state=initializing");return sdkReadyHandler()}else if(hasZDK()){state="initializing";timer_initializing=timer.start(INITIALIZING_TIMER);return zynga.api.onInit(sdkReadyHandler)}else if(is3P()){state="initializing";timer_initializing=timer.start(INITIALIZING_TIMER);return Zynga.events.subscribe("clientReady",sdkReadyHandler)}else if(hasSNAPI()){state="initializing";timer_initializing=timer.start(""+__filename+"#initialize:state=initializing");return SNAPI.registerOnload(sdkReadyHandler)}else if(hasDAPI()){state="initializing";timer_initializing=timer.start(INITIALIZING_TIMER);return sdkReadyHandler()}else{return retryTimeoutId=setTimeout(nextStep,RETRY_INTERVAL)}break;case"initializing":return retryTimeoutId=setTimeout(nextStep,RETRY_INTERVAL);case"ready":return completeHandler();case"timeout":message="App initialization timed out: Please make sure you have a working Zynga client SDK initialized, e.g. `SNAPI`, `DAPI`, `zynga.api`, or `Zynga` global. ZAC requires it to retrieve app ID, ZID, SNID, etc.";logger.warn(message);return completeHandler(new Error(message));default:return completeHandler(new Error("Invalid state: "+state))}};return nextStep()};callIfReady=function(method){if(state==="ready"){return method()}else{throw new Error("App module needs to be initialized before usage")}};exports.reset=reset;exports.getZID=function(){return callIfReady(getZID)};exports.getId=function(){return callIfReady(getId)};exports.getSNId=function(){return callIfReady(getSNId)};exports.getClientId=function(){return callIfReady(getClientId)}}).call(this)});require.define("/src/util/facebook.coffee",function(require,module,exports,__dirname,__filename,process,global){(function(){var getFB,isValid;exports.getAuthResponse=function(callback,pollingInterval,timeout){var handleResponse,timedOut,timeoutId;if(pollingInterval==null){pollingInterval=1e3}if(timeout==null){timeout=3e4}if(typeof callback!=="function"){throw new Error("Invalid callback")}timedOut=false;handleResponse=function(response){clearTimeout(timeoutId);return callback(null,response.authResponse)};timeoutId=setTimeout(function(){var displayTimeout;timedOut=true;displayTimeout=timeout/1e3;return callback(new Error("`facebook.getAuthResponse` timed out after "+displayTimeout+" seconds"))},timeout);return getFB(function(error,FB){return FB.getLoginStatus(function(response){var subscriptionHandler;if(!timedOut&&isValid(response)){handleResponse(response);return}subscriptionHandler=function(response){if(!timedOut&&isValid(response)){FB.Event.unsubscribe("auth.authResponseChange",subscriptionHandler);return handleResponse(response)}};return FB.Event.subscribe("auth.authResponseChange",subscriptionHandler)},true)},pollingInterval)};isValid=function(response){return(response!=null?response.authResponse:void 0)!=null};getFB=function(callback,pollingInterval){var step;step=function(){if(typeof FB!=="undefined"&&FB!==null){return process.nextTick(function(){return callback(null,FB)})}else{return setTimeout(step,pollingInterval)}};return step()}}).call(this)});require.define("/src/util/array.coffee",function(require,module,exports,__dirname,__filename,process,global){(function(){exports.toArray=function(object){if(exports.isArray(object)){return object}else{return[object]}};exports.isArray=function(object){if(typeof Array.isArray==="function"){return Array.isArray(object)}else{return Object.prototype.toString.call(object)==="[object Array]"}};exports.append=function(array1,array2){if(!(array1!=null&&array2!=null)){throw new TypeError}return array1.push.apply(array1,array2)};exports.map=function(array,callback){var index,item,_i,_len,_results;if(array==null){throw new TypeError}if(typeof callback!=="function"){throw new TypeError(""+callback+" is not a function")}_results=[];for(index=_i=0,_len=array.length;_i<_len;index=++_i){item=array[index];_results.push(callback(item,index,array))}return _results};exports.filter=function(array,callback){var element;if(!(array!=null&&callback!=null)){throw new TypeError}if(typeof callback!=="function"){throw new TypeError(""+callback+" is not a function")}if(!exports.isArray(array)){throw new TypeError("Can't filter on non-array!")}if(typeof Array.prototype.filter==="function"){return array.filter(callback)}else{return function(){var _i,_len,_results;_results=[];for(_i=0,_len=array.length;_i<_len;_i++){element=array[_i];if(callback(element)){_results.push(element)}}return _results}()}};exports.indexOf=function(array,element){var current,index,_i,_len;if(array==null){throw new TypeError}for(index=_i=0,_len=array.length;_i<_len;index=++_i){current=array[index];if(current===element){return index}}return-1};exports.some=function(array,callback){var index,item,_i,_len;if(array==null){throw new TypeError}if(typeof callback!=="function"){throw new TypeError(""+callback+" is not a function")}for(index=_i=0,_len=array.length;_i<_len;index=++_i){item=array[index];if(callback(item,index,array)){return true}}return false}}).call(this)});require.define("/src/core/logger.coffee",function(require,module,exports,__dirname,__filename,process,global){(function(){var array,browser,createPairs,date,formatForConsole,formatForSplunk,log,serialize,server,_base;require("../core/namespace");array=require("../util/array");browser=require("../util/browser");date=require("../util/date");if((_base=zynga.ads.globals.debug).logs==null){_base.logs=[]}log=function(level,message,data){var logString,timestamp;logString=formatForConsole(level,message,data);browser.log.call(null,logString);zynga.ads.globals.debug.logs.push(logString);if(level==="ERROR"){timestamp=date.now();logString=formatForSplunk(level,message,data);return server.log(level,timestamp,logString)}};createPairs=function(level,message,data){var key,pairs,value;if(typeof message!=="string"){data=message;message=null}if(data instanceof Error){data={error:data}}pairs=[];if(level!=null){pairs.push(["level",level])}if(message!=null){pairs.push(["message",message])}for(key in data){value=data[key];if(value!=null&&typeof value!=="function"){if(key==="error"){pairs.push(["errorMessage",value.message]);pairs.push(["errorStack",value.stack])}else{pairs.push([key,value])}}}return pairs};serialize=function(key){var error;if(key==null){return null}try{if(key instanceof Error&&key.toJSON==null){return key.toString()}else if(typeof key!=="string"){return JSON.stringify(key)}else{return key}}catch(_error){error=_error;return error.toString()}};formatForConsole=function(level,message,data){var logLine;message=serialize(message);logLine="ZAC: "+level+": "+message;if(data!=null){logLine+=" | "+JSON.stringify(data)}return logLine};formatForSplunk=function(level,message,data){var key,line,pair,pairs,value,_i,_len;pairs=createPairs(level,message,data);line=[];for(_i=0,_len=pairs.length;_i<_len;_i++){pair=pairs[_i];key=pair[0];value=pair[1];value=serialize(value);line.push(""+key+"="+JSON.stringify(value))}return message=line.join(", ")};server={buffer:[],log:function(level,timestamp,message){var AdEngine,_ref,_ref1,_ref2,_ref3,_results;this.buffer.push({level:level,message:message,timestamp:timestamp});AdEngine=typeof zynga!=="undefined"&&zynga!==null?(_ref=zynga.ads)!=null?(_ref1=_ref.globals)!=null?_ref1.AdEngine:void 0:void 0:void 0;if(AdEngine!=null){_results=[];while(((_ref3=this.buffer)!=null?_ref3.length:void 0)>0){_ref2=this.buffer.shift(),level=_ref2.level,message=_ref2.message,timestamp=_ref2.timestamp;_results.push(zynga.ads.globals.AdEngine.trace(level,message,timestamp))}return _results}}};exports.debug=function(message,data){return log("DEBUG",message,data)};exports.info=exports.log=function(message,data){return log("INFO",message,data)};exports.warn=function(message,data){return log("WARN",message,data)};exports.error=function(message,data){return log("ERROR",message,data)};exports.collectLogs=function(logs){if((logs!=null?logs.length:void 0)>0){return array.append(zynga.ads.globals.debug.logs,array.toArray(logs))}};exports.getLogs=function(){return zynga.ads.globals.debug.logs};exports.flushLogs=function(){return zynga.ads.globals.debug.logs=[]}}).call(this)});require.define("/src/util/browser.coffee",function(require,module,exports,__dirname,__filename,process,global){(function(){var array,debug,getClassList,meta,setClassList,_ref;array=require("./array");meta=require("../core/meta");debug=require("../core/debug");exports.ie=(typeof navigator!=="undefined"&&navigator!==null?(_ref=navigator.userAgent)!=null?_ref.indexOf("MSIE"):void 0:void 0)!==-1;exports.getProtocol=function(){return location.protocol.slice(0,-1)};exports.getViewportWidth=function(){var _ref1;return(_ref1=window.innerWidth)!=null?_ref1:document.documentElement.clientWidth};exports.getViewportHeight=function(){var _ref1;return(_ref1=window.innerHeight)!=null?_ref1:document.documentElement.clientHeight};exports.log=function(){var i,_results;if(!debug.getZACLogToConsole()){return}if(typeof console!=="undefined"&&typeof console.log==="function"){if(window.opera){i=0;_results=[];while(i<arguments.length){console.log("Item "+(i+1)+": "+arguments[i]);_results.push(i++)}return _results}else if(Array.prototype.slice.call(arguments).length===1&&typeof Array.prototype.slice.call(arguments)[0]==="string"){return console.log(Array.prototype.slice.call(arguments).toString())}else{return console.log.apply(console,Array.prototype.slice.call(arguments))}}else if(Function.prototype.bind&&(typeof console==="object"||typeof console==="function")&&typeof console.log==="object"){return Function.prototype.bind.call(console.log,console).apply(console,arguments)}else if(!Function.prototype.bind&&typeof console!=="undefined"&&typeof console.log==="object"){return Function.prototype.call.call(console.log,console,Array.prototype.slice.call(arguments))}};exports.ping=function(url){var image;if(!(url!=null&&url.length>0)){return}image=new Image;return image.src=url};exports.addEventListener=function(target,type,listener){if(target.addEventListener!=null){return target.addEventListener(type,listener,false)}else{return target.attachEvent("on"+type,listener)}};exports.removeEventListener=function(target,type,listener){if(target.removeEventListener!=null){return target.removeEventListener(type,listener,false)}else{return target.detachEvent("on"+type,listener)}};exports.onDocumentLoad=function(callback){if(document.addEventListener!=null){return document.addEventListener("DOMContentLoaded",callback,false)}else{return document.attachEvent("onreadystatechange",function(){if(document.readyState==="complete"){return callback()}})}};getClassList=function(element){var classAttribute;classAttribute=element.getAttribute("class");if(classAttribute==null){return[]}return array.filter(classAttribute.split(" "),function(className){return className.length>0})};setClassList=function(element,classList){var value;value=classList.join(" ");if(element.className!=null){return element.className=value}else{return element.setAttribute("class",value)}};exports.addCSSRule=function(css){var d,e;if(!exports.ie){d=document.createElement("style");d.type="text/css";d.textContent=css;return document.getElementsByTagName("head")[0].appendChild(d)}else{try{return document.createStyleSheet().cssText=css}catch(_error){e=_error;if(document.styleSheets[0]){return document.styleSheets[0].cssText+=css}}}};exports.removeClass=function(element,classNameToRemove){var classList,newClassList;classList=getClassList(element);newClassList=array.filter(classList,function(className){return className!==classNameToRemove});return setClassList(element,newClassList)};exports.addClass=function(element,className){var classList;classList=getClassList(element);classList.push(className);return setClassList(element,classList)};exports.getHTMLForSWF=function(swfURL,width,height,id,params){var idForIE,idForOther,name,paramList,value;idForIE="";idForOther="";if(id!=null){idForIE='id="'+id+'_IE"';idForOther='id="'+id+'"'}paramList="";for(name in params){value=params[name];paramList+='<param name="'+name+'" value="'+value+'" />'}return'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"\n    width="'+width+'" height="'+height+'" '+idForIE+'>\n    <param name="movie" value="'+swfURL+'" />\n    <param name="allowScriptAccess" value="always" />\n    '+paramList+'\n    <!--[if !IE]>-->\n    <object type="application/x-shockwave-flash"\n            data="'+swfURL+'"\n            width="'+width+'" height="'+height+'" '+idForOther+'>\n      <param name="movie" value="'+swfURL+'" />\n      <param name="allowScriptAccess" value="always" />\n      '+paramList+"\n    <!--<![endif]-->\n      <!-- TODO: Alternate content -->\n    <!--[if !IE]>-->\n    </object>\n    <!--<![endif]-->\n</object>"};exports.setParams=function(url,encode,params){var key,newURL,prefix,value;newURL=url;for(key in params){value=params[key];prefix="&";if(newURL.indexOf("?")<0){prefix="?"}if(encode){value=encodeURIComponent(value)}newURL+=""+prefix+key+"="+value}return newURL};exports.getPageURI=function(){return window.location.href}}).call(this)});require.define("/src/core/meta.coffee",function(require,module,exports,__dirname,__filename,process,global){(function(){exports.VERSION="1.24.3-35-gafe9db3";exports.ENV="production";exports.NAMESPACE="1"}).call(this)});require.define("/src/core/debug.coffee",function(require,module,exports,__dirname,__filename,process,global){(function(){var querystring,svQAMode,zacAdEngineDebugMode,zacAdEngineURL,zacAutoSetupTrialPay,zacDAPIHost,zacLogToConsole,_base,_base1,_base2,_base3,_ref;require("../core/namespace");querystring=require("../util/querystring");_ref=querystring.parse(),zacAdEngineDebugMode=_ref.zacAdEngineDebugMode,zacAdEngineURL=_ref.zacAdEngineURL,zacAutoSetupTrialPay=_ref.zacAutoSetupTrialPay,zacDAPIHost=_ref.zacDAPIHost,svQAMode=_ref.svQAMode,zacLogToConsole=_ref.zacLogToConsole;zacAdEngineDebugMode=zacAdEngineDebugMode==="true";zacAutoSetupTrialPay=zacAutoSetupTrialPay==="true";svQAMode=svQAMode==="true";zacLogToConsole=zacLogToConsole==="true";if((_base=zynga.ads.globals.debug).zacAdEngineDebugMode==null){_base.zacAdEngineDebugMode=zacAdEngineDebugMode}if((_base1=zynga.ads.globals.debug).zacAutoSetupTrialPay==null){_base1.zacAutoSetupTrialPay=zacAutoSetupTrialPay}if((_base2=zynga.ads.globals.debug).svQAMode==null){_base2.svQAMode=svQAMode}if((_base3=zynga.ads.globals.debug).zacLogToConsole==null){_base3.zacLogToConsole=zacLogToConsole}exports.zacDAPIHost=zacDAPIHost;exports.zacAdEngineURL=zacAdEngineURL;exports.getZACAutoSetupTrialPay=function(){return zynga.ads.globals.debug.zacAutoSetupTrialPay};exports.getZACAdEngineDebugMode=function(){return zynga.ads.globals.debug.zacAdEngineDebugMode};exports.getSVQAMode=function(){return zynga.ads.globals.debug.svQAMode};exports.getZACLogToConsole=function(){return zynga.ads.globals.debug.zacLogToConsole};exports.generateGUID=function(displayHyphens){var template;if(displayHyphens==null){displayHyphens=true}template="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";if(!displayHyphens){template=template.replace(/[-]/g,function(){return""})}return template.replace(/[xy]/g,function(c){var r,v;r=Math.floor(Math.random()*16);v=c==="x"?r:r&3|8;return v.toString(16)})}}).call(this)});require.define("/src/util/querystring.coffee",function(require,module,exports,__dirname,__filename,process,global){(function(){var querystring;querystring=require("querystring-component");exports.parse=function(){var query,_ref;query=typeof location!=="undefined"&&location!==null?(_ref=location.search)!=null?_ref.substr(1):void 0:void 0;return querystring.parse(query)}}).call(this)});require.define("/node_modules/querystring-component/package.json",function(require,module,exports,__dirname,__filename,process,global){module.exports={}});require.define("/node_modules/querystring-component/index.js",function(require,module,exports,__dirname,__filename,process,global){var trim=require("trim");exports.parse=function(str){if("string"!=typeof str)return{};str=trim(str);if(""==str)return{};var obj={};var pairs=str.split("&");for(var i=0;i<pairs.length;i++){var parts=pairs[i].split("=");obj[parts[0]]=null==parts[1]?"":decodeURIComponent(parts[1])}return obj};exports.stringify=function(obj){if(!obj)return"";var pairs=[];for(var key in obj){pairs.push(encodeURIComponent(key)+"="+encodeURIComponent(obj[key]))}return pairs.join("&")}});require.define("/node_modules/querystring-component/node_modules/trim/package.json",function(require,module,exports,__dirname,__filename,process,global){module.exports={main:"index"}});require.define("/node_modules/querystring-component/node_modules/trim/index.js",function(require,module,exports,__dirname,__filename,process,global){exports=module.exports=trim;function trim(str){return str.replace(/^\s*|\s*$/g,"")}exports.left=function(str){return str.replace(/^\s*/,"")};exports.right=function(str){return str.replace(/\s*$/,"")}});require.define("/src/util/date.coffee",function(require,module,exports,__dirname,__filename,process,global){(function(){exports.nowUTC=function(){return(new Date).toUTCString()};exports.now=function(){return(new Date).getTime()}}).call(this)});require.define("/src/util/snapi.coffee",function(require,module,exports,__dirname,__filename,process,global){(function(){var app;app=require("../core/app");exports.FACEBOOK_SNID=1;exports.ZDC_SNID=104;exports.getAuthResponse=function(callback,connections){var authResponse,facebookConnection,zdcConnection;if(typeof callback!=="function"){throw new Error("Invalid callback")}authResponse={};facebookConnection=connections[exports.FACEBOOK_SNID];zdcConnection=connections[exports.ZDC_SNID];if(facebookConnection!=null){authResponse.accessToken=facebookConnection.session.access_token;authResponse.userID=facebookConnection.session.user_id}else if(zdcConnection!=null){authResponse.zyngaSession=zdcConnection.session.token;authResponse.zid=zdcConnection.session.zid}return process.nextTick(function(){return callback(null,authResponse)})}}).call(this)});require.define("/src/core/timer.coffee",function(require,module,exports,__dirname,__filename,process,global){(function(){var Timer,browser,date,timers,_base;require("./namespace");browser=require("../util/browser");date=require("../util/date");timers=(_base=zynga.ads.globals).timers!=null?(_base=zynga.ads.globals).timers:_base.timers={};
exports.start=function(label){var timer;if(timers[label]==null){timer=new Timer(label);timers[label]=timer;return timers[label]}else{return null}};exports.complete=function(label){var timer;timer=timers[label];if(timer==null){throw new Error("Timer '"+label+"' does not exist.")}timer.complete();return timer};exports.printReport=function(){var label,timer,_results;_results=[];for(label in timers){timer=timers[label];_results.push(browser.log("ZAC: DEBUG: Timer: "+label+": "+timer.duration))}return _results};Timer=function(){function Timer(label){this.label=label;if(this.label==null){throw new Error("Argument 'label' is required.")}this.start=date.now();this.end=null;this.duration=null;this.resolution="ms"}Timer.prototype.complete=function(){this.end=date.now();return this.duration=this.end-this.start};return Timer}()}).call(this)});require.define("/src/util/zdk.coffee",function(require,module,exports,__dirname,__filename,process,global){(function(){var app;app=require("../core/app");exports.getAuthResponse=function(callback,timeout){var handleResponse,timedOut,timeoutId;if(timeout==null){timeout=3e4}if(typeof callback!=="function"){throw new Error("Invalid callback")}timedOut=false;handleResponse=function(authResponse){clearTimeout(timeoutId);return callback(null,authResponse)};timeoutId=setTimeout(function(){var displayTimeout;timedOut=true;displayTimeout=timeout/1e3;return callback(new Error("`zdk.getAuthResponse` timed out after "+displayTimeout+" seconds"))},timeout);return zynga.api.onInit(function(){var authResponse;if(!timedOut){authResponse={};authResponse.zid=zynga.api.getUser();authResponse.accessToken=zynga.api.getConfig().accessToken;authResponse.zyngaSession=zynga.api.getConfig().session;handleResponse(authResponse)}})}}).call(this)});require.define("/src/util/object.coffee",function(require,module,exports,__dirname,__filename,process,global){(function(){var browser,getCopy,isArray;browser=require("./browser");isArray=require("./array").isArray;exports.filter=function(items,removeTest){var item,prop;for(prop in items){item=items[prop];if(removeTest(item)){delete items[prop]}}return items!=null?items:{}};exports.isEmpty=function(item){var prop;if(item!=null){for(prop in item){return false}}return true};getCopy=function(item){if(typeof item==="object"){return exports.clone(item)}else{return item}};exports.clone=function(item){var clone,innerItem,prop,_i,_len;if(typeof item!=="object"){throw new TypeError("This method only clones objects.")}clone={};if(isArray(item)){clone=[];for(_i=0,_len=item.length;_i<_len;_i++){innerItem=item[_i];clone.push(getCopy(innerItem))}}else{for(prop in item){clone[prop]=getCopy(item[prop])}}return clone}}).call(this)});require.define("/src/util/promise.coffee",function(require,module,exports,__dirname,__filename,process,global){(function(){var Promise;Promise=function(){function Promise(){this.successCallbacks=[];this.errorCallbacks=[]}Promise.prototype.state="unfulfilled";Promise.prototype.success=function(callback){var _this=this;if(this.state==="resolved"){process.nextTick(function(){return callback(_this.result)})}else if(this.state==="unfulfilled"){this.successCallbacks.push(callback)}return this};Promise.prototype.error=function(callback){var _this=this;if(this.state==="rejected"){process.nextTick(function(){return callback(_this.errorMessage)})}else if(this.state==="unfulfilled"){this.errorCallbacks.push(callback)}return this};Promise.prototype.resolveWith=function(result,postResolveCallback){var _this=this;this.result=result;if(postResolveCallback==null){postResolveCallback=null}return process.nextTick(function(){var callback,_i,_len,_ref;if(_this.state!=="unfulfilled"){throw new Error("Invalid state: '"+_this.state+"'. Expected 'unfulfilled'.")}_this.state="resolved";_ref=_this.successCallbacks;for(_i=0,_len=_ref.length;_i<_len;_i++){callback=_ref[_i];if(typeof callback==="function"){callback(_this.result)}}return typeof postResolveCallback==="function"?postResolveCallback():void 0})};Promise.prototype.rejectWith=function(errorMessage){var _this=this;this.errorMessage=errorMessage;return process.nextTick(function(){var callback,_i,_len,_ref,_results;if(_this.state!=="unfulfilled"){throw new Error("Invalid state: '"+_this.state+"'. Expected 'unfulfilled'.")}_this.state="rejected";_ref=_this.errorCallbacks;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){callback=_ref[_i];_results.push(typeof callback==="function"?callback(_this.errorMessage):void 0)}return _results})};return Promise}();module.exports=Promise}).call(this)});require.define("/src/core/services.coffee",function(require,module,exports,__dirname,__filename,process,global){(function(){var Promise,app,browser,experimentation,loadService,logger,script,servicePromises,services,timer;app=require("./app");browser=require("../util/browser");experimentation=require("./experimentation");logger=require("./logger");Promise=require("../util/promise");script=require("./script");timer=require("./timer");services={};servicePromises={};exports.get=function(name){var promise,service;timer.start(""+__filename+"#get:"+name);promise=new Promise;service=services[name];if(service!=null){promise.resolveWith(service);return promise}if(servicePromises[name]!=null){servicePromises[name].push(promise);return promise}loadService(name,promise);return promise};loadService=function(name,promise){servicePromises[name]=[promise];return experimentation.getBaseURL(function(error,baseURL){var extension,url;if(error!=null){logger.log("ZAC: ERROR: Failed to retrieve ZAC base URL. Cause: "+(error!=null?error.message:void 0));return}extension=script.getExtension();url=""+baseURL+"/services/"+name.toLowerCase()+extension;return script.load(url)})};exports.add=function(name,service){var promise,_i,_len,_ref;timer.complete(""+__filename+"#get:"+name);services[name]=service;_ref=servicePromises[name];for(_i=0,_len=_ref.length;_i<_len;_i++){promise=_ref[_i];promise.resolveWith(service)}}}).call(this)});require.define("/src/core/experimentation.coffee",function(require,module,exports,__dirname,__filename,process,global){(function(){var APPS_WHITELIST,CONFIGURATION_SLOT,CONFIGURATION_TIMEOUT,GET_BASE_URL_TIMER,RETRY_INTERVAL,adEngineProxyURL,app,configurationBaseURL,error,experimentation,logger,meta,parse,qs,querystring,result,script,state,timer,zacAdEngineProxyURL;app=require("./app");experimentation=require("./configuration").experimentation;logger=require("./logger");meta=require("./meta");qs=require("querystring-component");querystring=require("../util/querystring");script=require("./script");timer=require("./timer");GET_BASE_URL_TIMER=""+__filename+"#getBaseURL";state="uninitialized";result=null;error=null;CONFIGURATION_TIMEOUT=experimentation.timeout;CONFIGURATION_SLOT=experimentation.slot;APPS_WHITELIST=experimentation.apps;RETRY_INTERVAL=2500;zacAdEngineProxyURL=querystring.parse().zacAdEngineProxyURL;adEngineProxyURL=zacAdEngineProxyURL!=null?zacAdEngineProxyURL:meta.ENV==="production"?""+location.protocol+"//r.ads.zynga.com":""+location.protocol+"//r.staging.ads.zynga.com";configurationBaseURL=""+adEngineProxyURL+"/redirector/configurations";parse=function(response){var baseURL,configuration,creative,message,nextState,_ref,_ref1,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7,_ref8;creative=(_ref=response.adSlots)!=null?(_ref1=_ref[0])!=null?(_ref2=_ref1.lineItems)!=null?(_ref3=_ref2[0])!=null?(_ref4=_ref3.creatives)!=null?_ref4[0]:void 0:void 0:void 0:void 0:void 0;configuration=creative!=null?(_ref5=creative.contents)!=null?(_ref6=_ref5[0])!=null?_ref6.payload:void 0:void 0:void 0;baseURL=configuration!=null?configuration.baseURL:void 0;if(baseURL!=null){logger.debug("Ad engine configuration request succeeded. ZAC configuration: "+JSON.stringify(configuration,null," "));nextState="ready"}else{message="Ad engine configuration request failed.";if((response!=null?(_ref7=response.error)!=null?_ref7.message:void 0:void 0)!=null){message+=" Cause: "+(response!=null?(_ref8=response.error)!=null?_ref8.message:void 0:void 0)}logger.warn(message);baseURL=script.getBaseURL();nextState="requestError"}return{state:nextState,baseURL:baseURL}};exports.getBaseURL=function(callback){var nextStep,timer_getBaseURL;timer_getBaseURL=timer.start(GET_BASE_URL_TIMER);nextStep=function(){switch(state){case"uninitialized":state="initializing";return app.initialize(function(error){var appId,clientId,configurationTimeoutId,parameters,query,snId,zid;if(error!=null){callback(error);return}appId=app.getId();zid=app.getZID();snId=app.getSNId();clientId=app.getClientId();if(APPS_WHITELIST[appId]==null){result=script.getBaseURL();state="appNotWhitelisted";process.nextTick(nextStep);return}configurationTimeoutId=setTimeout(function(){zynga.ads.globals.configurationHandler=function(){};result=script.getBaseURL();state="requestTimeout";return nextStep()},CONFIGURATION_TIMEOUT);zynga.ads.globals.configurationHandler=function(response){var baseURL,_ref;timer.complete(""+__filename+"#loadConfiguration");clearTimeout(configurationTimeoutId);_ref=parse(response),state=_ref.state,baseURL=_ref.baseURL;result=baseURL;return process.nextTick(nextStep)};parameters={gid:appId,zid:zid,snid:snId,clientId:clientId,callback:"zynga.ads.globals.configurationHandler"};query=qs.stringify(parameters);timer.start(""+__filename+"#loadConfiguration");return script.load(""+configurationBaseURL+"/"+CONFIGURATION_SLOT+"?"+query)});case"initializing":return setTimeout(nextStep,RETRY_INTERVAL);case"requestError":logger.warn("Ad engine configuration request failed. Using fallback base URL: "+result+".");return process.nextTick(function(){return callback(null,result)});case"requestTimeout":logger.warn("Ad engine configuration request timed out. Using fallback base URL: "+result);return process.nextTick(function(){return callback(null,result)});case"appNotWhitelisted":return app.initialize(function(error){logger.info("App ID "+app.getId()+" is using fallback base URL: "+result);timer.complete(""+__filename+"#getBaseURL");return callback(null,result)});case"ready":if(result==null){state="resultMissing";process.nextTick(nextStep);return}logger.debug("Ad engine configuration request succeeded. Using base URL: "+result);return process.nextTick(function(){if(timer_getBaseURL!=null){timer_getBaseURL.complete()}return callback(null,result)});default:return process.nextTick(function(){return callback(new Error("Invalid state: "+state))})}};return nextStep()};exports.reset=function(){state="uninitialized";result=null;return error=null}}).call(this)});require.define("/src/core/configuration.coffee",function(require,module,exports,__dirname,__filename,process,global){(function(){module.exports={experimentation:{description:"Mapping of app ID to base URL of ZAC client",timeout:1e4,slot:"ZAP_ZAC_CONFIGURATION",apps:{1:true,63:true,67:true,75:true,81:true,91:true,114:true,115:true,118:true,223:true,240:true,241:true,243:true,254:true,5000630:true,0xcfae78295ed4:true,5000379:true,5002366:true}},initializationDelay:{"default":0,preferred:{slots:{description:"Slots with specific initialization delays",values:{},patterns:{BILL:10,_MH$:10,_MH_:10}}},apps:{description:"Mapping of app ID to DAPI initialization delay in seconds",1:30,63:60,75:30,81:20,90:20,91:10,115:20,118:30,223:30,239:20,240:30,241:30,5000972:30,5002020:30,5002366:15},trump:{slots:{description:"Slots whose delay takes precedence over the app",values:{WEB_EXAMPLE_BAC:0,WEB_EXAMPLE_728T:0,WEB_EXAMPLE_300L:0,WEB_EXAMPLE_300M:0,WEB_EXAMPLE_300R:0},patterns:{_FEED_:0,_ZSC_:0,_BH_ZSC:0,_PP_ZSC:0,_XGAMEREQUESTS:0,_XANNOUNCEMENT:0,_XBANNER:0,_XBAR:0,WEB_FAIRYTALE_I12:0}}}},slot:{description:"Mapping of slot ID to ID for client-side slot redirection",slots:{}},display:{arbitration:{description:"Should slots participate in display arbitration (defaultis true)",values:{},patterns:{_FEED_:false}},report:{description:"Should slots report from client (default is true)",values:{},patterns:{}}}}}).call(this)});require.define("/src/core/script.coffee",function(require,module,exports,__dirname,__filename,process,global){(function(){var DOCUMENTATION_URL,SCRIPT_ID,endsWith,parseURI;endsWith=require("../util/string").endsWith;parseURI=require("../util/parse_uri");SCRIPT_ID="zac-js-sdk";DOCUMENTATION_URL="https://github-ca.corp.zynga.com/zap/zac/tree/master/docs/integration";exports.load=function(url){var node,script;script=document.createElement("script");script.async=true;script.type="text/javascript";script.src=url;node=document.getElementsByTagName("script")[0];return node.parentNode.insertBefore(script,node)};exports.getURL=function(){var script;script=document.getElementById(SCRIPT_ID);if(script==null){throw new Error("Can’t find script tag with ID '"+SCRIPT_ID+"'. Please     include the ZAC JS SDK using a script tag with ID '"+SCRIPT_ID+"',     i.e. <script id=\""+SCRIPT_ID+'" src"..."></script>, as outlined in the     documentation: '+DOCUMENTATION_URL)}return script.src};exports.getExtension=function(){var error,url;try{url=parseURI(exports.getURL())}catch(_error){error=_error;return".js"}if(endsWith(url.path,".min.js")){return".min.js"}else{return".js"}};exports.getBaseName=function(url){var SUFFIX,base,index,source;source=url;if(url==null){return null}index=source.lastIndexOf("/");if(index===-1){return""}base=source.substring(0,index);SUFFIX="/includes";if(endsWith(base,SUFFIX)){base=source.substring(0,base.length-SUFFIX.length)}return base};exports.getBaseURL=function(){var url;url=exports.getURL();return exports.getBaseName(url)}}).call(this)});require.define("/src/util/string.coffee",function(require,module,exports,__dirname,__filename,process,global){(function(){exports.startsWith=function(string,prefix){return string.indexOf(prefix)===0};exports.endsWith=function(string,suffix){return string.indexOf(suffix,string.length-suffix.length)!==-1}}).call(this)});require.define("/src/util/parse_uri.js",function(require,module,exports,__dirname,__filename,process,global){var parseUri=module.exports=function parseUri(str){var o=parseUri.options,m=o.parser[o.strictMode?"strict":"loose"].exec(str),uri={},i=14;while(i--)uri[o.key[i]]=m[i]||"";uri[o.q.name]={};uri[o.key[12]].replace(o.q.parser,function($0,$1,$2){if($1)uri[o.q.name][$1]=$2});return uri};parseUri.options={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}}});require.define("/src/services/w2e/sync_bridge.coffee",function(require,module,exports,__dirname,__filename,process,global){(function(){var SyncBridge,logger,proxy,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};logger=require("../../core/logger");proxy=require("./proxy");SyncBridge=function(){function SyncBridge(){this.proxyEvent=__bind(this.proxyEvent,this)}SyncBridge.prototype.service=null;SyncBridge.prototype.state="uninitialized";SyncBridge.prototype.w2ePromise=null;SyncBridge.prototype.slotIds=[];SyncBridge.prototype.initialize=function(slotIds,containerId,options){var _this=this;this.slotIds=slotIds;if(options==null){options={}}if(this.state!=="uninitialized"){logger.warn("The W2E service is already initializing");return}this.state="initializing";this.w2ePromise=zynga.ads.WatchToEarn.create(this.slotIds,containerId,options);return this.w2ePromise.success(function(s){var id,init,slot,_i,_len,_ref;_this.service=s;if(_this.game!=null){_this.service.bind("pauseGame",_this.proxyEvent("pauseGame","service"));_this.service.bind("resumeGame",_this.proxyEvent("resumeGame","service"));_ref=_this.slotIds;for(_i=0,_len=_ref.length;_i<_len;_i++){id=_ref[_i];slot=_this.service.getSlot(id);slot.bind("pauseGame",_this.proxyEvent("pauseGame","slot"));slot.bind("resumeGame",_this.proxyEvent("resumeGame","slot"));slot.bind("change",_this.proxyEvent("change","slot"));slot.bind("activityComplete",_this.proxyEvent("activityComplete","slot"))}if(typeof SNAPI!=="undefined"&&SNAPI!==null){SNAPI.registerOnload(function(){if(SNAPI.GameMessages!=null){return SNAPI.GameMessages.listen("w2eComplete",function(args){var event;event=args!=null?args[0]:void 0;if(event==null||event.payload==null||event.slotId==null||event.reward==null){logger.error("GameMessages 'w2eComplete' missing required fields. Expected an event with `payload`, `slotId`, and `reward`. Got: "+JSON.stringify(event));return}return _this.proxyEvent("activityComplete","slot")(event)})}})}}_this.state="initialized";init=_this.proxyEvent("initialize","service");return init()})};SyncBridge.prototype.initializeFlash=function(objectId,slotIds,containerId,options){if(options==null){options={}}if(this.state!=="uninitialized"){logger.warn("The W2E service is already initializing (Flash)");return}this.game=document.getElementById(objectId);if(this.game==null){logger.error("The objectId passed to initializeFlash is invalid.ObjectId: "+objectId+". AdSlots: "+slotIds);return}if(typeof slotIds==="string"){slotIds=[slotIds]}return this.initialize(slotIds,containerId,options)};SyncBridge.prototype.available=function(slotId){var _this=this;if(this.service==null){logger.warn("Failed to check availability for slot "+slotId+" because service is not yet initialized");return false}return this.wrapCall(function(){return _this.service.getSlot(slotId).available()},false)};SyncBridge.prototype.reportStatus=function(slotId){var _this=this;if(this.service==null){logger.warn("Failed to track status for slot "+slotId+" because service is not yet initialized");return}return this.wrapCall(function(){return _this.service.getSlot(slotId).reportStatus()},null)};SyncBridge.prototype.getReward=function(slotId){var _this=this;if(this.service==null){logger.warn("Failed to get reward for slot "+slotId+" because service is not yet initialized");return}return this.wrapCall(function(){return _this.service.getSlot(slotId).getReward()},null)};SyncBridge.prototype.getAsset=function(slotId,name){var _this=this;if(this.service==null){logger.warn("Failed to get asset for slot "+slotId+" because service is not yet initialized");return}return this.wrapCall(function(){return _this.service.getSlot(slotId).getAsset(name)},null)};SyncBridge.prototype.startActivity=function(slotId){var _this=this;if(this.service==null){logger.warn("Failed to run activty for slot "+slotId+" because service is not yet initialized");return}return this.wrapCall(function(){return _this.service.getSlot(slotId).startActivity()},false)};SyncBridge.prototype.status=function(slotId){var _this=this;if(this.service==null){logger.warn("Failed to run activity for slot "+slotId+" because service is not yet initialized");return"jsServiceLayerNotInitialized"}return this.wrapCall(function(){return _this.service.getSlot(slotId).status()},"flashBridgeError")};SyncBridge.prototype.proxyEvent=function(type,origin){return proxy.proxyEvent(this.game,this.slotIds,type,origin)};SyncBridge.prototype.wrapCall=function(call,errorReturn){var error;try{return call()}catch(_error){error=_error;logger.error("Failed to execute service call due to error '"+error.message+"': "+call);return errorReturn}};return SyncBridge}();module.exports=SyncBridge}).call(this)});require.define("/src/services/w2e/proxy.coffee",function(require,module,exports,__dirname,__filename,process,global){(function(){var logger,_this=this,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++){if(i in this&&this[i]===item)return i}return-1};logger=require("../../core/logger");exports.proxyEvent=function(game,slotIds,type,origin){if((game!=null?game.zynga_ads_w2e_dispatchEvent:void 0)==null){throw new Error("zynga_ads_w2e_dispatchEvent not a property on given game object: "+game)}return function(event){var error,slot,_ref;if(event==null){event={}}slot=event.slot;if(slot!=null){delete event.slot;event.slotId=slot.slotId}event.type=type;event.origin=origin;if(event.type==="activityComplete"&&slotIds!=null&&!(_ref=event.slotId,__indexOf.call(slotIds,_ref)>=0)){event.type="arbitraryActivityComplete"}try{return game.zynga_ads_w2e_dispatchEvent(event)}catch(_error){error=_error;return logger.error("Proxy: dispatchEvent failed in Flash game -error: "+error.message)}}}}).call(this)});require.define("/src/zac.coffee",function(require,module,exports,__dirname,__filename,process,global){(function(){var ADENGINE_CREATE_TIMER,ADENGINE_SERVICE_CREATE_TIMER,AdEngine,App,Expandable,Interstitial,Promise,STATIC_CREATE_TIMER,STATIC_SERVICE_CREATE_TIMER,Static,Video,W2ESyncBridge,WatchToEarn,XBar,app,clone,getParams,meta,name,printTimingReport,service,services,timer;require("./core/namespace");app=require("./core/app");clone=require("./util/object").clone;meta=require("./core/meta");Promise=require("./util/promise");services=require("./core/services");timer=require("./core/timer");W2ESyncBridge=require("./services/w2e/sync_bridge");STATIC_CREATE_TIMER=""+__filename+"#Static.create";STATIC_SERVICE_CREATE_TIMER=""+__filename+"#Static.create:service.create";ADENGINE_CREATE_TIMER=""+__filename+"#AdEngine.create";ADENGINE_SERVICE_CREATE_TIMER=""+__filename+"#AdEngine.selectAds:service.create";printTimingReport=function(){return setTimeout(timer.printReport,1e4)};getParams=function(options){var params;if((options!=null?options.context:void 0)==null){return{}}params={};params.context=clone(options.context);params.testMode=options.testMode;params.useRandomId=options.useRandomId;return params};Static=function(){function Static(){}Static.create=function(slotId,containerId,options){var params,promise,timer_create,_this=this;params=getParams(options);promise=new Promise;timer_create=timer.start(STATIC_CREATE_TIMER);services.get("Static").success(function(service){var staticService,timer_service_create;if(timer_create!=null){timer_create.complete()}_this.VERSION=service.VERSION;timer_service_create=timer.start(STATIC_SERVICE_CREATE_TIMER);return staticService=service.create(slotId,containerId,params,function(error){if(timer_service_create!=null){timer_service_create.complete()}printTimingReport();if(error!=null){return promise.rejectWith(error)}else{return promise.resolveWith(staticService)}})});return promise};Static.get=function(slotId,options){var promise;promise=new Promise;services.get("Static").success(function(service){var staticService;staticService=service.get(slotId,options);return promise.resolveWith(staticService)});return promise};return Static}();Expandable=function(){function Expandable(){}Expandable.create=function(slotId,containerId,options){var params,promise,_this=this;params=getParams(options);promise=new Promise;services.get("Expandable").success(function(service){var expandable;_this.VERSION=service.VERSION;return expandable=service.create(slotId,containerId,params,function(error){if(error!=null){return promise.rejectWith(error)}else{return promise.resolveWith(expandable)}})});return promise};Expandable.get=function(slotId,options){var promise;promise=new Promise;services.get("Expandable").success(function(service){var expandable;expandable=service.get(slotId,options);return promise.resolveWith(expandable)});return promise};return Expandable}();Interstitial=function(){function Interstitial(){}Interstitial.create=function(slotIdId,containerId,options){var params,promise,_this=this;params=getParams(options);promise=new Promise;services.get("Interstitial").success(function(service){var interstitial;_this.VERSION=service.VERSION;return interstitial=service.create(slotIdId,containerId,params,function(error){if(error!=null){return promise.rejectWith(error)}else{return promise.resolveWith(interstitial)}})});return promise};return Interstitial}();Video=function(){function Video(){}Video.create=function(){var promise,_this=this;promise=new Promise;services.get("Video").success(function(service){var video;_this.VERSION=service.VERSION;video=service.create();return promise.resolveWith(video)});return promise};return Video}();WatchToEarn=function(){function WatchToEarn(){}WatchToEarn.service=new W2ESyncBridge;WatchToEarn.create=function(slotIds,containerId,options){var params,promise,_this=this;if(options==null){options={}}params=getParams(options);promise=new Promise;services.get("W2E").success(function(service){var w2e;_this.VERSION=service.VERSION;w2e=service.create(containerId,params);return w2e.initialize(slotIds,function(error){return promise.resolveWith(w2e,w2e.finalizeInit)})});return promise};return WatchToEarn}();AdEngine=function(){function AdEngine(){}AdEngine.selectAds=function(slotIds,options){var params,promise,timer_create,_this=this;if(options==null){options={}}params=clone(options);promise=new Promise;timer_create=timer.start(ADENGINE_CREATE_TIMER);services.get("AdEngine").success(function(service){var timer_selectAds;if(timer_create!=null){timer_create.complete()}_this.VERSION=service.VERSION;timer_selectAds=timer.start(ADENGINE_SERVICE_CREATE_TIMER);return service.selectAds(slotIds,params,function(error,result){if(timer_selectAds!=null){timer_selectAds.complete()}printTimingReport();if(error!=null){return promise.rejectWith(error)}else{return promise.resolveWith(result)}})});return promise};AdEngine.report=function(events,options){var params,promise,_this=this;if(options==null){options={}}params=clone(options);promise=new Promise;services.get("AdEngine").success(function(service){_this.VERSION=service.VERSION;return service.report(events,function(error){if(error!=null){return promise.rejectWith(error)}else{return promise.resolveWith(null)}})});return promise};return AdEngine}();App=function(){function App(){}App.initialize=function(zid,appId,snId,session){var promise;promise=new Promise;app.initializeManually(zid,appId,snId,session,function(error){if(error!=null){return promise.rejectWith(error)}else{return promise.resolveWith(null)}});return promise};return App}();XBar=function(){function XBar(){}XBar.use=function(use){return zynga.ads.globals["private"].useXBar=use};XBar.isShown=function(){var _base;return(_base=zynga.ads.globals["private"]).showBar!=null?(_base=zynga.ads.globals["private"]).showBar:_base.showBar=true};return XBar}();exports.addService=function(name,service){return services.add(name,service)};exports.Static=Static;exports.Expandable=Expandable;exports.Interstitial=Interstitial;exports.Video=Video;exports.WatchToEarn=WatchToEarn;exports.AdEngine=AdEngine;exports.App=App;exports.XBar=XBar;exports.VERSION=meta.VERSION;exports.ENV=meta.ENV;for(name in exports){service=exports[name];zynga.ads[name]=service}}).call(this)});require("/src/zac.coffee")})();