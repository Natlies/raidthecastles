/** @license Copyright (c) 2015 Zynga Game Network **/

/* Package: play */

ZY.ZUI.module({name:"BrowserDetector",version:1,builder:function(a,b){var c={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version",this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(a){for(var b=0;b<a.length;b++){var c=a[b].string,d=a[b].prop;this.versionSearchString=a[b].versionSearch||a[b].identity;if(c){if(c.indexOf(a[b].subString)!=-1)return a[b].identity}else if(d)return a[b].identity}},searchVersion:function(a){var b=a.indexOf(this.versionSearchString);if(b==-1)return;return parseFloat(a.substring(b+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};return c.init(),c}})

ZY.ZUI.module({name:"fullscreen",version:1,required:"BrowserDetector",builder:function(a,b){var c={supportsFullScreen:!1,isFullScreen:function(){return!1},requestFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",prefix:""},d="webkit moz o ms khtml".split(" "),e=a.getConstructor("BrowserDetector");if(typeof document.cancelFullScreen!="undefined")c.supportsFullScreen=!0;else if(e.browser!=="Safari"||e.version>=6)for(var f=0,g=d.length;f<g;f++){c.prefix=d[f];if(typeof document[c.prefix+"CancelFullScreen"]!="undefined"){c.supportsFullScreen=!0;break}}return c.supportsFullScreen&&(c.fullScreenEventName=c.prefix+"fullscreenchange",c.isFullScreen=function(){switch(this.prefix){case"":return document.fullScreen;case"webkit":return document.webkitIsFullScreen;default:return document[this.prefix+"FullScreen"]}},c.requestFullScreen=function(a){return c.prefix===""?a.requestFullScreen():a[this.prefix+"RequestFullScreen"](Element.ALLOW_KEYBOARD_INPUT)},c.cancelFullScreen=function(a){return c.prefix===""?document.cancelFullScreen():document[this.prefix+"CancelFullScreen"]()}),c}})

ZY.ZUI.module({name:"widgets/zdc/common/ads",version:1,extend:"widgets/base",themes:[""],constructor:function(a,b,c,d){function i(b){if(b.owner==h&&b.height){var c=Math.max(a.get("minHeight"),b.height+4);a.$root().css("height",c)}a.fire({name:"adHeightSet",height:c,owner:h,bubble:!0})}function j(){var b=a.get("adParams"),c="ref="+b.ref;b.interstitial&&(c+="&interstitial=1"),b.owner&&(c+="&owner="+b.owner,h!=b.owner&&(h=b.owner,a.fire({name:"listenForAdLoaded",owner:h,callback:i,bubble:!0}))),a.$root().attr("src",b.publicUri+"/iframe-widget/"+b.commonWebPrefix+"ads"+"?"+c)}var e=150,f=60,g,h;a.declare("adParams","ref"),a.declareAndSet({defaultHeight:e,minHeight:f,t_content:'<iframe class="$$" frameBorder="0" allowtransparency="true" />'}),a.bindStateToClass("ref"),a.bindStateToContent("adParams",function(b){b.ref&&a.set("ref",b.ref),j(),a.done("initialAdLoaded")}),a.createContent=function(b){a.need("$",function(c){a.content=c(a.useTemplate("t_content")),b(a.content)})},b({refreshAds:function(){}})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/ad/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_common_rail_ad_ad:{str_header:{original:"Sponsored"}}})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/ad",version:1,extend:"widgets/base",required:"widgets/zdc/common/ads",singleton:!0,localized:!0,themes:[""],constructor:function(a,b,c,d){function e(){if(!a.children.ads){var b=a.addChild("ads","widgets/zdc/common/ads");b.getContent(function(b){a.$root().append(b),a.done("adsReady")})}}a.declareAndSet({t_content:'<div class="$$"></div>',t_header:'<div class="$header$">Sponsored</div>'}),a.declare("adParams","str_header"),a.declareAndSet("addTTL"),a.createContent=function(b){a.need("$",function(c){a.content=c(a.useTemplate("t_content")),b(a.content)})},a.bindStateToContent("adParams",function(b){e(),a.once("adsReady",function(){a.children.ads.set("adParams",b)})}),b({refreshAds:function(){a.once("adsReady",function(){a.children.ads.refreshAds()})}})}})

ZY.ZUI.module({name:"widgets/tabs",version:1,extend:"widgets/base",themes:["","default","fb","zdc"],constructor:function(a,b,c,d){a.declare("dataSet","totalTabs","selected"),a.declareAndSet({t_content:'<div class="$$"></div>',t_tab:'<div class="$tab$">%name%</div>'}),a.set("theme","default");var e;a.createContent=function(b){a.need("$",function(c){b(e=c(a.useTemplate("t_content")))})},a.$tab=function(b){return a.content&&a.content.find("#zui_tab_"+b)},b({setTabsData:function(b,c){c||(c=b[0].key),a.set("selected","none"),a.set("dataSet",b),a.once(["render_tabs"],function(){a.setSelected(c)})},setSelected:function(b){a.get("selected")==b?a.fire({name:"selected_tab_clicked",bubble:!0}):a.set("selected",b)},getSelected:function(){return a.get("selected")},getTabData:function(b){b(a.get("dataSet"))},onSelectChange:function(b){a.wire("select_change",function(a){b(a.tabId)})}}),a.bindStateToContent("selected",function(b,c){b=="addFriends"||b=="suggestedFriends"?(c("#rail-right-outer").css("min-height","855px"),b=="addFriends"&&a.fire({name:"adPositionBasedOnTab",bubble:!0})):(c("#rail-right-outer").css("min-height","1px"),a.fire({name:"changeAdPosition",value:0,bubble:!0}));var d=!1;e.children().removeClass("zui_selected_tab"),d=b=="none"||e.children("#zui_tab_"+b).addClass("zui_selected_tab").length,d||console.log("widgets/tabs: Could not find provided selected tabId - "+b),a.fire({name:"select_change",tabId:b,bubble:!0})}),a.bindStateToContent("dataSet",function(b,c){function d(b){return function(){a.fire({name:"user_clicked_tab",tabId:b,oldValue:a.getSelected(),bubble:!0}),a.get("enabled")&&a.setSelected(b)}}e.empty(),a.set("totalTabs",b.length);for(var f=0;f<b.length;f++){var g=b[f],h=c(a.useTemplate("t_tab",g));h.attr("id","zui_tab_"+g.key),f===0&&h.addClass("zui_first_tab"),h.click(d(g.key)),e.append(h)}a.done("render_tabs")})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tabs/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_common_rail_tabs_tabs:{str_chat:{original:"Chat"},str_suggestedFriends:{original:"Suggested zFriends"},str_gameActivity:{original:"Game Activity"},str_multiPlayer:{original:"Multiplayer"},str_addFriends:{original:"Add Friends"},str_guidesNewsTab:{original:"Guides, News"}}})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tabs",version:1,extend:"widgets/tabs",required:["widgets/zdc/common/counterbubble","widgets/zdc/services/experiments"],themes:[""],localized:!0,constructor:function(a,b,c,d){function o(){var b=0;d.each(a.get("dataSet"),function(a){b+=j[a.key]}),a.set("totalTabsShown",b);if(!(n=m)){var c=!1;d.each(j,function(a,b){!c&&a!=k[b]&&(c=!0)});if(c){m=!0;var e=d.extend({},j);a.updateUiTabsShown(e,k,function(){m=!1,d.extend(k,e),n&&o()})}}}var e=a._super,f=c.getInstance("widgets/zdc/services/experiments"),g={},h={chat:"chat",gameActivity:"activity",multiPlayer:"multiplayer",suggestedFriends:"suggested",guides:"guides"},i={},j={},k={},l=0;f.getExperimentValue({name:"ZDC_friend_finder_search"},function(a){a!=0&&(l=1),f.getExperimentValue({name:"CLI_main_experiment"},function(a){a!=0&&l!=1&&(h.suggestedFriends=undefined,h.addFriends="suggested")})}),d.each(h,function(a,b){i[a]=b,j[b]=k[b]=undefined}),a.updateUiTabsShown=function(b,c,d){for(var e in b)b.hasOwnProperty(e)&&b[e]!=c[e]&&a.$node(e)[(c[e]=b[e])?"show":"hide"]();d()},a.declare("str_chat","str_addFriends","str_suggestedFriends","str_gameActivity","str_multiPlayer","railOpts","totalTabsShown","notifications","str_guidesNewsTab");var m=!1,n=!1;a.set({t_tab:'<div class="$tab$ $%key%$" title="%name%"><div class="$tabIcon$"/><span class="$tabLabel$"></span></div>'}),a.set({theme:"",enabled:!0}),a.isTabSelectable=function(){return!0},a.bindStateToContent("dataSet",function(b,c){function h(a){e.$tab(f).append(a)}var d=["chat","gameActivity"],f;for(var i=0;i<d.length;i++){f=d[i];var j=a.addChild(f+"Counter","widgets/zdc/common/counterbubble");j.set({count:0,size:"small"}),j.getContent(h),g[f]=j}}),a.bindStateToContent("notifications",function(b){a.once("render_tabs",function(){for(var c in b)if(b.hasOwnProperty(c)){var d=a.getCounterBubble(c);d&&d.set("count",b[c])}})}),a.bindStateToContent("railOpts",function(b){a.once("render_tabs",function(){b.activity=b.everybody||b.zfriends;var c,e=!1;d.each(a.get("dataSet"),function(a){var d=a.key,f=!!b[h[d]];f&&!c&&(c=d),f!=j[d]&&(e=!0,j[d]=f)}),e&&o();if(a.isTabSelectable()){var f=b.select||"chat";if(f=="everybody"||f=="zfriends")f="activity";var g=i[f];a.set("selected",j[g]?g:c)}else a.set("selected","none")})}),a.once("content",function(){a.setTabsData([{key:"chat",name:a.localize("str_chat")},{key:"suggestedFriends",name:a.localize("str_suggestedFriends")},{key:"gameActivity",name:a.localize("str_gameActivity")},{key:"multiPlayer",name:a.localize("str_multiPlayer")},{key:"addFriends",name:a.localize("str_addFriends")},{key:"guides",name:a.localize("str_guidesNewsTab")}],"none")}),b({getCounterBubble:function(a){if(g[a])return g[a]},tabKeyToRailOptNameMap:h,railOptNameToTabKeyMap:i})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tabs/min",version:1,extend:"widgets/zdc/common/rail/tabs",themes:[""],localized:!1,constructor:function(a,b,c,d){a.isTabSelectable=function(){return!1}}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/fullscreenbutton",version:1,extend:"widgets/base",themes:[""],localized:!1,required:["fullscreen"],constructor:function(a,b,c,d){function f(b){function c(b){a.fire({name:"fullscreenButtonClick",action:b,bubble:!0})}e.isFullScreen()?(e.cancelFullScreen(b),c("collapse")):(e.requestFullScreen(b),c("expand"))}var e=c.getConstructor("fullscreen");a.declare("isFullScreen"),a.declareAndSet({t_content:'<div class="$$"><div class="$icon$"/></div>'}),a.bindStateToClass("isFullScreen"),a.createContent=function(b){a.need("$",function(c){a.content=c(a.useTemplate("t_content")),b(a.content)})},a.once("content",function(){a.set("isFullScreen",e.isFullScreen()),a.$root().click(function(){f(document.documentElement)}),a.need("$",function(b){b(document).bind(e.fullScreenEventName,function(b){a.set("isFullScreen",!a.get("isFullScreen"))})})}),b({})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/minmaxbutton",version:1,extend:"widgets/base",themes:[""],localized:!1,constructor:function(a,b,c,d){a.declare("maximize","roundAllCorners"),a.bindStateToClass("maximize"),a.bindStateToClass("roundAllCorners"),a.set("maximize",!0),a.declareAndSet({t_content:'<div class="$$"><div class="$icon$"/></div>'}),a.createContent=function(b){a.need("$",function(c){a.content=c(a.useTemplate("t_content")),b(a.content)})},a.once("content",function(){a.$root().click(function(){a.fire({name:a.get("maximize")?"maximize":"minimize",bubble:!0})})})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/viewnav/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_common_rail_viewnav_viewnav:{str_tooltipHeadline:{original:"Open fullscreen!"},str_tooltipBody:{original:"Click here to play in fullscreen and get the big picture for an even better gaming experience. Click again to get small."}}})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/viewnav",version:1,extend:"widgets/base",themes:[""],localized:!0,required:["widgets/zdc/common/rail/minmaxbutton","widgets/zdc/common/rail/fullscreenbutton","widgets/zdc/common/tooltip","widgets/zdc/common/closebutton"],constructor:function(a,b,c,d){a.declare("buttonIsMaximize","maximized","viewNavPosition","showTooltip","showFullScreenButton"),a.bindStateToClass("showFullScreenButton"),a.declare("str_tooltipHeadline","str_tooltipBody"),a.declareAndSet({t_content:'<div class="$$"><div class="$minmaxButton$" /><div class="$fullscreenButton$" /></div>',t_tooltipContent:'<div><div class="zy-tooltip-headline">%str_tooltipHeadline%</div><div class="zy-tooltip-body">%str_tooltipBody%</div></div>'}),a.onStateChange("maximized",function(b){a.get("showTooltip")&&(b.newValue==1?a.setTimeout(function(){a.children.tooltip.show()},200):a.children.tooltip.hide())}),a.bindStateToContent("viewNavPosition",function(b){a.get("showTooltip")&&a.children.tooltip&&a.children.tooltip.once("initialized",function(){a.children.tooltip.hide(),a.children.tooltip.set("gravity",b==="viewNavMiddle"?"nw":"sw"),a.children.tooltip.show()})}),a.bindStateToContent("showTooltip",function(b){b?a.need("$",function(b){var c=a.addChild("tooltip","widgets/zdc/common/tooltip"),d=a.addChild("closeButton","widgets/zdc/common/closebutton"),e;d.set({theme:"light"}),d.getContent(function(b){e=b,a.done("closeButtonContent")}),a.once("closeButtonContent",function(){var d=b(a.useTemplate("t_tooltipContent")).prepend(e).html();c.set({$parentNode:a.$node("fullscreenButton"),title:d,gravity:a.get("viewNavPosition")==="viewNavMiddle"?"nw":"sw",trigger:"manual",opacity:.9,offset:5,fixed:!0}),c.wire("tooltip_click",function(c){var d=b(c.domEvent.target);d.hasClass("zui_button")&&(a.set("showTooltip",!1),a.fire({name:"fullscreenTooltipCloseButtonClick",bubble:!0}))}),c.getContent(function(b){a.$root().append(b),c.once("initialized",function(){setTimeout(function(){a.get("showTooltip")&&(a.get("maximized")&&c.show(),a.fire({name:"fullscreenTooltipView",bubble:!0}))},600)})}),b(window).scroll(function(){a.get("showTooltip")&&a.get("maximized")&&(c.hide(),c.show())})})}):a.children.tooltip&&a.children.tooltip.once("initialized",function(){a.children.tooltip.hide()})}),a.bindStateToContent("showFullScreenButton",function(b){a.once("content",function(){a.children.minmaxButton.set("roundAllCorners",b)})}),a.createContent=function(b){a.need("$",function(c){a.content=c(a.useTemplate("t_content"));var d=a.addChild("minmaxButton","widgets/zdc/common/rail/minmaxbutton",{maximize:a.get("buttonIsMaximize")});d.getContent(function(b){a.$node("minmaxButton").html(b),a.done("minmaxButton_created")});var e=a.addChild("fullscreenButton","widgets/zdc/common/rail/fullscreenbutton");e.getContent(function(b){a.$node("fullscreenButton").html(b),a.done("fullscreenButton_created")}),a.once(["minmaxButton_created","fullscreenButton_created"],function(){b(a.content)})})},a.once("content",function(){a.get("showTooltip")&&a.children.fullscreenButton.wire("fullscreenButtonClick",function(){a.set("showTooltip",!1)})}),b({})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/min",version:1,extend:"widgets/base",required:["widgets/zdc/common/rail/tabs/min","widgets/zdc/common/rail/viewnav","widgets/zdc/services/experiments"],themes:[""],localized:!1,constructor:function(a,b,c,d){var e=75,f=500,g=500;a.declare("railOpts","notifications"),a.bindStateToContent("railOpts",function(b){a.children.tabs.set("railOpts",b)}),a.bindStateToContent("notifications",function(b){a.children.tabs.set("notifications",b)}),a.declareAndSet({t_content:'<div class="$$"><div class="$toaster$" /><div class="$body$"><div class="$tabsShell$"/></div><div class="$maximize$"/><div class="$viewnavShell$"/></div>'}),a.createContent=function(b){a.need("$",function(d){a.content=d(a.useTemplate("t_content"));var e=a.addChild("tabs","widgets/zdc/common/rail/tabs/min");e.getContent(function(b){e.set("selected","none"),a.$node("tabsShell").html(b),a.done("tabs_created")});var f=a.addChild("viewnav","widgets/zdc/common/rail/viewnav");f.set("buttonIsMaximize",!0),c.getConstructor("fullscreen").supportsFullScreen&&f.set("showFullScreenButton",!0),f.getContent(function(b){a.$node("viewnavShell").html(b),a.done("viewnav_created")}),a.once(["tabs_created","viewnav_created"],function(){b(a.content)})})},a.openToaster=function(b,c){a.once("content",function(){var d=a.$node("toaster"),g=a.$node("body");b?(d.animate({height:e},f,function(){c&&c()}),g.animate({top:e},f)):(d.css("height",e),g.css("top",e))})},a.closeToaster=function(b,c){a.once("content",function(){var d=a.$node("toaster"),e=a.$node("body");b?(d.animate({height:0},g,function(){c&&c()}),e.animate({top:0},g)):(d.css("height",0),e.css("top",0))})},a.once("content",function(){var b=a.children.tabs;b.wire("Changed:selected",function(){var c=b.get("selected");c!="none"&&(b.set("selected","none"),a.fire({name:"maximize",bubble:!0,selectTab:c}))})}),b({getToasterElement:function(b){return a.$node("toaster")},openToaster:a.openToaster,closeToaster:a.closeToaster,tabs:function(){return a.children.tabs}})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tab/addFriends/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_common_rail_tab_addFriends_addFriends:{str_cli_text_v3:{original:"Add"},str_ff_text_v3:{original:"Suggested"},str_heading_v3:{original:"Friends"}}})}})

ZY.ZUI.module({name:"widgets/zdc/common/friendfinderGameSwitcher/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_common_friendfinderGameSwitcher_friendfinderGameSwitcher:[]})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/friendfinder/friendfinderAd",version:1,extend:"widgets/listitem",themes:[""],localized:!1,required:["widgets/zdc/common/ads"],constructor:function(a,b,c,d){a.declare("adParams"),a.declareAndSet({t_content:'<div class="$$"></div>'}),a.bindStateToContent("adParams",function(b){var c=a.addChild("ads","widgets/zdc/common/ads");c.getContent(function(d){c.set("adParams",b),a.$root().append(d),a.done("adsReady")})}),a.createContent=function(b){a.need("$",function(c){a.content=c(a.useTemplate("t_content")),b(a.content)})},a.once("content",function(){}),b({})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/friendfinder/friendfinderlist/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_common_rail_friendfinder_friendfinderlist_friendfinderlist:{str_emptyMessageBody_v1:{original:"That's all for now, folks! More fresh faces will be waiting here soon."}}})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/friendfinder/friendfinderlist",version:1,extend:"widgets/list",themes:[""],localized:!0,required:["widgets/zdc/common/rail/friendfinder/friendfinderlistitem","widgets/zdc/services/user","widgets/zdc/services/socialgraph","widgets/zdc/common/rail/friendfinder/friendfinderAd"],constructor:function(a,b,c,d){function g(a){return a<1?0:(a-1)*2}function h(){a.children[f]&&a.removeItem(f);var b=c.getInstance("widgets/zdc/services/experiments");b.getExperimentValue({name:"zdcFriendFinderAds"},function(b){var d;switch(b){case 2:d=3;break;case 3:d=4;break;default:d=0}if(d>0){var e=g(d),h=c.getInstance("widgets/zdc/services/socialgraph");h.getFriendFinderAdParams(null,function(b){var c=a.addChild(f,"widgets/zdc/common/rail/friendfinder/friendfinderAd");c.set("adParams",{ref:b.ref,publicUri:b.publicUri,commonWebPrefix:b.commonWebPrefix,owner:b.owner}),c.getContent(function(b){if($(a.$node("itemsContainer")).children().length<e)a.$node("itemsContainer").append(b);else{var c=0;$(a.$node("itemsContainer")).children().each(function(){c++;if(e===0&&c==1)return $(this).before(b),!1;if(c==e)return $(this).after(b),!1})}})})}})}var e=a._super,f="friendFinderAd";a.declare("str_emptyMessageBody_v1"),a.declare("zid","gid","maxItemsShown","ffExp"),a.declareAndSet({suggested_friends_data:!1,t_emptyMessage:'<div class="$emptyMessage$"><div class="$emptyMessageContainer$"><div class="$emptyMessageBody$">%str_emptyMessageBody_v1%</div></div></div>'}),a.bindStateToContent("maxItemsShown",function(b){a.set("maxItemsShown",b),a.fire({name:"maxItemsShownChanged",maxItemsShown:a.get("maxItemsShown")})}),a.createContent=function(b){e.createContent(function(c){a.need("$",function(d){a.content=d(c),b(a.content)})})},a.once("content",function(){h();var b=a.get("ffExp");b==4?a.removeChild("emptyMessage"):a.getEmptyMessageContent(function(b){a.$node("itemsContainer").append(b)})}),a.makeItemWidgetClass=function(a){return"widgets/zdc/common/rail/friendfinder/friendfinderlistitem"},a.addItemWidgetParams=function(b){var d=c.getInstance("widgets/zdc/services/experiments"),e=d.getExperimentValue({name:"zdcFriendFinderV2"}),f;return e==4?f="listview_mutualfriends":e==3||e==5?f="listview":f="tileview",{theme:f,gid:a.get("gid")}},a.makeItemWidgetName=function(a){return a.zid},a.getEmptyMessageContent=function(b){a.need("$",function(c){var d=c(a.useTemplate("t_emptyMessage"));b(d)})},a.getItemsData=function(b){a.get("suggested_friends_data")&&b(a.get("suggested_friends_data"))},a.wire("removeSuggestedFriend",function(b){var c=a.children[b.zid];c.$root().fadeOut(500,function(){a.removeItem(b.zid),h()})}),a.wire("suggested_friend_cta_click_invited",function(b){if(a.get("ffExp")==4){var c=a.children[b.zid];c.$root().fadeOut(1e3,function(){a.removeItem(b.zid),h()})}}),a.wire("click_cta",function(b){a.fire({name:"userNameClick",zid:b.zid,bubble:!0})}),a.wire("lastItemRemoved",function(){a.get("ffExp")==4&&a.getEmptyMessageContent(function(b){a.$node("itemsContainer").append(b)})}),b({})}})

ZY.ZUI.module({name:"widgets/zdc/common/togglebuttons",version:1,extend:"widgets/base",themes:[""],constructor:function(a,b,c,d){function e(b){var c=a.get("buttons");b<c.length&&a.$root().find("li").removeClass(a.nodeClass("button_selected")).eq(b).addClass(a.nodeClass("button_selected"))}a.declareAndSet({buttons:[],selected:0,t_content:'<ul class="$$"></ul>',t_button:'<li class="$button$"><a class="$button_link$"  onclick="return false">%label%</a></li>'}),a.bindStateToContent("selected",function(b){e(b),a.fire({name:"toggleButtonsChanged",selected:b,bubble:!0})}),a.bindStateToContent("buttons",function(b){a.need("$",function(c){a.$root().empty();for(var d=0,f=b.length;d<f;d++){var g=c(a.useTemplate("t_button",{label:b[d]}));d===0&&g.addClass(a.nodeClass("button_first")),d===f-1&&g.addClass(a.nodeClass("button_last")),a.$root().append(g)}a.$root().delegate("li","click",function(){a.set("selected",c(this).index())}),e(a.get("selected"))})}),a.createContent=function(b){a.need("$",function(c){a.content=c(a.useTemplate("t_content")),b(a.content)})}}})

ZY.ZUI.module({name:"widgets/zdc/common/friendfinderGameSwitcher",version:1,extend:"widgets/zdc/common/togglebuttons",themes:[""],localized:!0,required:["widgets/zdc/services/game-zdc","widgets/zdc/services/discovery","widgets/gameicon","widgets/zdc/common/rail/friendfinder/friendfinderlist","widgets/zdc/common/rail/friendfinder/friendfinderlistitem","widgets/zdc/services/socialgraph","widgets/zdc/common/buttonimage"],constructor:function(a,b,c,d){function r(b,c){b.getContent(function(b){a.$node("button_icon").eq(c).append(b)})}var e=c.getInstance("widgets/zdc/services/game-zdc"),f=c.getInstance("widgets/zdc/services/socialgraph"),g=c.getInstance("widgets/zdc/services/discovery"),h=1031,i=[],j,k,l,m={},n=[],o=[],p=0,q=0;a.declare("suggested_friends_data"),a.declareAndSet({t_button:'<li class="$button$"><div class="$button_icon$"  onclick="return false">%label%</div></li>'}),a.createContent=function(b){a.need("$",function(c){a.content=c(a.useTemplate("t_content")),b(a.content)})},a.once("content",function(){var b,d,f,g;e.fetchGamesPlayedLevel({},function(a){for(var b in a)if(a.hasOwnProperty(b)){var c=a[b],d=c.id,e=c.level;m[d]=e}}),e.fetchAllZdcGids({},function(m){n.push(""),i.push(h);for(var s in m)m.hasOwnProperty(s)&&(b=m[s],b.id!=1&&b.id!=100000142&&b.id!=100000156&&(n.push(""),i.push(b.id)));e.fetchFriendFinderFeaturedGids({},function(b){for(var e in b)b.hasOwnProperty(e)&&o.push(b[e].id);for(d=0;d<o.length;d++){var h=i.indexOf(o[d]);i.splice(h,1),i.splice(d+1,0,o[d])}a.set({buttons:n,selected:0});for(d=0;d<i.length;d++)g=i[d],f=a.addChild("newGameIcon","widgets/gameicon"),f.set({game_id:g,size:"thirtyfive",disable_click:!0}),r(f,d);a.$node().wrap('<div class="games_tab"> </div>'),$(".games_tab").wrap('<div class="widget_main_div"> </div>'),$(".widget_main_div").append('<div class="next"></div>'),$(".widget_main_div").prepend('<div class="prev"></div>');var m=a.$node().attr("class");a.$node().attr("class","game_list"),$(".widget_main_div").attr("class",m),$(".games_tab").append('<img class = "selection" src = "'+c.zui().baseUrl+a.def.name+'/Selection.png">'),$(".selection").css("position","absolute"),k=45,l=51,j=5,$(".selection").css("left",k+"px"),$(".selection").css("top","88px"),$(".games_tab").stop().animate({scrollLeft:"0"}),p=0;var s=a.addChild("prevButton","widgets/zdc/common/buttonimage");s.set({enabled:!0,multiple_use:!0,color:"white",imagesrc:"nav_left_arrowup_normal.png",imagesrc_hover:"nav_left_arrowup_hover.png",hover_enabled:!1}),s.getContent(function(a){$(".prev").prepend(a)});var t=a.addChild("nextButton","widgets/zdc/common/buttonimage");t.set({enabled:!0,multiple_use:!0,color:"white",imagesrc:"nav_right_arrowup_normal.png",imagesrc_hover:"nav_right_arrowup_hover.png",hover_enabled:!0}),t.getContent(function(a){$(".next").prepend(a)}),s.wire("click",function(){$(".games_tab").stop().animate({scrollLeft:"-=257"},100,function(){q=parseInt($(".games_tab").scrollLeft()/(l-1),10);if(p-q<0||p-q>4)$(".selection").css("display","none");else{$(".selection").css("display","inline");var a=(p-q)*l;a+=k,$(".selection").css("left",a+"px")}t.set("hover_enabled",!0),$(".games_tab").scrollLeft()===0&&s.set("hover_enabled",!1)})}),t.wire("click",function(){$(".games_tab").stop().animate({scrollLeft:"+=257"},100,function(){q=parseInt($(".games_tab").scrollLeft()/(l-1),10);if(p-q<0||p-q>4)$(".selection").css("display","none");else{$(".selection").css("display","inline");var a=(p-q)*l;a+=k,$(".selection").css("left",a+"px")}s.set("hover_enabled",!0),$(".games_tab").width()-$(".games_tab").scrollLeft()<(j+1)*l&&t.set("hover_enabled",!1)})})})}),a.wire("toggleButtonsChanged",function(b){p=b.selected,q=parseInt($(".games_tab").scrollLeft()/(l-1),10);var c=i[p],d=(p-q)*l;d+=k,$(".selection").css("left",d+"px"),$(".selection").css("display","inline"),a.fire({name:"newGameSelected",game_id:c,selected_index:b.selected,gameLevelMap:m})})}),b({resetPointer:function(){$(".selection").css("left",k+"px"),p=0,$(".games_tab").stop().animate({scrollLeft:"0"})}})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/friendfinder/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_common_rail_friendfinder_friendfinder:{str_heading:{original:"Friend Finder"},str_game_heading:{original:"Find Friends who play"}}})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/friendfinder",version:1,extend:"widgets/base",themes:[""],localized:!0,required:["widgets/zdc/common/rail/friendfinder/friendfinderlist","widgets/zdc/common/rail/friendfinder/friendfinderlistitem","widgets/zdc/services/socialgraph","widgets/zdc/services/game-zdc"],constructor:function(a,b,c,d){function g(a,b){var c=parseInt(a,10),d=parseInt(b,10);return c>d?1:-1}function h(a,b,c){var d;if(typeof b.level!="undefined"&&b.level!=0){var e=Math.abs(a-b.level).toString();c.hasOwnProperty(e)||(c[e]={}),d=c[e],d.hasOwnProperty(b.play_frequency)?d[b.play_frequency].push(b):(d[b.play_frequency]=[],d[b.play_frequency].push(b))}else c.hasOwnProperty("undefined_level")?c.undefined_level.push(b):(c.undefined_level=[],c.undefined_level.push(b))}function i(a,b){var c=[],d=[];a.hasOwnProperty("undefined_level")&&(d=a.undefined_level);for(var e in a)a.hasOwnProperty(e)&&e!="undefined_level"&&c.push(e);c.sort(g);var f=c.length;for(var h=0;h<f;++h){var i=[],j=a[c[h]];for(var k in j)j.hasOwnProperty(k)&&i.push(k);i.sort(g);var l=i.length;for(var m=0;m<l;++m){var n=j[i[m]],o=n.length;for(var p=0;p<o;++p)b.push(n[p])}}if(typeof d!="undefined"){var q=d.length;for(h=0;h<q;h++)b.push(d[h])}}var e=c.getInstance("widgets/zdc/services/game-zdc"),f=-1,j=1031;a.declare("str_heading","str_game_heading"),a.declare("suggested_friends_data","gid","ffExp","gameLevelMap"),a.declareAndSet({t_content:'<div class="$$"><div class="$friendFinderList$" /></div>',t_content_games:'<div class="$$ $ffgames$"><div class="$loadingContent$" ><img class = "$loadingImage$" src = "'+c.zui().baseUrl+a.def.name+'/loading1.gif "/>'+"</div>"+'<div class="$friendFinderList$" />'+"</div>"}),a.bindStateToContent("gid",function(b){var d;b||(b=j),a.set("gid",b),a.removeChild("friendFinderList"),a.get("ffExp")==4&&a.$node("loadingContent").css("display","inline");var e=c.getInstance("widgets/zdc/services/socialgraph");a.get("ffExp")==4?d=8:d=20;var g={gameId:a.get("gid"),maxLimit:d};e.fetchSuggestedFriends(g,function(b){var c={},d=[];if(b.gid==a.get("gid")&&b.gid!=f){f=a.get("gid");if(b.response&&b.response.length){for(var e=0;e<b.response.length;e++){var g=b.response[e],k=0,l=0,m=0,n=-1;if(g.gamesPlayed&&g.gamesPlayed.length){if(a.get("gid")!=j)for(var o=0;o<g.gamesPlayed.length;o++){var p=g.gamesPlayed[o];if(p.hasOwnProperty("id")&&p.id==a.get("gid")){n=o;break}}n<0&&(n=0),a.get("ffExp")!=4&&(n=0),k=g.gamesPlayed[n].id,l=g.gamesPlayed[n].playFrequency,m=g.gamesPlayed[n].level}else k=j;var q;a.get("ffExp")==4?q=!0:q=a.get("gid")==j?!0:!1;if(a.get("ffExp")==4){var r={zid:g.zid,play_frequency:l,level:m,common_friends:g.mutualsCount,common_friends_list:g.mutualsList,played_game:{id:k},show_game_icon:q,show_actions:!0},s=a.get("gid"),t=a.get("gameLevelMap"),u;t&&t.hasOwnProperty(s)&&t[s]?u=t[s]:u=0,h(u,r,c)}else d.push({zid:g.zid,play_frequency:l,level:m,common_friends:g.mutualsCount,common_friends_list:g.mutualsList,played_game:{id:k},show_game_icon:q,show_actions:!0})}a.get("ffExp")==4&&i(c,d)}a.set("suggested_friends_data",d),a.removeChild("friendFinderList");var v=a.addChild("friendFinderList","widgets/zdc/common/rail/friendfinder/friendfinderlist",{suggested_friends_data:d,gid:a.get("gid"),ffExp:a.get("ffExp")});if(a.get("ffExp")==4){var w=a.$node().height()-65;w<0&&(w=0);var x=parseInt(w/81,10);v.set("maxItemsShown",x)}v.getContent(function(b){a.$node("loadingContent").css("display","none"),a.$node("friendFinderList").append(b);var c=v.getNumListItems();a.track(["zdc_friend_finder","content_loaded",c,a.get("gid"),"","reference"])})}})}),a.createContent=function(b){a.need("$",function(c){a.get("ffExp")!=4?a.content=c(a.useTemplate("t_content")):a.content=c(a.useTemplate("t_content_games")),b(a.content)})},a.once("content",function(){var b=c.getInstance("widgets/zdc/services/socialgraph");a.wire("removeSuggestedFriend",function(c){a.get("ffExp")==4?(a.track(["Friend_finder_recommendation_cancelled",c.zid]),b.updateCacheThenRemoveSuggestions({gameId:c.pageGameId,rejectedZid:c.zid},function(){}),b.keepCacheFullToThreshold({gameId:c.pageGameId,maxLimit:6},function(){})):b.removeSuggestedFriend({zid:c.zid},function(){})}),a.wire("suggested_friend_cta_click",function(c){a.get("ffExp")==4?(a.track(["Friend_finder_sent",c.zid]),b.updateCacheThenRemoveSuggestions({gameId:c.pageGameId,rejectedZid:c.zid},function(){}),b.keepCacheFullToThreshold({gameId:c.pageGameId,maxLimit:6},function(){})):b.removeSuggestedFriend({zid:c.zid},function(){})})}),b({})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tab/suggestedFriends/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_common_rail_tab_suggestedFriends_suggestedFriends:{str_heading:{original:"Suggested zFriends"},str_needZFriends:{original:"Need zFriends?"},str_suggestPlayers:{original:"We suggest these players"},str_suggestedDescription:{original:"These folks share games and friends with you. Play with them!"},str_invite:{original:"Invite Friends"},str_heading_friendfinder:{original:"Friend Finder"},str_heading_friendfinder_games_v1:{original:"Suggested zFriends"},str_game_heading_friendfinder:{original:"Find Friends who play"}}})}})

ZY.ZUI.module({name:"widgets/gameicon/gameiconwithinfo/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_gameicon_gameiconwithinfo_gameiconwithinfo:{str_level:{original:"Level:"},str_requests:{original:"Requests"},str_button_label:{original:"Play"}}})}})

ZY.ZUI.module({name:"widgets/gameicon/gameiconwithinfo",version:1,extend:"widgets/gameicon",required:["widgets/zdc/common/counterbubble","widgets/button"],themes:["","basic"],localized:!0,constructor:function(a,b,c,d){var e=a._super,f=c.getInstance("widgets/zdc/services/game");a.declare("gameName","level","frequency","requestCount","showPlayButton","showCounter"),a.declare("str_level","str_requests","str_button_label"),a.declareAndSet({t_details:'<div class="$gameName$ zui_ellipsis" /><div class="$level$" /><div class="$frequency$" /><div class="$counterBubble$" /><div class="$counterBubbleLabel$">%str_requests%</div><div class="$playButton$" />'}),a.bindStateToContent("gameName","gameName.html"),a.bindStateToClass("showCounter"),a.bindStateToContent("game_id",function(b){f.fetch({gids:b},function(b){if(!b||!b.name)return;a.set("gameName",b.name)})}),a.bindStateToContent("level",function(b){b!==""&&a.$node("level").append(a.localize("str_level")+"<span>"+b+"</span>")}),a.bindStateToContent("frequency","frequency.html"),a.onStateChange("size",function(){a.once("content",function(){a.$node("gameInfo").addClass(a.get("size"))})}),a.provide("counterBubble",function(b){var c=a.addChild("counterBubble","widgets/zdc/common/counterbubble");c.getContent(function(d){c.set("size","medium"),a.$node("counterBubble").append(d),b(c)})}),a.bindStateToContent("requestCount",function(b){a.need("counterBubble",function(a){a.set("count",b)}),a.set("showCounter",b>0)}),a.provide("playButton",function(b){var c=a.addChild("playButton","widgets/button");c.set({multiple_use:!0,label:a.localize("str_button_label"),theme:"zdc",color:"blue",size:"small"}),c.getContent(function(d){a.$node("playButton").append(d),b(c)})}),a.bindStateToContent("showPlayButton",function(b){b&&a.need("playButton",function(b){a.$node("playButton").css("display","inline-block")})}),a.createContent=function(b){e.createContent(function(c){a.content=c,a.$node("gameInfo").append(a.useTemplate("t_details")),b(c)})},a.once("content",function(){a.$root().click(function(){a.fire({name:"gameIconWithInfoClick",gid:a.get("game_id"),bubble:!0})}),a.$node("gameName").click(function(){a.fire({name:"gameNameClick",gid:a.get("game_id"),bubble:!0})})})}})

ZY.ZUI.module({name:"widgets/zdc/common/suggestedfriend/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_common_suggestedfriend_suggestedfriend:{str_num_common_zfriend:{original:"{count} mutual zFriend"},str_num_common_zfriends:{original:"{count} mutual zFriends"},str_view_profile:{original:"View Profile"},str_add_zfriend:{original:"Add zFriend"},str_invite_sent:{original:"Sent"}}})}})

ZY.ZUI.module({name:"widgets/zdc/common/suggestedfriend",version:1,extend:"widgets/base",required:["widgets/button","widgets/zdc/common/closebutton","widgets/zdc/common/avatar","widgets/zdc/services/user","widgets/gameicon/gameiconwithinfo"],themes:["","small"],bubble:!0,localized:!0,constructor:function(a,b,c,d){function l(){var b="str_"+a.get("cta");return a.localize(b)}var e=c.getInstance("widgets/zdc/services/user"),f,g,h,i,j,k;f=c.getInstance("widgets/zdc/common/avatar"),f.set("size","xlarge"),a.addChild("avatar",f),g=c.getInstance("widgets/gameicon/gameiconwithinfo"),g.set("theme","basic"),a.addChild("game-icon",g),h=a.addChild("cta","widgets/button"),h.wire("click",function(b){var c=a.get("stranger"),d=a.get("zid"),e=j?j.displayName:"",f=a.get("cta"),g=k==1031?"homepage":"gamepage";a.fire({name:"suggested_friend_cta_click",zid:d,bubble:!0,stranger:c,displayName:e,cta:f,pageSource:g,pageGameId:k}),f=="add_zfriend"&&h.set({label:a.localize("str_invite_sent"),enabled:!1})}),g.wire("gameNameClick",function(a){a.trackCategory="suggestedFriends"}),g.wire("gameIconClick",function(a){a.trackCategory="suggestedFriends"}),a.declare("zid","avatar_size","common_friends","last_played_game","show_cta","str_view_profile","str_add_zfriend","str_num_common_zfriend","str_num_common_zfriends","str_invite_sent","stranger"),a.declareAndSet({show_close:!1,cta:"add_zfriend",t_content:'<div class="$$ zui_clearfix"><div class="$close$" /><div class="$avatar_wrapper$" /><div class="$content$"><a class="$name$" /><div class="$common_friends$" /><div class="$last_played_game$" /><div class="$cta$" /></div></div>'}),a.onStateChange("theme",function(){a.get("theme")==="small"&&(f.set("size","medium-zdc"),g.set("size","small"))}),a.bindStateToContent("show_close",function(){var b=a.$node("close");i||(i=c.getInstance("widgets/zdc/common/closebutton"),i.set("theme","dark"),i.getContent(function(a){b.html(""),b.append(a)}),i.wire("click",function(b){var c=k==1031?"homepage":"gamepage";a.fire({name:"removeSuggestedFriend",zid:a.get("zid"),bubble:!0,pageSource:c,pageGameId:k})}),a.addChild("close",i))}),a.bindStateToContent("avatar_size",function(a){f.set("size",a)}),a.bindStateToContent("cta",function(){h.set("label",l())}),a.bindStateToContent("zid",function(b){f.set("zid",b),f.getContent(function(b){a.$node("avatar_wrapper").html(""),a.$node("avatar_wrapper").append(b)}),f.wire("avatarClick",function(c){c.bubble=!1,a.fire({name:"suggested_friend_avatarClick",bubble:!0,zid:b,stranger:a.get("stranger")})}),e.getUserDataNonCached({uids:[b],snid:18},function(c){var d=c[b];if(d){j=d;var e=a.$node("name");e.html(d.displayName),e.attr("title",d.displayName),e.click(function(){a.fire({name:"userNameClick",zid:a.get("zid"),bubble:!0,displayName:d.displayName,stranger:a.get("stranger")}),a.fire({name:"suggested_friend_userNameClick",zid:a.get("zid"),bubble:!0,stranger:a.get("stranger")})})}})}),a.bindStateToContent("last_played_game",function(b){if(!b)return;g.set("game_id",b.id),g.set("gameName",b.name),g.getContent(function(b){var c=a.$node("last_played_game");c.html(""),c.append(b)})}),a.bindStateToContent("common_friends",function(b){b===1?a.$node("common_friends").html(a.localize("str_num_common_zfriend",{count:b})).css("display","block"):b>1?a.$node("common_friends").html(a.localize("str_num_common_zfriends",{count:b})).css("display","block"):a.$node("common_friends").css("display","none")}),a.bindStateToClass("show_cta",["hideCta",""],"cta"),a.once("content",function(){a.$root().mouseenter(function(){a.get("show_close")&&a.$node("close").css("visibility","visible")}),a.$root().mouseleave(function(){a.$node("close").css("visibility","hidden")})});var m=c.getInstance("widgets/zdc/services/gameboard");m.fireWire({name:"gameboard.railOpts",callback:function(a){k=a.gameId}}),a.createContent=function(b){a.need("$",function(c){var d=a.content=c(a.useTemplate("t_content"));h.set({theme:"zdc",size:"small",color:"white",label:l(),multiple_use:!0}),h.getContent(function(b){a.$node("cta").html(b)}),b(d)})}}})

ZY.ZUI.module({name:"widgets/zdc/common/suggestedfriends/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_common_suggestedfriends_suggestedfriends:{str_EmptyDescription:{original:"That's all for today, come back tomorrow for more friend suggestions."}}})}})

ZY.ZUI.module({name:"widgets/zdc/common/suggestedfriends",version:1,extend:"widgets/base",required:["widgets/zdc/common/suggestedfriend","widgets/zdc/services/game"],themes:["","vertical"],bubble:!0,localized:!0,constructor:function(a,b,c,d){function h(){a.get("active")&&a.get("hasContent")&&a.fire({name:"railActiveTabHasContent",bubble:!0})}function i(b){a.once("content",function(){a.get("theme")==="vertical"&&(b?a.$node("empty").fadeIn(500):a.$node("empty").css("display","block"))})}function j(b,d,e,g,h){a.need("$",function(i){f++,a.once("content",function(){a.set("hasContent",!0);var f=c.getInstance("widgets/zdc/common/suggestedfriend");a.get("theme")==="vertical"?(f.set("theme","small"),f.set("show_close",!0)):f.set("avatar_size","xlarge"),f.set("zid",b),f.set("common_friends",d),f.set("last_played_game",e),f.set("stranger",g),f.getContent(function(b){h?h(b):a.$root().prepend(b)}),a.addChild("suggestest_friend_"+b,f),a.fire({name:"rts_suggestedFriends_view",rtsList:"suggestedFriends",value:1,bubble:!0})})})}function k(b,c){a.need("$",function(d){for(var g=0;g<e.length;g++){var h=e[g];h.zid===b&&e.splice(g,1)}var k="suggestest_friend_"+b;if(a.children.hasOwnProperty(k)){var l=a.children[k];if(e.length){var m=e.shift();j(m.zid,m.common,m.game,m.stranger,function(b){var e=d(b);e.css("display","none"),l.$root().after(e),l.$root().fadeOut(500,function(){a.removeChild(k),f--,e.fadeIn(500,function(){c&&a.fire({name:"suggestedFriendDidDisplay",zid:m.zid,bubble:!0})})})})}else l.$root().fadeOut(500,function(){a.removeChild(k),f--,f||i(!0)})}})}var e=[],f=0,g=c.getInstance("widgets/zdc/services/game");a.declare("str_EmptyHeading","str_EmptyDescription","str_ViewProfileButton"),a.declareAndSet({active:!1,hasContent:!1,max_display:3,t_content:'<div class="$$ zui_clearfix"><div class="$empty$"><div class="small">%str_EmptyDescription%</div><div class="$smallDog$"/></div></div>'}),a.bindStateToContent("active",h),a.bindStateToContent("hasContent",h),a.createContent=function(b){a.need("$",function(c){var d=c(a.useTemplate("t_content"));b(d)})},a.wire("removeSuggestedFriend",function(a){k(a.zid,!0)}),a.wire("click_cta",function(b){a.fire({name:"userNameClick",zid:b.zid,bubble:!0})}),b({addUser:function(b,c,d,h){g.fetch({gids:d},function(d){if(f>=a.get("max_display")){e.push({zid:b,common:c,game:d,stranger:h});return}j(b,c,d,h,!1)})},noSuggestions:function(){i(!1)},noSuggestionsNoUi:function(){a.set("hasContent",!0)},removeUser:function(a){k(a,!1)}})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tab/suggestedFriends",version:1,extend:"widgets/zdc/common/rail/tab",required:["jquery/mousewheel","widgets/zdc/common/suggestedfriends","widgets/zdc/services/socialgraph","widgets/zdc/common/rail/friendfinder","widgets/zdc/services/experiments","widgets/gameicon","widgets/zdc/common/friendfinderGameSwitcher"],themes:[""],localized:!0,constructor:function(a,b,c,d){function m(){f=c.getInstance("widgets/zdc/common/suggestedfriends"),f.set({theme:"vertical",max_display:5}),a.addChild("suggested_friends",f),f.wire("avatarClick",function(b){a.track(["suggested_zfriends",null,"user_photo","click"])}),f.wire("userNameClick",function(b){b.cta?a.track(["suggested_zfriends",null,"CTA","click"]):a.track(["suggested_zfriends",null,"user_name","click"])}),f.wire("gameIconClick",function(b){a.track(["suggested_zfriends",null,"game_icon","click",b.gid])})}function n(){a.get("gid")==i?a.$node("suggested_subheader").css("display","none"):a.$node("suggested_subheader").css("display","table")}function o(){a.get("gid")==i?(l.resetPointer(),a.$node("game_tabs_header").css("display","inline")):a.$node("game_tabs_header").css("display","none")}function p(b){j&&(a.get("gid")||a.set("gid",i),j.set("gid",a.get("gid")),k.set("game_id",a.get("gid")),n(),b==4&&o())}function q(b){a.get("gid")||a.set("gid",i),j=a.addChild("friendFinder","widgets/zdc/common/rail/friendfinder",{gid:a.get("gid"),ffExp:b}),j.getContent(function(c){b==4?a.$node("friendFinderGames").html(c):a.$node("friendFinder").html(c),k=a.addChild("subHeadGameIcon","widgets/gameicon",{game_id:a.get("gid"),size:"large_dw",disable_click:!0}),k.getContent(function(b){a.$node("game_icon").html(b)}),n(),b==4&&(a.addChild("game_tabs_header","widgets/zdc/common/friendfinderGameSwitcher"),l.getContent(function(b){a.$node("game_tabs_header").html(b)}),o())})}function r(b){b!=i?a.track(["zdc_friend_finder","load","",b,"gamepage","view"]):a.track(["zdc_friend_finder","load","",b,"homepage","view"])}var e=c.getInstance("jquery/mousewheel"),f,g=c.getInstance("widgets/zdc/services/socialgraph"),h,i=1031,j,k,l=c.getInstance("widgets/zdc/common/friendfinderGameSwitcher");a.declare("suggested_friends","gid","body_only"),a.declare("str_heading","str_suggestedDescription","str_needZFriends","str_suggestPlayers","str_invite","str_heading_friendfinder","str_game_heading_friendfinder","str_heading_friendfinder_games_v1"),a.declareAndSet({displayInviteButton:!1,t_content:'<div class="$$"><div class="$heading$">%str_heading%</div><div class="$body$"><div class="$suggested_description$">%str_suggestedDescription%</div><div class="$suggested_description_empty$"><div class="large">%str_needZFriends%</div><div class="small">%str_suggestPlayers%</div></div><div class="$suggested$" /><div class="$footer$"><div class="$inviteButton$" /></div></div></div>',t_content_friendfinder:'<div class="$$"><div class="$heading$ zui_zdc_common_rail_tab_heading">%str_heading_friendfinder%</div><div class="$body$ zui_zdc_common_rail_tab_body"><div class="$suggested_subheader$"><div class="$game_description$">%str_game_heading_friendfinder%:</div><div class="$game_icon$" /></div><div class="$friendFinder$" /></div></div>',t_content_friendfinder_games:'<div class="$$ zui_zdc_common_rail_tab_friendfinder-games"><div class="$heading$ zui_zdc_common_rail_tab_heading">%str_heading_friendfinder_games_v1%</div><div class="$body$ zui_zdc_common_rail_tab_body-games"><div class="$suggested_subheader$"><div class="$game_description$">%str_game_heading_friendfinder%:</div><div class="$game_icon$" /></div><div class="$game_tabs_header$" /><div class="$friendFinderGames$" /></div></div>'}),m(),a.bindStateToContent("suggested_friends",function(b){b.length?a.$node("suggested_description").css("display","block"):(f.noSuggestions(),a.$node("suggested_description").css("display","none"));for(var c=0;c<b.length;c++){var d=b[c];f.addUser(d.zid,d.common,d.gameId,d.stranger)}f.getContent(function(c){a.$node("suggested").append(c),a.track(["zdc_friend_finder","content_loaded",b.length,a.get("gid"),"","reference"])})});var s=c.getInstance("widgets/zdc/services/gameboard");s.fireWire({name:"gameboard.railOpts",callback:function(b){var d=c.getInstance("widgets/zdc/services/experiments"),e=d.getExperimentValue({name:"zdcFriendFinderV2"}),f=b.gameId;a.set("gid",f),h&&h!=f?(h=f,e>=2&&p(e),r(f)):h||(h=f,r(f))}}),a.createContent=function(b){a.need("$",function(d){var e=c.getInstance("widgets/zdc/services/experiments"),f=e.getExperimentValue({name:"zdcFriendFinderV2"});if(f==4)a.track(["Friend_finder_entry_flow","right_rail"]),a.content=d(a.useTemplate("t_content_friendfinder_games")),q(f);else if(f>=2&&f<=5)a.content=d(a.useTemplate("t_content_friendfinder")),q(f);else{a.content=d(a.useTemplate("t_content"));if(a.get("displayInviteButton")){var g=c.getInstance("widgets/button");g.set({theme:"zdc",size:"large",color:"blue",label:a.localize("str_invite"),multiple_use:!0}),g.getContent(function(b){a.$node("inviteButton").append(b)}),g.wire("click",function(){a.fire({name:"inviteFriendsClick",bubble:!0})})}}a.get("body_only")===!0&&a.$node("heading").hide(),b(a.content)})},a.once("content",function(){g.getSuggestedFriends({},function(b){a.set("suggested_friends",b.response)}),e.once("initialized",function(){setTimeout(function(){a.need("$",function(b){e.containScrollWheel(a.$node("body"))})},0)}),l.wire("newGameSelected",function(b){var c=b.game_id;a.track(["Friend_finder_game_selection",c]),j.set("gid",c),j.set("gameLevelMap",b.gameLevelMap)})}),b({removeSuggestedUser:function(a){f.removeUser(a)}})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tab/addFriends",version:1,extend:"widgets/zdc/common/rail/tab",themes:[""],localized:!0,required:["widgets/zdc/common/togglebuttons","widgets/zdc/common/rail/tab/suggestedFriends","widgets/zdc/common/rail/tab/cliTab"],constructor:function(a,b,c,d){function l(){var b=a.get("selected_tab")=="CLI"?1:0;a.fire({name:"changeAdPosition",value:b,bubble:!0})}var e=c.getInstance("widgets/zdc/common/togglebuttons"),f,g,h,i,j,k;a.declare("str_ff_text_v3","str_cli_text_v3","str_heading_v3"),a.declare("default_selection","selected_tab"),a.declareAndSet({CLI:0,FF:1}),a.declareAndSet({t_content:'<div class="$$"><div class="$heading$"><span> %str_heading_v3% </span><div class="$togglebuttons$" /></div><div class="$childTabContainer$" ><div class = "$suggestedFriendsContainer$" /><div class = "$cliContainer$" /></div></div>'}),a.createContent=function(b){a.need("$",function(c){a.content=c(a.useTemplate("t_content")),a.set("default_selection",a.get("CLI"));var d=e.getContent(function(b){a.$node("togglebuttons").append(b)});i=a.$node("rootText"),f=a.$node("childTabContainer"),g=a.$node("suggestedFriendsContainer"),h=a.$node("cliContainer");var m=a.localize("str_cli_text_v3"),n=a.localize("str_ff_text_v3"),o=[m,n];e.set({buttons:o,selected:0}),j=a.addChild("suggestedFriends","widgets/zdc/common/rail/tab/suggestedFriends",{body_only:!0}),j.getContent(function(a){g.append(a)}),k=a.addChild("cliTab","widgets/zdc/common/rail/tab/cliTab",{body_only:!0}),k.getContent(function(a){h.append(a)}),a.get("default_selection")==a.get("FF")?(h.hide(),a.set("selected_tab","FF")):(g.hide(),a.set("selected_tab","CLI")),l(),b(a.content)})},a.once("content",function(b){e.wire("toggleButtonsChanged",function(b){var c=b.selected;c==a.get("FF")?(a.fire({name:"showCLIDialog",value:!1,bubble:"true"}),h.hide(),g.show(),a.set("selected_tab","FF")):(g.hide(),h.show(),a.set("selected_tab","CLI")),l()}),ZY.ZUIWidgetProxy.wire("adPositionBasedOnTab",function(){l()})}),b({})}})

ZY.ZUI.module({name:"jquery/textoverflow",version:1,extend:"base",singleton:!0,constructor:function(a,b,c,d){a.need("$",function(b){(function(a){var b=document.documentElement.style,c="textOverflow"in b||"OTextOverflow"in b,d=function(b,c){var d=0,e=[],f=function(b){var g=0,h;if(d>c)return;for(g=0;g<b.length;g+=1)b[g].nodeType===1?(h=b[g].cloneNode(!1),e[e.length-1].appendChild(h),e.push(h),f(b[g].childNodes),e.pop()):b[g].nodeType===3?(d+b[g].length<c?e[e.length-1].appendChild(b[g].cloneNode(!1)):(h=b[g].cloneNode(!1),h.textContent=a.trim(h.textContent.substring(0,c-d)),e[e.length-1].appendChild(h)),d+=b[g].length):e.appendChild(b[g].cloneNode(!1))};return e.push(b.cloneNode(!1)),f(b.childNodes),a(e.pop().childNodes)};a.extend(a.fn,{textOverflow:function(b,e){var f=b||"&#x2026;";return c?this:this.each(function(){var c=a(this),g=c.clone(),h=c.clone(),i=c.text(),j=c.width(),k=0,l=0,m=i.length,n=function(){j!==c.width()&&(c.replaceWith(h),c=h,h=c.clone(),c.textOverflow(b,!1),j=c.width())};c.after(g.hide().css({position:"absolute",width:"auto",overflow:"visible","max-width":"inherit"}));if(g.width()>j){while(k<m)l=Math.floor(k+(m-k)/2),g.empty().append(d(h.get(0),l)).append(f),g.width()<j?k=l+1:m=l;k<i.length&&c.empty().append(d(h.get(0),k-1)).append(f)}g.remove(),e&&setInterval(n,200)})}})})(b),a.done("initialized")}),b({once:a.once})}})

ZY.ZUI.module({name:"widgets/zdc/common/friendselector/friendlist/item",version:1,extend:"widgets/listitem",required:["widgets/zdc/common/avatar","jquery/textoverflow"],themes:[""],constructor:function(a,b,c,d){var e=a._super,f=c.getInstance("jquery/textoverflow");a.declare("zid","name"),a.declareAndSet({t_content:'<div class="$$"><div class="$avatar$"/><div class="$name$ zui_ellipsis"/></div>'}),a.bindStateToContent("name"),a.createContent=function(b){e.createContent(function(c){a.need("$",function(d){a.content=d(c);var e=a.addChild("avatar","widgets/zdc/common/avatar",{size:"tiny"});e.getContent(function(b){a.$node("avatar").html(b),a.done("avatar_created")}),a.bind(e,["zid"]),a.once("avatar_created",function(){b(a.content)})})})},a.once("content",function(){a.$node().click(function(){a.fire({name:"friend_selected",zid:a.get("zid"),bubble:!0})}),a.wire("select",function(){a.$node().addClass("selected")}),a.wire("deselect",function(){a.$node().removeClass("selected")}),a.done("initialized")}),b({truncateText:function(){f.once("initialized",function(){var b=a.get("name"),c=a.$node("name");c.text(b),b?c.textOverflow("&hellip;"):c.hide()})}})}})

ZY.ZUI.module({name:"widgets/zdc/common/friendselector/friendlist",version:1,extend:"widgets/list",required:["widgets/zdc/services/socialgraph","widgets/zdc/common/friendselector/friendlist/item"],themes:[""],constructor:function(a,b,c,d){function f(a){return{zid:a.zid,name:a.displayName}}var e=c.getInstance("widgets/zdc/services/socialgraph");a.set({noResultsIfFilterTextEmpty:!0,sort:["name"]}),a.makeItemWidgetClass=function(a){return"widgets/zdc/common/friendselector/friendlist/item"},a.makeItemWidgetName=function(a){return a.zid},a.getItemsData=function(a){e.getFriends({},function(b){var c=d.toArray(b);for(var e=c.length,g;--e>=0;)c[e]=f(c[e]);a(c)})},a.getItemTextToSearch=function(a){return a.name}}})

ZY.ZUI.module({name:"widgets/zdc/common/friendselector/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_common_friendselector_friendselector:{str_enterName:{original:"Enter Name"},str_to:{original:"To:"},str_ctaHeading:{original:"Who's your type?"},str_ctaBody:{original:"Type the name of a zFriend to find them and chat."},str_nullStateMsg:{original:"We got nothin'."}}})}})

ZY.ZUI.module({name:"widgets/filterbox/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_filterbox_filterbox:{str_hint:{original:""}}})}})

ZY.ZUI.module({name:"widgets/filterbox",version:1,extend:"widgets/base",localized:!0,constructor:function(a,b,c,d){function e(){var b=a.$node("textbox"),c=a.get("isBlurredAndEmpty")?a.localize("str_hint"):a.get("filterText");c!=b.val()&&b.val(c)}a.declare("filterText","isEmpty","isFocused","isBlurredAndEmpty","str_hint"),a.onStateChange("filterText",function(){a.set("isEmpty",!a.get("filterText")),a.fire({name:"filterChange",text:a.get("filterText")})}),a.onStateChange(["isEmpty","isFocused"],function(){a.set("isBlurredAndEmpty",!a.get("isFocused")&&a.get("isEmpty"))}),a.bindStateToContent("str_hint",e),a.bindStateToContent("isBlurredAndEmpty",function(b){e(),a.$node()[b?"removeClass":"addClass"]("zui_hastext")}),a.bindStateToContent("filterText",function(){e()}),a.declareAndSet({t_content:'<div class="$$"><input class="$textbox$" type="text"></input></div>'}),a.set({filterText:"",isFocused:!1});var f,g;a.createContent=function(b){a.need("$",function(c){f=c(a.useTemplate("t_content")),b(f)})},a.once("content",function(){var b=a.$node("textbox");b.focus(function(){a.set("isFocused",!0)}),a.$node("textbox").blur(function(){a.set("isFocused",!1)}),a.$node("textbox").keyup(function(b){a.set("filterText",a.$node("textbox").val()),a.fire({name:"keyup",event:b})}),a.done("initialized")}),b({focus:function(){a.$node("textbox").focus()},setEmpty:function(){a.set("filterText",""),a.$node("textbox").val(""),a.$node("textbox").blur()}})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tab/chat/filterbox",version:1,extend:"widgets/filterbox",themes:[""],constructor:function(a,b,c,d){function j(){a.need("$",function(b){a.$node().animate({width:f},i,function(){a.$node("clearbutton").show(),a.$node("textbox").width(h)})})}function k(){a.need("$",function(b){a.$node("textbox").width(g),a.$node("clearbutton").hide(),a.$node().animate({width:e},i,function(){})})}var e=100,f=165,g=64,h=110,i=200;a.declareAndSet({t_icon:'<div class="$icon$" />',t_clearbutton:'<div class="$clearbutton$" />'}),a.once("content",function(){a.$node().prepend(a.useTemplate("t_icon")),a.$node().append(a.useTemplate("t_clearbutton")),a.$node("textbox").focus(function(){a.track(["ZDC_zfriends","search","","","click",""]),j()}),a.$node("textbox").blur(function(){a.get("isEmpty")&&k()}),a.$node("clearbutton").click(function(){a.set("filterText",""),k()})}),b({})}})

ZY.ZUI.module({name:"widgets/zdc/common/friendselector",version:1,extend:"widgets/base",required:["widgets/zdc/common/rail/tab/chat/filterbox","widgets/zdc/common/friendselector/friendlist"],themes:[""],localized:!0,constructor:function(a,b,c,d){a.declare("str_ctaHeading","str_ctaBody","str_nullStateMsg"),a.declareAndSet({t_content:'<div class="$$"><div class="$friendSelectorCta$"><div class="$friendSelectorCtaHeading$">%str_ctaHeading%</div><div class="$friendSelectorCtaBody$">%str_ctaBody%</div></div><div class="$filterboxShell$"><div class="$filterbox$"/></div><div class="$friendlistShell$"><div class="$nullState$">%str_nullStateMsg%</div></div>'}),a.createContent=function(b){a.need("$",function(c){a.content=c(a.useTemplate("t_content"));var d=a.addChild("filterbox","widgets/zdc/common/rail/tab/chat/filterbox");d.getContent(function(b){a.$node("filterbox").html(b),a.done("filterbox_created")});var e=a.addChild("friendlist","widgets/zdc/common/friendselector/friendlist");e.getContent(function(b){a.$node("friendlistShell").append(b),a.done("friendlist_created")}),a.once(["filterbox_created","friendlist_created"],function(){d.bind(e,"filterText"),b(a.content)})})},a.once("content",function(){a.children.filterbox.wire("Changed:filterText",function(b){b.newValue===""?a.$node("friendlistShell").css("display","none"):(a.$node("friendlistShell").css("display","block"),a.children.friendlist.itemsLazyLoadCheck(),a.children.friendlist.getVisibleItemsCount()===0?a.$node("nullState").css("display")=="none"&&a.$node("nullState").css("display","block"):a.$node("nullState").css("display")=="block"&&a.$node("nullState").css("display","none"))}),a.wire({friend_selected:function(){a.children.filterbox.set("filterText","")}})}),b({focus:function(){a.children.filterbox.focus()},setEmpty:function(){a.children.filterbox.setEmpty()}})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tab/chat/friendselector",version:1,extend:"widgets/zdc/common/friendselector",themes:[""],localized:!1,constructor:function(a,b,c,d){a.once("content",function(){a.wire({friend_selected:function(b){a.fire({name:"loadFriendConversation",toZid:b.zid,bubble:!0})}})}),b({})}})

ZY.ZUI.module({name:"widgets/zdc/services/zoom/messaging-zdc",version:1,extend:"services/adapter",required:["data/json","widgets/zdc/services/zoom"],singleton:!0,constructor:function(a,b,c,d){function j(a){var b;try{b=decodeURIComponent(a)}catch(c){b=unescape(a)}return f.from(b)}function k(a){if(a.name==="chunk"){if(a&&a.msg&&a.msg.msg)for(var b=0;b<a.msg.msg.length;b++){var c=a.msg.msg[b];c&&c.msg&&(c.msg=j(c.msg))}return a.msg.msg}var d;return a.msg.c&&(d=parseInt(a.msg.c,10))&&g.fire({name:h.NEW_COUNT,count:d}),a.msg.msg&&a.msg.msg.msg&&(a.name=h.NEW_MESSAGE,a.msg.msg.msg=j(a.msg.msg.msg),a.newMessage=a.msg.msg),a}var e=c.getInstance("widgets/zdc/services/zoom"),f=c.getInstance("data/json"),g,h,i="omsg";b({init:function(b,c){g=b.serviceInterface,h=g.get("EVENTS"),e.registerPlugin({commands:["imsg"],svcInterface:g,module:a,parseOnReceive:k}),c()},getUnreadMessageCount:function(a,b){e.send({command:e.getCommand({service:i,command:"new"})}),b()},clearUnreadMessageCount:function(a,b){e.send({command:e.getCommand({service:i,keyVals:{read:-1}})}),b()},decrementUnreadMessageCount:function(a,b){e.send({command:e.getCommand({service:i,keyVals:{read:1}})}),b()},refreshUnreadMessageCount:function(a,b){e.send({command:e.getCommand({service:i,keyVals:{"new":null}})}),b()},sendMessage:function(a,b){e.send({command:e.getCommand({service:i,keyVals:{to:a.to,msg:encodeURIComponent(f.to(a.msg))}})}),b()},getMessages:function(a,b){e.send({command:e.getCommand({service:i,command:"chunk get",keyVals:a}),callback:function(a){b&&b(a)}})},deleteMessages:function(a,b){var c=a.ids||[];if(!c.length){b();return}e.send({command:e.getCommand({service:i,keyVals:{del:c.join(",")}})}),b()}})}})

ZY.ZUI.module({name:"widgets/zdc/services/zoom/messaging",version:1,extend:"services/base",singleton:!0,constructor:function(a,b,c,d){a.declareAndSet({EVENTS:{NEW_COUNT:"COUNT",NEW_MESSAGE:"NEW_MSG"}}),a.declareServiceMethods({getUnreadMessageCount:{async:!1},clearUnreadMessageCount:{async:!1},decrementUnreadMessageCount:{async:!1},refreshUnreadMessageCount:{async:!1},sendMessage:{async:!1},getMessages:{async:!0},deleteMessages:{async:!1},init:{async:!1}})}})

ZY.ZUI.module({name:"widgets/zdc/services/messaging-zoom",version:1,extend:"services/adapter",required:["widgets/zdc/services/user","widgets/zdc/services/game","services/track","widgets/zdc/services/zoom/chat","widgets/zdc/services/zoom/groupChat","widgets/zdc/services/zoom/messaging","widgets/zdc/services/socialgraph"],singleton:!0,constructor:function(a,b,c,d){function J(a){return a==q?t:C[a]}function K(b){var c={},d={participants:c,messages:[]};for(var e=-1,f=b.length,g;++e<f;)c[g=b[e]]=g==q?t:C[g],a.isNully(c[g])&&(c[g]={});return d}function L(a){a=typeof a=="string"?a:a.join(",");var b=a.replace(r,"").match(s);return b&&b.length?b[1]:a}function M(a){return a.sort().join(",")}function N(a){return M([q,a])}function O(a){D&&D.set(a)}function P(){return D&&D.get()||{}}function Q(a){return P()[a]}function R(b){a.once("userInfoLoaded",function(){if(!b.hasOwnProperty("msg")||!b.msg.hasOwnProperty("conversationId"))return;var c=b.msg,e=c.conversationId,g=e.split(","),h=b.from,j=h==q,k=L(g),l=J(k),m=!1,o,p=c.text,r=c.ts,s=b.gid,t={text:p,gid:s,date:r,from:j?"me":h};l||(C[k]={lastMessage:t},l=J(k));if(y[e]){for(var u=z.length,D;--u>=0;)if((D=z[u]).id==e){o=D;break}}else m=!0,z.push(o={id:e,zid:k}),y[e]=K(g),A[e]={};o.lastMessage=t,o.lastMessageDate=r,o.lastReadDate=Q(e);if(!b.id)B[c.id]=!0;else{if(!v||b.ts>=v.ts)v&&v.from!=b.from&&(x=0),v=b,x++;if(A[e][b.id])return;A[e][b.id]=!0,y[e].messages.push(b);if(B[c.id]){delete B[c.id];return}}var E=l.lastMessage?l.lastMessage.date:null;(a.isNully(E)||r>=E)&&n(k,{lastMessage:t}),m&&f.fire({name:"newConversation",conversation:d.extend({},o)}),j||(w&&r>w&&i.track(["zdc_chat","messages_view","message","","receive",""]),f.fire({name:"messageReceived",messageId:b.id,conversationId:e,from:h,text:p,details:c.details,date:r,gid:s})),f.fire({name:"newMsg",msg:b,header:o})})}function S(b){if(!F){F=!0;var c={};p&&(c.limit=p),l.getMessages(c,function(b){for(var c=0;c<b.length;c++)R(b[c]);a.done("conversations_data_fetched")})}a.once("conversations_data_fetched",function(){b()})}var e=function(){},f,g=c.getInstance("widgets/zdc/services/user"),h=c.getInstance("widgets/zdc/services/game"),i=c.getInstance("services/track"),j=c.getInstance("widgets/zdc/services/zoom/chat"),k=c.getInstance("widgets/zdc/services/zoom/groupChat"),l=c.getInstance("widgets/zdc/services/zoom/messaging"),m=c.getInstance("widgets/zdc/services/socialgraph"),n,o,p=null,q,r,s=/^(\d+)(,|$)/,t,u,v,w,x=0,y={},z=[],A={},B={},C={},D,E,F=!1,G=0,H=!1,I=1e3;n=function(a,b){var c=J(a);if(c){var d,e=function(a,b){b!==c[a]&&((d||(d={}))[a]=c[a]=b)};if(b)for(var g in b)b.hasOwnProperty(g)&&e(g,b[g]);d&&f.fire({name:"userInfoChanged",userInfo:c,propertiesChanged:d})}},b({getMaxMessageChars:function(a,b){b(I)},getConversations:function(b,c){S(function(){c(a.cloneRecords(z))})},getConversationDetails:function(a,b){S(function(){b(y[a.id]||K(a.id.split(",")))})},getLastMessagesSummary:function(a,b){S(function(){b({lastMessage:v,totalLastMessagesFromSameSender:x})})},removeConversation:function(a,b){var c=a.id,d=y[c];if(d){for(var e=z.length;--e>=0;)if(z[e].id==c){z.splice(e,1);break}var g=d.messages,h=[];for(var i in g)g.hasOwnProperty(i)&&h.push(g[i].id);delete y[c],delete A[c],n(L(c),{lastMessage:{},lastReadDate:undefined}),f.fire({name:"removeConversation",cId:c}),h.length&&l.deleteMessages({ids:h})}b()},sendMessage:function(a,b){function e(a){return a.search(",")!==-1}if(!e(a.conversationId)){k.message({groupID:a.conversationId,message:a.msg,msgSelf:0},function(a){b&&b()});return}!a.msg&&b&&b();var g=c.now(),h=g+""+ ++G,i={messageId:h,conversationId:a.conversationId,from:q,text:a.msg,details:a.details,date:g,gid:o};for(var j=-1,m=a.conversationId.split(",");++j<m.length;)if(m[j]!=q){var n=J(m[j]);n&&!n.online&&f.fire({name:"messageSentToOfflineRecipient",to:m[j],text:a.msg,details:a.details}),f.fire(d.extend(i,{name:"messageSent"}))}l.sendMessage({to:a.conversationId,msg:{id:h,conversationId:a.conversationId,text:a.msg,details:a.details,ts:g}}),b()},notifyUserTyping:function(a,b){g.getUserData({uids:a.zid},function(b){b.online&&j.notifyUserTyping({from:q,to:a.zid,isTyping:a.isTyping})}),b()},refreshUnreadMessageCount:function(a,b){l.refreshUnreadMessageCount(),b()},clearUnreadMessageCount:function(a,b){l.clearUnreadMessageCount(),b()},decrementUnreadMessageCount:function(a,b){l.decrementUnreadMessageCount(),b()},updateConversationRead:function(a,b){var c=a.conversationId,d=a.lastReadDate,e=P();e[c]=d,O(e),f.fire({name:"updateConversationRead",conversationId:c,lastReadDate:d}),n(L(c),{lastReadDate:d}),b()},init:function(b,h){f=b.serviceInterface,D=b.localStorage,q=b.myZid,r=new RegExp("(^|,)"+q+"(,|$)"),u=b.currentUserOnline!==!1,o=b.gameId,p=b.chatInboxMaxSize,w=c.now();var i=l.get("EVENTS");l.wire(i.NEW_COUNT,function(a){f.fire({name:"newCount",count:a.count})}),l.wire(i.NEW_MESSAGE,function(a){a.newMessage&&R(a.newMessage)});var m=j.get("EVENTS");j.wire(m.TYPING,function(a){var b=a.msg;f.fire({name:"participantTyping",zid:b.from.toString(),isTyping:b.body})});var n=k.get("EVENTS");k.wire("GroupMemberJoined",function(a){f.fire({name:"participantAdded",group:a.group,user:a.user})}),k.wire("GroupMemberLeft",function(a){f.fire({name:"participantRemoved",group:a.group,zid:a.zid})}),k.wire("GroupLeftByCurrentUser",function(a){f.fire({name:"currentUserLeftGroup",groupID:a.groupID})}),k.wire("GroupMessagesReceived",function(a){var b=a.messages,c=a.group.groupID;for(var d=0;d<b.length;d++){var e=b[d];f.fire({name:"newMsg",header:{id:c,groupID:c,lastMessage:{},lastMessageDate:1333408990597,lastReadDate:null,zid:40100071471,name:"name"},msg:e})}}),k.wire("GroupJoinedByCurrentUser",function(a){k.getConversationDetails({groupID:a.groupID},function(a){var b=a.groupID;f.fire({name:"newConversation",conversation:{id:b,groupID:b,lastMessage:{},lastMessageDate:a.modified,zid:q,gid:243}})})}),H||(H=!0,a.refreshUnreadMessageCount({},e)),g.getCurrentUserData({},function(b){t=d.extend(b,{online:u}),a.done("userInfoLoaded"),h()})}})}})

ZY.ZUI.module({name:"widgets/zdc/services/messaging",version:1,extend:"services/base",singleton:!0,constructor:function(a,b,c,d){a.declareServiceMethods({getMaxMessageChars:{async:!1},getConversations:{async:!0},getConversationDetails:{async:!0},removeConversation:{async:!0},getLastMessagesSummary:{async:!0},sendMessage:{async:!0},notifyUserTyping:{async:!0},refreshUnreadMessageCount:{async:!0},clearUnreadMessageCount:{async:!0},decrementUnreadMessageCount:{async:!0},updateConversationRead:{async:!0},init:{async:!0}})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tab/chat/list",version:1,extend:"widgets/list",required:["widgets/zdc/services/user","widgets/zdc/services/messaging","widgets/zdc/services/socialgraph"],themes:[""],constructor:function(a,b,c,d){a.userService=c.getInstance("widgets/zdc/services/user"),a.messagingService=c.getInstance("widgets/zdc/services/messaging"),a.socialGraphService=c.getInstance("widgets/zdc/services/socialgraph")}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tab/chat/list/conversationlist/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_common_rail_tab_chat_list_conversationlist_conversationlist:{str_emptyMessageHeading:{original:"Talk amongst yourselves."},str_emptyMessageBody:{original:"Start a chat on the zFriends tab for <br /> a little afternoon delight while you play."},str_emptyMessageCtaText:{original:"Start Chat"}}})}})

ZY.ZUI.module({name:"widgets/scrollbundle",version:1,extend:"widgets/base",constructor:function(a,b,c,d){a.declareAndSet({t_content:'<div class="$$"><div class="$button$ $scrollup$"/><div class="$button$ $scrolldown$"/></div>'}),a.createContent=function(b){a.need("$",function(c){var d=c(a.useTemplate("t_content"));b(d)})},a.once(["content"],function(){a.$node("scrollup").click(function(b){a.fire({name:"scroll",top:200})}),a.$node("scrolldown").click(function(b){a.fire({name:"scroll",top:-200})})})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tab/chat/list/scrollbundle",version:1,extend:"widgets/scrollbundle",themes:[""]})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tab/chat/listitem/conversationlistitem/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_common_rail_tab_chat_listitem_conversationlistitem_conversationlistitem:{str_waitingOnResponse:{original:"waiting for response..."}}})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tab/chat/listitem/conversationlistitem",version:1,extend:"widgets/base",required:[],themes:[""],localized:!0,constructor:function(a,b,c,d){var e=1e3;a.declareAndSet({t_content:'<div class="$$"><div class="$icon$" /><div class="$highlight$" /></div>'}),a.declare("id","lastMessage","lastMessageGid","lastMessageFromWho","lastMessageDate","lastReadDate","selected","visible","highlighted"),a.bindStateToClass("selected"),a.bindStateToClass("highlighted"),a.onStateChange("selected",function(b){b.newValue===!0&&a.set("highlighted",!1)}),a.onStateChange("lastMessage",function(){var b=a.get("lastMessage");b&&a.set({lastMessageGid:b.gid,lastMessageDate:b.date,lastMessageFromWho:b.from=="me"?"Me":"Them"})}),a.onStateChange(["lastMessageFromWho","lastMessageDate","lastReadDate"],function(){var b=a.get("lastMessageDate"),c=a.get("lastReadDate");a.set("highlighted",a.get("lastMessageFromWho")!="Me"&&!a.isNully(b)&&(a.isNully(c)||+c<+b))}),a.createContent=function(b){a.need("$",function(c){a.content=c(a.useTemplate("t_content")),b(a.content)})},a.show=function(){var b=a.$root().parent();b.parent().prepend(b.detach()),b.slideDown(e)},a.hide=function(){a.$root().parent().slideUp("fast")},b({})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tab/chat/listitem/conversationlistitem/friendconversationlistitem",version:1,extend:"widgets/zdc/common/rail/tab/chat/listitem/conversationlistitem",required:["widgets/zdc/common/avatar"],themes:[""],localized:!1,constructor:function(a,b,c,d){a.declare("zid"),a.provide("avatar",function(b){var c=a.addChild("avatar","widgets/zdc/common/avatar");c.set({size:c.SIZE_TINY,disable_click:!0,gravity:"sw"}),c.getContent(function(d){a.$node("icon").append(d),b(c)}),c.once("tooltipInit",function(){c.children.tooltip.set("secondary",a.$node("highlight"))})}),a.onStateChange("id",function(b){var c=b.newValue.split(",");c.length==2&&a.set("zid",c[1])}),a.bindStateToContent("zid",function(b){a.need("avatar",function(a){a.set("zid",b)})}),a.once("content",function(){a.$node("").click(function(){a.fire({name:"loadFriendConversation",toZid:a.get("zid"),bubble:!0})})}),b({})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tab/chat/listitem/conversationlistitem/groupconversationlistitem",version:1,extend:"widgets/zdc/common/rail/tab/chat/listitem/conversationlistitem",required:["widgets/gameicon"],themes:[""],localized:!1,constructor:function(a,b,c,d){a.declare("groupID","gid","zid"),a.provide("gameicon",function(b){var c=a.addChild("gameicon","widgets/gameicon");c.set({size:c.SIZE_SMALL,disable_click:!0,show_tooltip:!0,gravity:"sw"}),c.getContent(function(d){a.$node("icon").append(d),b(c)})}),a.bindStateToContent("gid",function(b){a.need("gameicon",function(a){a.set("game_id",b)})}),a.once("content",function(){a.$node("").click(function(){a.fire({name:"loadGroupConversation",conversationId:a.get("id"),bubble:!0})})}),b({})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tab/chat/list/conversationlist",version:1,extend:"widgets/zdc/common/rail/tab/chat/list",required:["widgets/zdc/common/rail/tab/chat/listitem/conversationlistitem/friendconversationlistitem","widgets/zdc/common/rail/tab/chat/listitem/conversationlistitem/groupconversationlistitem","widgets/zdc/common/rail/tab/chat/list/scrollbundle"],themes:[""],localized:!0,constructor:function(a,b,c,d){function j(b){var c=new RegExp("(^|,)"+b+"(,|$)");for(var d=a.get("items"),e=d.length,f;--e>=0;)if(c.test(f=d[e].id))return f}function k(b){var c;for(var d=a.get("items"),e=d.length;--e>=0;)if(a.makeItemWidgetName(d[e])==b){c=a.getItemWidget(d[e]);break}return c}function l(b){for(var c=a.get("items"),d,e=c.length;--e>=0;)a.makeItemWidgetName(c[e])&&(d=a.getItemWidget(c[e]),b(d))}var e=a._super,f,g=1e3,h,i=c.now();a.declare("gid"),a.declareAndSet({scrollBuffer:{top:0,right:0,bottom:50,left:0},scrollButtons:!0}),a.once("content",function(){a.userService.getCurrentUserData({},function(a){f=a}),a.done("initialized")}),a.makeItemWidgetClass=function(a){return a.groupID?"widgets/zdc/common/rail/tab/chat/listitem/conversationlistitem/groupconversationlistitem":"widgets/zdc/common/rail/tab/chat/listitem/conversationlistitem/friendconversationlistitem"},a.makeItemWidgetName=function(a){return a.id},a.makeScrollWidgetClass=function(){return"widgets/zdc/common/rail/tab/chat/list/scrollbundle"},a.getItemsData=function(b){a.messagingService.getConversations({},function(c){b(c),a.once("items_inserted",function(){for(var b=0;b<c.length;b++)a.updateItemData({id:c[b].id},{lastMessage:c[b].lastMessage,lastMessageDate:c[b].lastMessage&&c[b].lastMessage.date})})})},a.addItem=function(b){e.addItem.call(a,b,function(a){a.parent().prepend(a.detach()),a.hide().slideDown(g)})},a.removeItem=function(b){a.messagingService.removeConversation({id:b},function(){var c=k(b);if(c){var d=c.$root().parent();d.fadeTo("fast",0,function(){d.slideUp("fast",function(){e.removeItem.call(a,b)})})}})},a.setSelected=function(b){a.track(["zdc_chat","messages_view","","","view",""]),a.itemsLazyLoadCheck();var c=k(b);c&&(c.set("selected",!0),a.showItem(b)),h=b},a.resetSelected=function(){a.itemsLazyLoadCheck(),l(function(a){a&&a.set("selected",!1)}),h=null},a.dataFiltered=function(a){return a.get("lastMessageDate")<i&&!a.get("selected")},a.once("getItemsData",function(){a.messagingService.wire({newConversation:function(b){a.addItem(b.conversation),b.conversation.id==h&&a.setSelected(h)},userInfoChanged:function(b){var c=b.userInfo;if(f&&c.zid!=f.zid){var d=j(c.zid);if(d){var e=c.lastMessage;a.updateItemData({id:d},{lastMessage:e,lastMessageDate:e&&e.date})}}},currentUserLeftGroup:function(b){a.fire({name:"hideConversation",bubble:!0}),a.removeItem(b.groupID)}}),a.socialGraphService.wire({friendRemoved:function(b){var c=j(b.friend.zid);c&&a.removeItem(a.makeItemWidgetName({id:c}))}})}),b({removeItem:a.removeItem,hideItem:a.hideItem,setSelected:a.setSelected,resetSelected:a.resetSelected})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tab/chat/list/friendlist/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_common_rail_tab_chat_list_friendlist_friendlist:{str_emptyMessageHeading:{original:"Here comes the neighborhood!"},str_emptyMessageBody:{original:"Invite friends to Zynga so you can <br /> pow wow while you're playing."},str_emptyMessageCtaText:{original:"Invite Friends"},str_onlineFriendsHeading:{original:"Online ({count})"},str_offlineFriendsHeading:{original:"Offline ({count})"}}})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tab/chat/listitem",version:1,extend:"widgets/listitem",required:"widgets/zdc/common/avatar",themes:[""],constructor:function(a,b,c,d){var e=a._super;a.declare("zid","name","online"),a.declareAndSet({t_content:'<div class="$$"><div class="$highlight$"/><div class="$contents$"><div class="$avatar$"/><div class="$textContainer$">%t_textContainerContents%</div></div></div>',t_textContainerContents:'<span class="$name$ zui_ellipsis"/>'}),a.bindStateToClass("online",["offline","online"]),a.set("online",!1),a.createContent=function(b){e.createContent(function(c){a.need("$",function(d){a.content=d(c),a.$node("textContainer").html(a.useTemplate("t_textContainerContents"));var e=a.addChild("avatar","widgets/zdc/common/avatar",{zid:a.get("zid"),size:"medium-zdc",miniprofile:!1,show_tooltip:!1});e.getContent(function(b){a.$node("avatar").html(b),a.done("avatar_created")}),a.bind(e,["online"]),a.once("avatar_created",function(){b(a.content)})})})},a.once("content",function(){a.done("initialized")}),a.once("initialized",function(){a.onStateChange("name",a.indicateChange)})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tab/chat/listitem/friendlistitem/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_common_rail_tab_chat_listitem_friendlistitem_friendlistitem:{str_playingOnZynga:{original:"playing on Zynga"},str_lastPlayed:{original:"last played {date}"},str_offlineMessage:{original:"Offline"},str_onlineMessage:{original:"Online"},str_chatButtonTooltip:{original:"Send a message"}}})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tab/chat/listitem/friendlistitem",version:1,extend:"widgets/zdc/common/rail/tab/chat/listitem",required:["widgets/button","widgets/gameicon","widgets/zdc/common/tooltip"],themes:[""],localized:!0,constructor:function(a,b,c,d){function g(b){a.fire({name:"track",data:b,bubble:!0})}function h(){var b=a.get("lastPlayedGameDate"),c=a.get("gid");f.fetch({gids:c},function(d){a.set("playingText",a.isNully(b)?c?d&&d.name?d.name:"":a.get("online")?a.localize("str_onlineMessage"):a.localize("str_offlineMessage"):a.localize("str_lastPlayed",{date:b}))})}var e=a._super,f=c.getInstance("widgets/zdc/services/game");a.set("t_textContainerContents",'<div class="$name$ zui_ellipsis" /><div class="$chevron$" /><div class="$infoContainer$"><div class="$gameIcon$"/><div class="$playingText$ zui_ellipsis" /></div></div>'),a.declare("playingText","gid","lastPlayedGameDate","str_playingOnZynga","str_lastPlayed","str_offlineMessage","str_onlineMessage","str_chatButtonTooltip"),a.bindStateToContent("name"),a.bindStateToContent("playingText"),a.onStateChange(["online","gid","lastPlayedGameDate","str_lastPlayed"],h),a.createContent=function(b){e.createContent(function(c){a.need("$",function(b){a.content=b(c);var d=a.addChild("gameIcon","widgets/gameicon",{size:"small"});d.getContent(function(b){a.bind(d,[["gid","game_id"]]),a.$node("gameIcon").append(b),a.done("gameIcon_created")}),d.wire("gameIconClick",function(){g(["game_icon","","click",a.get("online")?"online":"offline"]),a.fire({name:"loadFriendConversation",toZid:a.get("zid"),bubble:!0})})}),a.once(["gameIcon_created"],function(){b(c)})})},a.once("content",function(){a.$node("name").click(function(b){g(["user_name","","click",a.get("online")?"online":"offline"]),a.fire({name:"userNameClick",zid:a.get("zid"),bubble:!0})}),a.$node("playingText").click(function(b){if(!a.get("online"))return;a.fire({name:"gameNameClick",gid:a.get("gid"),bubble:!0})}),a.$node("").click(function(b){b.target.className.search(a.nodeClass())!==-1&&(a.track(["zdc_chat","buddy_list","zfriend",a.get("online")?"online":"offline","click"]),a.fire({name:"loadFriendConversation",toZid:a.get("zid"),bubble:!0}))}),a.wire("avatarClick",function(){g(["user_photo","","click",a.get("online")?"online":"offline"]),a.fire({name:"loadFriendConversation",toZid:a.get("zid"),bubble:!0})}),a.done("initialized")}),a.once("initialized",function(){h(),a.onStateChange("gid",function(){a.isNully(a.get("gid"))||a.indicateChange()}),a.onStateChange("lastPlayedGameDate",a.indicateChange)}),b({})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tab/chat/list/friendlist",version:1,extend:"widgets/zdc/common/rail/tab/chat/list",required:["widgets/zdc/common/rail/tab/chat/listitem/friendlistitem","widgets/button"],themes:[""],localized:!0,constructor:function(a,b,c,d){function i(a,b){a.css("display",b?"block":"none")}function j(a){return{name:a.displayName,zid:a.zid.toString(),gid:a.gid,lastPlayedGameDate:a.lastPlayedGameDate,online:a.online?!0:!1}}var e=a._super,f,g,h;a.declare("str_emptyMessageHeading","str_emptyMessageBody","str_emptyMessageCtaText","str_onlineFriendsHeading","str_offlineFriendsHeading"),a.set("sort",["online<","name"]),a.declare("gid"),a.declareAndSet({t_emptyMessage:'<div class="$emptyMessage$"><div class="zui_zdc_common_rail_tab_chat_list_friendlist_bg" /><div class="$emptyMessageContainer$"><div class="$emptyMessageHeading$">%str_emptyMessageHeading%</div><div class="$emptyMessageBody$">%str_emptyMessageBody%</div><div class="$emptyMessageButtonShell$"/></div></div>'}),a.declare("onlineFriendsHeading","offlineFriendsHeading"),a.bindStateToContent("onlineFriendsHeading"),a.bindStateToContent("offlineFriendsHeading"),a.declareAndSet({t_content:'<div class="$$"><div class="$itemsContainer$"><div class="$onlineFriendsHeading$"/><div class="$offlineFriendsHeading$"/></div></div>'}),a.onStateChange("items",function(b){b.newValue&&a.fire({name:"friendCountChanged",count:b.newValue.length,bubble:!0})}),a.createContent=function(b){e.createContent(function(c){a.need("$",function(d){a.content=d(c),g=a.$node("onlineFriendsHeading"),h=a.$node("offlineFriendsHeading"),a.updateHeadings(),b(a.content)})})},a.once("content",function(){a.children.inviteFriendsButton.wire("click",function(){a.fire({name:"inviteFriends",bubble:!0}),a.children.inviteFriendsButton.set("enabled",!0)}),a.done("initialized")}),b({}),a.updateHeadings=function(){a.once("items_inserted",function(){var b=!1,c=0,d=-1;for(var e=-1,i=a.get("items"),j=i.length;++e<j;){i[e].online?(b=!0,c++):d==-1&&(d=e);if(b&&d>-1)break}f=c,a.set("onlineFriendsHeading",a.localize("str_onlineFriendsHeading",{count:c})),a.set("offlineFriendsHeading",a.localize("str_offlineFriendsHeading",{count:a.get("items").length-c})),b?g.show():g.hide(),d>-1?a.insertContentAtItem(h,d-.5):h.hide()})},a.makeItemWidgetClass=function(a){return"widgets/zdc/common/rail/tab/chat/listitem/friendlistitem"},a.makeItemWidgetName=function(a){return a.zid},a.getItemsData=function(b){a.socialGraphService.getFriends({},function(a){var c=d.toArray(a);for(var e=c.length,f;--e>=0;)c[e]=j(c[e]);b(c)})},a.createEmptyMessage=function(b){a.need("$",function(c){var d=c(a.useTemplate("t_emptyMessage")),e=a.addChild("inviteFriendsButton","widgets/button",{label:a.localize("str_emptyMessageCtaText"),theme:"zcd",size:"small",color:"white",enabled:!0});e.getContent(function(c){d.find("."+a.nodeClass("emptyMessageButtonShell")).append(c),d.find("a").append("<i />"),b(d)})})},a.once("getItemsData",function(){function b(a){a.bubble=!1}a.wire({gameIconClick:b,gameNameClick:b,userNameClick:b,avatarClick:b}),a.socialGraphService.wire({friendAdded:function(b){a.addItem(j(b.friend))},friendRemoved:function(b){a.removeItem(a.makeItemWidgetName(b.friend))}}),a.userService.wire({userInfoChanged:function(b){if(b.propertiesChanged.hasOwnProperty("online")||b.propertiesChanged.hasOwnProperty("gid")){var c=b.userInfo;a.updateItemData({zid:c.zid},b.propertiesChanged),a.updateHeadings()}}}),a.track(["zdc_chat","","","","load",f])}),b({getOnlineCount:function(b){a.once("getItemsData",function(){b(f)})},bootstrapOnlineFriends:function(b){a.once("getItemsData",function(){for(var c in b)b.hasOwnProperty(c)&&b[c].hasOwnProperty("zid")&&b[c].hasOwnProperty("online")&&b[c].hasOwnProperty("gid")&&(a.updateItemData({zid:b[c].zid},{online:b[c].online,gid:b[c].gid}),a.updateHeadings())})}})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tab/chat/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_common_rail_tab_chat_chat:{str_heading:{original:"Chat"},str_friends_heading:{original:"My zFriends"}}})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tab/chat",version:1,extend:"widgets/zdc/common/rail/tab",required:["jquery/mousewheel","widgets/zdc/common/rail/tab/chat/friendselector","widgets/zdc/common/rail/tab/chat/list/friendlist","widgets/zdc/common/rail/tab/chat/list/conversationlist"],themes:[""],localized:!0,constructor:function(a,b,c,d){var e=c.getInstance("jquery/mousewheel"),f=[];a.declareAndSet({t_body:'<div class="$body$"><div class="$friendselectorShell$"/><div class="$chatNav$"><div class="$friendsButton$"><div class="$friendsButtonIcon$"/></div><div class="$conversationlist$"/></div><div class="$chatBody$"><div class="$chatBodyItem$ $friendlistOuter$"><div class="$chatBodyItem$ $friendlistHeading$">%str_friends_heading%</div><div class="$chatBodyItem$ $friendlist$" /></div><div class="$chatBodyItem$ $conversation$" /></div></div>',seen:!1}),a.declare("conversationId","str_heading","str_friends_heading","conversationShown","friendlistShown","onlineFriends"),a.onStateChange("seen",function(){a.get("seen")&&a.get("friendlistShown")&&a.once("friendlist_created",function(){a.children.friendlist.itemsLazyLoadCheck()})}),a.provide("friendlist",function(b){a.need("$",function(c){var d=a.addChild("friendlist","widgets/zdc/common/rail/tab/chat/list/friendlist");d.getContent(function(c){a.$node("friendlist").html(c),a.done("friendlist_created"),b(d)})})}),a.provide("conversation",function(b){c.require("widgets/zdc/common/rail/tab/chat/conversation",function(){var c=a.addChild("conversation","widgets/zdc/common/rail/tab/chat/conversation");a.once("rejectedSet",function(){c.set("bannedWords",f)}),a.bind(c,"conversationShown"),c.wire("Changed:conversationId",function(b){a.set("conversationId",b.newValue)}),c.wire("hideConversation",function(b){a.set("conversationId",null)}),c.getContent(function(d){a.$node("conversation").html(d),b(c)})})}),a.bindStateToContent("conversationShown",function(b){a.$node("conversation").css("display",b?"block":"none")}),a.bindStateToContent("friendlistShown",function(b){a.$node("friendlistOuter").css("display",b?"block":"none"),b&&a.need("friendlist",function(a){})}),a.bindStateToClass("conversationId",["viewingFriendslist","viewingConversation"]),a.onStateChange("conversationId",function(){var b=a.get("conversationId");a.set("conversationShown",!!b),a.set("friendlistShown",!b),a.children.conversationlist&&(a.children.conversationlist.resetSelected(),b&&a.children.conversationlist.setSelected(b))}),a.set("conversationId",""),a.onStateChange("onlineFriends",function(b){var c=b.newValue;a.once("friendlist_created",function(){a.children.friendlist.bootstrapOnlineFriends(c)})}),a.createContent=function(b){a.need("$",function(c){a.content=c(a.useTemplate("t_content")),a.$node("body").html(c(a.useTemplate("t_body")));var d=a.addChild("friendselector","widgets/zdc/common/rail/tab/chat/friendselector");d.getContent(function(b){a.$node("friendselectorShell").html(b),a.done("friendselector_created")});var e=a.addChild("conversationlist","widgets/zdc/common/rail/tab/chat/list/conversationlist");e.getContent(function(b){a.$node("conversationlist").html(b),a.done("conversationlist_created")}),a.once(["friendselector_created","conversationlist_created"],function(){b(a.content)})})},a.once("content",function(){a.$node("friendsButton").click(function(){a.set("conversationId",null)}),a.wire({loadFriendConversation:function(b){a.need("conversation",function(a){a.conversationWithFriends(b.toZid)})},loadGroupConversation:function(b){a.need("conversation",function(a){a.loadGroupConversation(b.conversationId)})},removeConversation:function(b){a.children.conversationlist.removeItem(b.conversationId)}}),e.once("initialized",function(){setTimeout(function(){a.need("$",function(b){e.containScrollWheel(a.$node("friendlist"))})},0)})}),b({loadFriendConversation:function(b,c){a.need("conversation",function(a){a.conversationWithFriends(b,c)})},loadGroupConversation:function(b,c){a.need("conversation",function(a){a.loadGroupConversation(b),c&&c(a)})},setRejectedTerms:function(b){f=b,a.done("rejectedSet",f)}})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tab/gameActivity/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_common_rail_tab_gameActivity_gameActivity:{str_streamTitle:{original:"Activity"},str_everybody:{original:"Everybody"},str_neighbors:{original:"My zFriends"}}})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/helpfulness/actions/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_gameboard_helpfulness_actions_actions:{str_preamble:{original:"Who Helped You"},str_zFriend_section_heading:{original:"zFriends"},str_friend_cta_btn_label:{original:"Thank All"},str_stranger_cta_btn_label:{original:"Add zFriend"},str_view_summary_lnk_label:{original:"View highlights"},str_empty_state_msg:{original:"Earn rewards and make game progress by clicking feeds to receive and give help. That's what zFriends are for!"}}})}})

ZY.ZUI.module({name:"widgets/facepile",version:1,extend:"widgets/base",required:"widgets/avatar",themes:[""],constructor:function(a,b,c,d){function j(b){var c=a.get("avatar_size"),d=c==="xlarge"||c==="xxlarge"?"large":"square";return"https://graph.facebook.com/"+b+"/picture?type="+d}function k(a){return"avatar_"+a}function l(){a.once("content",function(){a.need("$",function(b){var c=a.get("columns"),d=a.$node().children(),e=a.get("max_display"),f=d.length-d.length%c-1;f=f==d.length-1?d.length-c-1:f;for(var g=0;g<d.length;g++){var h=b(d[g]);h.removeClass("start_column end_column first last last_row"),c&&g%c===0?h.addClass("start_column"):c&&g&&(g+1)%c===0&&h.addClass("end_column"),g?g===d.length-1&&h.addClass("last"):h.addClass("first"),c&&g>f&&h.addClass("last_row"),h.css("display","block")}})})}function m(b){return a.children.hasOwnProperty(k(b))}var e,f=0,g=500,h=500,i=[];a.declare("users"),a.addFacepileItem=function(b,d){var e=c.getInstance("widgets/avatar");return e.set("thumbnail",j(d)),e.set("size",a.get("avatar_size")),e.set("zid",b),a.addChild(k(b),e),e},a.declare("avatar_size"),a.usersSet=function(){a.once("avatar_set_size",function(){var b=a.get("users");if(!b)return;e=0;if(b.hasOwnProperty("length"))for(e=0;e<b.length;e++){var c=b[e];a.addUser({zid:c})}else d.each(b,function(b,c){a.addUser({zid:c,fbid:b})})})},a.declareAndSet({columns:0,max_display:-1,unique_only:!0,t_content:'<div class="$$ zui_clearfix"></div>'}),a.onStateChange("columns",function(){l()}),a.onStateChange("max_display",function(){var b=0;d.each(a.children,function(c,d){b>=a.get("max_display")&&(a.removeChild(c),i.splice(i.indexOf(c.get("zid")),1)),b++}),l()}),a.onStateChange("avatar_size",function(){a.done("avatar_set_size")}),a.createContent=function(b){a.need("$",function(c){var d=c(a.useTemplate("t_content"));b(d)})},b({addUser:function(b){if(a.get("max_display")>-1&&a.getAvatarCount()>=a.get("max_display"))return!1;var c={animate:!1};d.extend(c,b);if(!c.hasOwnProperty("zid"))throw"Attempting to add new user with no zid";if(a.get("unique_only")&&m(c.zid))return;var e;c.hasOwnProperty("fbid")?e=a.addFacepileItem(c.zid,c.fbid):e=a.addFacepileItem(c.zid),e.getContent(function(b){a.once("content",function(){if(!a.children.hasOwnProperty(k(c.zid)))return;c.append?(i.push(c.zid),a.$node().append(b)):(i.unshift(c.zid),a.$node().prepend(b)),l(),c.animate&&a.need("$",function(a){a(b).css("display","none"),a(b).fadeIn(g)})})})},promoteUser:function(b){var c={};d.extend(c,b);if(!c.hasOwnProperty("zid"))return;var e=a.get("max_display");m(c.zid)?i.indexOf(c.zid)!==0&&(a.removeUser({zid:c.zid,animate:!1}),a.addUser({zid:c.zid,animate:!0})):(e!=-1&&a.getAvatarCount()==e&&a.removeUser({zid:i[i.length-1]}),a.addUser({zid:c.zid,animate:!0}))},removeUser:function(b){function g(){a.removeChild(f),i.splice(i.indexOf(e),1),l()}var c={animate:!1};d.extend(c,b);if(!c.hasOwnProperty("zid")||!m(c.zid))return;var e=c.zid,f=a.children[k(e)];c.animate?f.$root().fadeOut(h,function(){g(),c.wasRemoved&&c.wasRemoved()}):(g(),c.wasRemoved&&c.wasRemoved())},getAvatarCount:function(){var b=0;return d.each(a.children,function(a,c){b++}),b},avatarExists:function(b){return a.children.hasOwnProperty(k(b))},removeItems:function(b){var c=0;for(var d in a.children)if(a.children.hasOwnProperty(d)){if(c>=b)break;i.splice(i.indexOf(a.children[d].get("zid")),1),a.removeChild(d),c++}l()},getUsers:function(){return i}})}})

ZY.ZUI.module({name:"widgets/zdc/common/facepile",version:1,extend:"widgets/facepile",required:"widgets/zdc/common/avatar",themes:[],constructor:function(a,b,c,d){function h(b,c){e[c]=b,a.children.hasOwnProperty("avatar_"+c)&&a.children["avatar_"+c].set("game_id",b)}function i(b){f[b]=!0,a.children.hasOwnProperty("avatar_"+b)&&a.children["avatar_"+b].set("fb_friend",!0)}function j(b){g[b]=!0,a.children.hasOwnProperty("avatar_"+b)&&a.children["avatar_"+b].set("online",!0)}var e={},f={},g={};a.addFacepileItem=function(b){return a.addChild("avatar_"+b,"widgets/zdc/common/avatar",{size:a.get("avatar_size"),zid:b,game_id:e.hasOwnProperty(b)?e[b]:undefined,fb_friend:f.hasOwnProperty(b),online:g.hasOwnProperty(b),css_corners:!0})},b({setGameIdsForZids:function(a,b){if(typeof a=="object")for(var c in a)a.hasOwnProperty(c)&&h(a[c],c);else h(a,b)},setIsFbFriendForZids:function(a){if(typeof a=="object")for(var b=0;b<a.length;b++)i(a[b]);else i(a)},setOnlineForZids:function(a){if(typeof a=="object")for(var b=0;b<a.length;b++)j(a[b]);else j(a)}})}})

ZY.ZUI.module({name:"jquery/easing",version:1,extend:"base",singleton:!0,constructor:function(a,b,c,d){a.need("$",function(b){b.easing.jswing=b.easing.swing,b.extend(b.easing,{def:"easeOutQuad",swing:function(a,c,d,e,f){return b.easing[b.easing.def](a,c,d,e,f)},easeInQuad:function(a,b,c,d,e){return d*(b/=e)*b+c},easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c},easeInOutQuad:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b+c:-d/2*(--b*(b-2)-1)+c},easeInCubic:function(a,b,c,d,e){return d*(b/=e)*b*b+c},easeOutCubic:function(a,b,c,d,e){return d*((b=b/e-1)*b*b+1)+c},easeInOutCubic:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b+c:d/2*((b-=2)*b*b+2)+c},easeInQuart:function(a,b,c,d,e){return d*(b/=e)*b*b*b+c},easeOutQuart:function(a,b,c,d,e){return-d*((b=b/e-1)*b*b*b-1)+c},easeInOutQuart:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b+c:-d/2*((b-=2)*b*b*b-2)+c},easeInQuint:function(a,b,c,d,e){return d*(b/=e)*b*b*b*b+c},easeOutQuint:function(a,b,c,d,e){return d*((b=b/e-1)*b*b*b*b+1)+c},easeInOutQuint:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b*b+c:d/2*((b-=2)*b*b*b*b+2)+c},easeInSine:function(a,b,c,d,e){return-d*Math.cos(b/e*(Math.PI/2))+d+c},easeOutSine:function(a,b,c,d,e){return d*Math.sin(b/e*(Math.PI/2))+c},easeInOutSine:function(a,b,c,d,e){return-d/2*(Math.cos(Math.PI*b/e)-1)+c},easeInExpo:function(a,b,c,d,e){return b===0?c:d*Math.pow(2,10*(b/e-1))+c},easeOutExpo:function(a,b,c,d,e){return b==e?c+d:d*(-Math.pow(2,-10*b/e)+1)+c},easeInOutExpo:function(a,b,c,d,e){return b===0?c:b===e?c+d:(b/=e/2)<1?d/2*Math.pow(2,10*(b-1))+c:d/2*(-Math.pow(2,-10*--b)+2)+c},easeInCirc:function(a,b,c,d,e){return-d*(Math.sqrt(1-(b/=e)*b)-1)+c},easeOutCirc:function(a,b,c,d,e){return d*Math.sqrt(1-(b=b/e-1)*b)+c},easeInOutCirc:function(a,b,c,d,e){return(b/=e/2)<1?-d/2*(Math.sqrt(1-b*b)-1)+c:d/2*(Math.sqrt(1-(b-=2)*b)+1)+c},easeInElastic:function(a,b,c,d,e){var f;f=1.70158;var g=0,h=d;return b===0?c:(b/=e)==1?c+d:(g||(g=e*.3),h<Math.abs(d)?(h=d,f=g/4):f=g/(2*Math.PI)*Math.asin(d/h),-(h*Math.pow(2,10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g))+c)},easeOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;return b===0?c:(b/=e)==1?c+d:(g||(g=e*.3),h<Math.abs(d)?(h=d,f=g/4):f=g/(2*Math.PI)*Math.asin(d/h),h*Math.pow(2,-10*b)*Math.sin((b*e-f)*2*Math.PI/g)+d+c)},easeInOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;return b===0?c:(b/=e/2)==2?c+d:(g||(g=e*.3*1.5),h<Math.abs(d)?(h=d,f=g/4):f=g/(2*Math.PI)*Math.asin(d/h),b<1?-0.5*h*Math.pow(2,10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g)+c:h*Math.pow(2,-10*(b-=1))*Math.sin((b*e-f)*2*Math.PI/g)*.5+d+c)},easeInBack:function(a,b,c,d,e,f){return f===undefined&&(f=1.70158),d*(b/=e)*b*((f+1)*b-f)+c},easeOutBack:function(a,b,c,d,e,f){return f===undefined&&(f=1.70158),d*((b=b/e-1)*b*((f+1)*b+f)+1)+c},easeInOutBack:function(a,b,c,d,e,f){return f===undefined&&(f=1.70158),(b/=e/2)<1?d/2*b*b*(((f*=1.525)+1)*b-f)+c:d/2*((b-=2)*b*(((f*=1.525)+1)*b+f)+2)+c},easeInBounce:function(a,c,d,e,f){return e-b.easing.easeOutBounce(a,f-c,0,e,f)+d},easeOutBounce:function(a,b,c,d,e){return(b/=e)<1/2.75?d*7.5625*b*b+c:b<2/2.75?d*(7.5625*(b-=1.5/2.75)*b+.75)+c:b<2.5/2.75?d*(7.5625*(b-=2.25/2.75)*b+.9375)+c:d*(7.5625*(b-=2.625/2.75)*b+.984375)+c},easeInOutBounce:function(a,c,d,e,f){return c<f/2?b.easing.easeInBounce(a,c*2,0,e,f)*.5+d:b.easing.easeOutBounce(a,c*2-f,0,e,f)*.5+e*.5+d}}),a.done("initialized")}),b({once:a.once})}})

ZY.ZUI.module({name:"widgets/zdc/common/senditemdooberbutton",version:1,extend:"widgets/base",required:["jquery/easing","widgets/button"],bubble:!0,themes:[""],constructor:function(a,b,c,d){function l(b){a.once("$",function(c){function k(){var a={};a.left=e.position().left,a.top=e.offset().top+i.height/2-f.height()/2,f.css("left",a.left+"px"),f.css("top",a.top+"px"),setTimeout(function(){f.show(),c.browser.msie?f.animate({left:a.left},500):f.animate({left:a.left,opacity:0,scaleX:1.5,scaleY:1.5},500)},g)}var d=a.$root(),h={};h.top=d.offset().top,h.left=d.offset().left,h.width=d.outerWidth(!1),h.height=d.height();var i={};i.height=e.height(),i.animateFromTop=h.top+h.height/2-i.height/2,i.animateToTop=i.animateFromTop-h.height/2-i.height/2-i.height/5,e.css("opacity",1),e.css("top",i.animateFromTop+"px"),e.css("left",h.left+"px");var l={top:i.animateToTop};c.browser.msie||(e.css("opacity",0),l.opacity=1);var m=h.width/3,n=j;m*4>j&&(n=m*4),i.animateToLeft=h.left+n,e.show(),e.animate(l,350,"easeOutBack",function(){k()}).delay(g).animate({left:i.animateToLeft},275,"easeOutQuad",function(){f.remove(),e.remove(),b&&b()})})}var e,f,g=200,h="energy",i="request",j=80,k=c.getInstance("widgets/button");c.getInstance("jquery/easing"),a.declare("sendItemType","enabled","theme","size","color","label","use_standard_width"),a.bind(k,["enabled","theme","size","color","label","use_standard_width"]),a.bindStateToClass("sendItemType"),a.bindStateToClass("size"),a.declareAndSet({t_content:'<div class="$$"></div>',t_sent_item_icon:'<div class="$sentItem$"></div>',t_sent_poof_icon:'<div class="$poof$"></div>',enabled:!0,theme:"zdc",size:k.SIZE_TINY,color:k.COLOR_WHITE,label:a.localize("str_button_label"),sendItemType:i}),a.createContent=function(b){a.need("$",function(c){var d=a.content=c(a.useTemplate("t_content"));a.addChild("button",k),k.getContent(function(b){a.$node("").append(b),a.done("button_created")}),k.wire("click",function(){a.need("$",function(b){var c=a.$root();e=b(a.useTemplate("t_sent_item_icon")),e.addClass(a.nodeClass(a.get("size"))),e.addClass(a.nodeClass(a.get("sendItemType"))),b("body").append(e),f=b(a.useTemplate("t_sent_poof_icon")),f.addClass(a.nodeClass(a.get("size"))),f.addClass(a.nodeClass(a.get("sendItemType"))),b("body").append(f),l(function(){a.fire("click")})})}),a.once("button_created",function(){b(a.content)})})},b({SEND_ITEM_TYPE_ENERGY:h,SEND_ITEM_TYPE_REQUEST:i,SIZE_TINY:k.SIZE_TINY,SIZE_SMALL:k.SIZE_SMALL,SIZE_MEDIUM:k.SIZE_MEDIUM,SIZE_LARGE:k.SIZE_LARGE,SIZE_XLARGE:k.SIZE_XLARGE,COLOR_BLUE:k.COLOR_BLUE,COLOR_WHITE:k.COLOR_WHITE,setEnabled:function(b){a.once("button_created",function(){k.setEnabled(b)})}})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/helpfulness/friendhelpers/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_gameboard_helpfulness_friendhelpers_friendhelpers:{str_zFriend_section_heading:{original:"zFriends"},str_friend_cta_btn_label:{original:"Thank All"}}})}})

ZY.ZUI.module({name:"widgets/button/image",version:1,extend:"widgets/button",themes:[""],constructor:function(a,b,c,d){function e(b){var c=a.$node();b.url&&c.css("background-image","url("+b.url+")"),a.once("$",function(a){a.browser.msie?(b.left!==undefined&&c.css("background-position-x",b.left+"px"),b.top!==undefined&&c.css("background-position-y",b.top+"px")):b.left!==undefined&&b.top!==undefined&&c.css("background-position",b.left+"px "+b.top+"px")})}function f(a){a&&a.url&&((new Image).src=a.url)}a.set("theme",undefined),b({setImage:function(b){a.once("content",function(){var c=a.$node();b.width!==undefined&&c.css("width",b.width+"px"),b.height!==undefined&&c.css("height",b.height+"px"),c.css("background-repeat","no-repeat"),b.enabled.left=b.enabled.left!==undefined?b.enabled.left:0,b.enabled.top=b.enabled.top!==undefined?b.enabled.top:0,e(b.enabled),b.hover&&c.mouseenter(function(){a.get("enabled")&&e(b.hover)}).mouseleave(function(){a.get("enabled")&&e(b.enabled)}),b.active&&c.mousedown(function(){a.get("enabled")&&e(b.active)}).mouseup(function(){a.get("enabled")&&e(b.enabled)});if(b.disabled){var d=function(c){e(a.get("enabled")?b.enabled:b.disabled)};a.onStateChange("enabled",d),d()}}),f(b.enabled),f(b.hover),f(b.active),f(b.disabled)}})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/helpfulness/ignoreButton",version:1,extend:"widgets/button/image",required:[],themes:[""],localized:!1,constructor:function(a,b,c,d){a.set("enabled",!0),a.setImage({width:16,height:16,enabled:{url:c.zui().baseUrl+a.def.name+"/ignore.png",left:3,top:2},hover:{left:3,top:-17},active:{left:3,top:-17}})}})

ZY.ZUI.module({name:"widgets/zdc/services/zoom/give-zdc",version:1,extend:"services/adapter",required:["data/json","widgets/zdc/services/zoom"],singleton:!0,constructor:function(a,b,c,d){function k(a){if(a&&a.msg&&a.msg.msg){var b=a.msg.msg;b=f.from(unescape(b)),a.msg=b,a.name=b.f}return a}var e=c.getInstance("widgets/zdc/services/zoom"),f=c.getInstance("data/json"),g,h="Give",i="osvc",j;b({init:function(b,c){g=b.serviceInterface,j=g.get("EVENTS"),e.registerPlugin({commands:["isvc."+h],svcInterface:g,parseOnReceive:k,module:a}),c()},checkLimit:function(a,b){e.send({command:e.getCommand({service:i,keyVals:{osvc:null,req:null,to:h,msg:escape(f.to({reqMode:a.reqMode,from:a.from}))}}),cbId:"isvc."+h,callback:function(a){b&&b(a)}})},sendGive:function(a,b){e.send({command:e.getCommand({service:i,keyVals:{osvc:null,req:null,to:h,msg:escape(f.to(d.extend({reqMode:"GIVE"},a)))}})}),b()}})}})

ZY.ZUI.module({name:"widgets/zdc/services/zoom/give",version:1,extend:"services/base",singleton:!0,constructor:function(a,b,c,d){a.declareAndSet({EVENTS:{ZCHECK:"ZCHECK",GIVE:"GIVE"}}),a.declareServiceMethods({init:{async:!1},checkLimit:{async:!0},sendGive:{async:!1}})}})

ZY.ZUI.module({name:"widgets/zdc/services/grant-zdc",version:1,extend:"services/adapter",required:["widgets/zdc/services/zoom/give","widgets/zdc/services/messaging","widgets/zdc/services/user","widgets/zdc/services/socialgraph","widgets/zdc/services/game","services/track"],singleton:!0,constructor:function(a,b,c,d){function y(a){return a.sort().join(",")}function z(a){return y([i,a])}function A(a,b){t.getUserData({uids:a},function(c){c&&v.fetch({gids:c.gid},function(c){var d=c&&c.hasOwnProperty("giveTypes")?c.giveTypes:null,e=!!(g.get("userCanGive")&&!x.isGiveCappedForUser(a)&&(d||f).length);b(e)})})}function B(b){function c(){b&&b(m)}m?c():u.getFriends({zid:i},function(c){m||(m=[]);for(var d in c)if(c.hasOwnProperty(d)){var f=c[d],g=n[d];p({friend:{name:f.fname+" "+f.lname,zid:d,lastMessage:{},online:!!g,gid:g&&g.gid}},e)}a.done("friendsLoaded"),b(m)})}var e=function(){},f=[],g,h,i,j,k,l={},m,n,o,p,q,r=c.getInstance("widgets/zdc/services/zoom/give"),s=c.getInstance("widgets/zdc/services/messaging"),t=c.getInstance("widgets/zdc/services/user"),u=c.getInstance("widgets/zdc/services/socialgraph"),v=c.getInstance("widgets/zdc/services/game"),w=c.getInstance("services/track"),x=function(){function c(a){a!=g.get("givesRemaining")&&g.set("givesRemaining",a)}function d(b){return a[b]}function e(){r.checkLimit({reqMode:"ZCHECK",from:i},function(a){if(a&&a.msg){var b=a.msg;x.setGivesRemaining(b.grantsAllowed-b.grantsGiven>=0?b.grantsAllowed-b.grantsGiven:0),b.grantsGiven&&x.checkGrantLimitsLater(Math.min(b.timeLeft,x.processGaveToArray(b.gaveTo)))}})}var a={},b=null;return{checkGrantLimits:e,checkGrantLimitsLater:function(a){clearTimeout(b),a<Infinity&&(b=setTimeout(function(){e()},a*1e3))},gaveToFriend:function(b){a[b]=!0,o(b)},processGaveToArray:function(b){var c={},d=Infinity;for(var e=b.length,f,g;--e>=0;)c[(f=b[e]).to]=!0,(g=f.ct)<d&&(d=g);for(var h=m.length;--h>=0;){var i=m[h].zid;a[i]=c[i]}return q(),d},isGiveCappedForUser:d,setGivesRemaining:c}}();o=function(a){A(a,function(b){t.cache({users:[{zid:a,canReceiveGive:b,isGiveCapped:x.isGiveCappedForUser(a)?!0:!1}]})})},q=function(){d.each(m,function(a){o(a.zid,{})})},p=function(a,b){var c=a.friend,d=c.zid;l[d]||(l[d]=c,m.push(c)),b(c)},b({isGiveCappedForUser:function(a,b){b(x.isGiveCappedForUser(a.zid))},give:function(a,b){u.getFriends({zid:i},function(d){function e(b){g.fire({name:b?"giveSendLimitReached":"giftSent",to:a.to,toSS:"1:"+d[a.to].fbid,toGid:a.toGid,from:i,fromGid:k,type:a.giveType})}var f=g.get("givesRemaining");f>0?(x.gaveToFriend(a.to),x.setGivesRemaining(f-1),r.sendGive({to:a.to,toSS:"1:"+d[a.to].fbid,reqType:a.giveType,from:i,fromGid:k}),e(),c.require("widgets/zdc/services/helpfulness",function(b){b().recordGameHelp({gid:k,helpedZid:a.to})})):e(!0),b()})},init:function(b,f){g=b.serviceInterface,i=b.myZid,h=b.currentUserOnline,n=b.onlineFriends,k=b.gameId;var l=r.get("EVENTS");r.wire(l.GIVE,function(a){if(a&&a.msg){var b=a.msg;if(b.errorCode){x.checkGrantLimitsLater(b.timeLeft);return}var d=c.now(),f=b.from,h=b.to,j=b.gid,k=b.fromGid,l=b.reqType;h==i?(w.track(["zdc_chat","messages_view","energy","","receive",""]),g.fire({name:"giftReceived",to:i,toGid:j,from:f,fromGid:k,type:l})):f==i&&b.grantsGiven&&(x.checkGrantLimits(),s.sendMessage({conversationId:z(h),details:{type:"give",giveType:l,gid:j}},e))}}),a.once("friendsLoaded",function(){x.checkGrantLimits()}),t.getCurrentUserData({},function(b){j=d.extend(b,{online:h}),a.done("userInfoLoaded"),f(),B(e)}),g.onStateChange("userCanGive",q),g.onStateChange("givesRemaining",function(){g.fire({name:"givesRemaining",value:g.get("givesRemaining")}),g.set("userCanGive",g.get("givesRemaining")>0)}),t.wire("userInfoChanged",function(a){a.propertiesChanged.hasOwnProperty("gid")&&o(a.zid)})}})}})

ZY.ZUI.module({name:"widgets/zdc/services/grant",version:1,extend:"services/base",singleton:!0,constructor:function(a,b,c,d){a.declare("givesRemaining","userCanGive"),a.declareServiceMethods({isGiveCappedForUser:{async:!1},give:{async:!0},init:{async:!0}})}})

ZY.ZUI.module({name:"widgets/zdc/services/helpfulness-zdc",version:1,extend:"services/adapter",required:["data/json","widgets/zdc/services/grant","widgets/zdc/services/game","widgets/zdc/services/gameboard","widgets/zdc/services/socialgraph","widgets/zdc/services/user","services/track"],singleton:!0,constructor:function(a,b,c,d){function y(a){a.hasOwnProperty("length")||(a=[a]);for(var b in a)if(a.hasOwnProperty(b)){var c=a[b],d=c.gid;o[d]=c}}function z(a){return o.hasOwnProperty(a)}function A(a){var b,c,e;if(typeof a!="object")return b=a,z(b)?(c=o[b],e={},d.extend(e,c),e):null;var f={};for(var g in a)a.hasOwnProperty(g)&&(b=a[g],z(b)?(c=o[b],e={},d.extend(e,c),f[b]=e):f[b]=null);return f}function B(){var a={};d.extend(a,n);var b=p.slice(0);p=[],n={},l.get(m.getGameHelpers,{data:a},function(a){if(a.gameHelpers){y(a.gameHelpers);for(var c=0;c<b.length;c++){var e=b[c];d.extend(e.gameHelpersForGames,A(e.gids)),e.returnTypeIsHash?e.callback(e.gameHelpersForGames):e.callback(e.gameHelpersForGames[e.gids[0]])}}q=null,p.length&&B()})}function C(b,c,d,e){a.need("$",function(a){if(!b)return;p.push({gids:b,gameHelpersForGames:c,callback:e,returnTypeIsHash:d});for(var f=0;f<b.length;f++){var g=b[f];n[g]=1}q||(q=setTimeout(function(){B()},s))})}function D(a,b){var c=A(a);c&&e.fire({name:"helperStatsUpdated",data:{numHelps:c.numHelps,numRewards:c.numRewards,numHelped:c.numHelped,numHelpers:c.numHelpers,numNotifications:c.numNotifications},type:b})}function E(a,b){var c=A(a);if(c.hasOwnProperty("notifications")&&c.notifications)for(var d=0;d<b.length;d++){if(!c.notifications.hasOwnProperty(b[d]))continue;var f=c.notifications[b[d]];e.fire({name:"helperRemoved",helper:f}),delete c.notifications[b[d]],c.numNotifications=c.numNotifications-1}}function F(a,b){var c=!0;typeof a!="object"&&(a=[a],c=!1);var e=[],f=[];for(var g=0;g<a.length;g++){var h=a[g];z(h)?f.push(h):e.push(h)}var i={};if(f.length){var j=A(f);d.extend(i,j)}e.length?C(e,i,c,b):c?b(i):b(i[a[0]])}function G(a,b){h.once("initialized",function(){h.fetch({gids:a,attr:["giveTypes"]},function(c){var d=c&&c.hasOwnProperty("giveTypes")?c.giveTypes:null;d&&d.length?b(d[0]):b(null)})})}function H(b,c){var d;typeof b.to!="object"?d=[b.to]:d=b.to,a.undone("giveEnergyAllDone"),G(b.gid,function(h){if(!h){c(!1);return}f.once("initialized",function(){function k(c,d){f.isGiveCappedForUser({zid:c},function(e){if(e)return;f.give({to:c,toGid:b.gid,giveType:h}),g.track(["ZDC_gameboard","helpers","helper_list","Energy_Sends","",b.gid]),j++,d&&a.done("giveEnergyAllDone")})}var i,j=0;for(var l=0;l<d.length;l++){var m=d[l];if(!f.get("userCanGive")){a.done("giveEnergyAllDone");break}var n=l==d.length-1?!0:!1;k(m,n)}b.hasOwnProperty("isInterstitial")&&a.once("giveEnergyAllDone",function(){g.track(["ZDC_gameboard","helpersv3_takeover","Energy_Sends","click",j,b.gid])}),c(!0)})})}function I(a,b,c,d,f){var g=A(a);if(g&&g.hasOwnProperty("notifications")&&g.notifications){var h,i;g.numHelps=g.numHelps+1,g.notifications.hasOwnProperty(b)?(i=g.notifications[b],i.isNeighbor=c,i.numHelps=i.numHelps+1,i.lastHelpTimestamp=d,e.fire({name:"helperUpdated",helper:i})):(i={zid:b,gid:a,isNeighbor:c,numHelps:1,lastHelpTimestamp:d},g.notifications[b]=i,g.numNotifications=g.numNotifications+1,e.fire({name:"helperAdded",helper:i})),g.helpersByZid.hasOwnProperty(b)?g.helpersByZid[b]=g.helpersByZid[b]+1:(g.helpersByZid[b]=1,g.numHelpers=g.numHelpers+1),y([g]),D(a,x),f(!0);return}f(!1)}function J(a,b,c){l.get(m.removeGameHelpers,{data:{gid:a,helperZids:b}},function(d){if(d.e===0){E(a,b),c(!0);return}c(!1)})}function K(a,b,c,d,e,f,g){l.get(m.recordGameHelp,{gameId:a,helpedZid:b,feedImgUrl:c,thanks:e,href:d},function(a){g&&g(a.e===0)});var h=A(a);h&&(f&&(h.numRewards=h.numRewards+1),h.helpedByZid.hasOwnProperty(b)?h.helpedByZid[b]=h.helpedByZid[b]+1:(h.helpedByZid[b]=1,h.numHelped=h.numHelped+1),y([h]),D(a,w))}var e,f=c.getInstance("widgets/zdc/services/grant"),g=c.getInstance("services/track"),h=c.getInstance("widgets/zdc/services/game"),i=c.getInstance("widgets/zdc/services/socialgraph"),j=c.getInstance("widgets/zdc/services/user"),k=c.getInstance("data/json"),l,m,n={},o={},p=[],q=null,r,s=100,t=2,u=3,v=4,w="bh",x="br";a.declare("zid"),a.declareAndSet({experiments:{}}),b({gameHelpReceived:function(a,b){if(!a.hasOwnProperty("gid")||!a.hasOwnProperty("helperZid")||!a.hasOwnProperty("lastHelpTimestamp")){b(!1);return}i.getFriends({},function(c){a.isNeighbor=c.hasOwnProperty(a.helperZid),a.isNeighbor?j.getUserDataNonCached({uids:a.helperZid},function(d){d&&(a.thankable=d.hasOwnProperty("isGiveCapped")&&d.isGiveCapped===!1,I(a.gid,a.helperZid,a.isNeighbor,a.lastHelpTimestamp,b))}):(a.thankable=!1,I(a.gid,a.helperZid,a.isNeighbor,a.lastHelpTimestamp,b)),a.thanks&&j.getUserDataNonCached({uids:a.helperZid},function(b){if(b){var c={href:a.href,zid:a.helperZid,name:b.displayName,picurl:ZY.ZConnectSocialNetwork.getPictureUri({userData:b,type:"large",ztype:"medium"}),thanks:a.thanks};window.gameController.gameSend("thanks",[c])}})})},recordGameHelp:function(a,b){if(!a.gid||!a.helpedZid){b(!1);return}a=$.extend({feedImgUrl:null,href:null,thanks:null,gotReward:!1},a),K(a.gid,a.helpedZid,a.feedImgUrl,a.href,a.thanks,a.gotReward,b)},removeGameHelpers:function(a,b){if(!a.gid||!a.helperZids){b(!1);return}J(a.gid,a.helperZids,b)},give:function(a,b){if(!a.to||!a.gid){b(!1);return}H(a,b)},getGameHelpers:function(a,b){if(!a.gids){b(null);return}F(a.gids,b)},init:function(b,c){e=b.serviceInterface,a.set("zid",b.zid),a.set("experiments",b.experiments),e.set({helpersExpandedByDefault:!1,shareEnabled:!1}),l=b.ajax,m=b.ajaxResources,c()}})}})

ZY.ZUI.module({name:"widgets/zdc/services/helpfulness",version:1,extend:"services/base",required:"widgets/zdc/services/user",singleton:!0,constructor:function(a,b,c,d){a.declareAndSet({helpersExpandedByDefault:!1,shareEnabled:!1}),a.declareServiceMethods({recordGameHelp:{async:!0},gameHelpReceived:{async:!0},removeGameHelpers:{async:!0},getGameHelpers:{async:!0},give:{async:!0},init:{async:!1}})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/helpfulness/friendhelpers",version:1,extend:"widgets/base",required:["widgets/zdc/common/facepile","widgets/zdc/gameboard/helpfulness/ignoreButton","widgets/zdc/common/senditemdooberbutton","widgets/zdc/services/helpfulness"],themes:[""],localized:!0,constructor:function(a,b,c,d){function l(){var b=[],c=a.get("helpers");if(!c)return b;var d;for(var e in c)c.hasOwnProperty(e)&&(d=c[e],d.hasOwnProperty("isNeighbor")&&d.isNeighbor===!0&&b.push(d));return b}function m(){a.$root().fadeTo(j,1,function(){a.$root().slideDown(k,function(){a.$root().show()})}),h.setEnabled(!0),g.setEnabled(!0)}function n(){a.$root().fadeTo(i,0,function(){a.$root().slideUp(k,function(){a.$root().hide()})})}function o(){f.once("content",function(){f.removeItems(f.getAvatarCount()),n()})}function p(b){e.once("initialized",function(){var d=l(),f=[],g;for(var h in d)d.hasOwnProperty(h)&&(g=d[h],f.push(g.zid));a.set("helpers",{});if(!f.length)return;var i=a.get("gid");e.removeGameHelpers({gid:i,helperZids:f},function(b){console.log("onRemoveHelperComplete",b)}),b&&e.give({gid:i,to:f},function(b){console.log("onGiveComplete",b)})}),o()}function q(){a.once(["zid_set","gid_set"],function(){e.once("initialized",function(){var c=a.get("gid");e.getGameHelpers({gids:[c]},function(d){if(!d||!d.hasOwnProperty(c))return;var e=d[c],f=e.notifications||{};a.set("helpers",f)})})})}function r(){a.set("isEmpty",!l().length)}var e=c.getInstance("widgets/zdc/services/helpfulness"),f,g,h,i=300,j=300,k=500;a.declare("zid","gid","helpers","isEmpty","str_zFriend_section_heading","str_friend_cta_btn_label"),a.declareAndSet({t_content:'<div class="$$ zui_clearfix"><div class="$heading$">%str_zFriend_section_heading%</div><div class="$content$"><div class="$facepileWrapper$"></div><div class="$buttonsWrapper$"><div class="$buttonsFloat$"><div class="$buttons$"><div class="$CTABtnWrapper$"></div><div class="$ignoreBtnWrapper$"></div></div></div></div></div></div>',isEmpty:!0}),a.onStateChange("zid",function(){a.done("zid_set")}),a.onStateChange("gid",function(){a.done("gid_set"),q()}),a.bindStateToContent("helpers",function(a){if(!a)o();else{var b,c=l();for(var d in c)c.hasOwnProperty(d)&&f.addUser({zid:c[d].zid});c.length?m():o()}r()}),a.createContent=function(b){a.need("$",function(c){var d=a.content=c(a.useTemplate("t_content"));f=a.addChild("facepile","widgets/zdc/common/facepile"),f.set("columns",3),f.set("max_display",5),f.set("avatar_size","tiny"),f.getContent(function(b){a.$node("facepileWrapper").html(b)}),h=a.addChild("zFriendCTABtn","widgets/zdc/common/senditemdooberbutton"),h.set({sendItemType:h.SEND_ITEM_TYPE_ENERGY,enabled:!0,theme:"zdc",label:a.localize("str_friend_cta_btn_label"),size:h.SIZE_SMALL,color:h.COLOR_BLUE}),h.wire("click",function(){a.track(["ZDC_gameboard","helpers","helper_list","CTA_SendThanks","click",a.get("gid")]),p(!0)}),h.getContent(function(b){a.$node("CTABtnWrapper").append(b)}),g=a.addChild("ignoreButton","widgets/zdc/gameboard/helpfulness/ignoreButton"),g.wire("click",function(){p(!1)}),g.getContent(function(b){a.$node("ignoreBtnWrapper").append(b)}),b(d)})},a.once("content",function(){function c(b){var c=a.get("helpers")||{},d=b.helper;c[d.zid]=b.helper,a.set("helpers",c)}e.wire({helperAdded:function(a){c(a)},helperRemoved:function(a){},helperUpdated:function(a){c(a)}})})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/helpfulness/strangerhelperlistitem/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_gameboard_helpfulness_strangerhelperlistitem_strangerhelperlistitem:{str_caption:{original:"{numHelps} helps"},str_cta_button_label:{original:"Add zFriend"}}})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/helpfulness/strangerhelperlistitem",version:1,extend:"widgets/listitem",required:["widgets/zdc/common/senditemdooberbutton","widgets/zdc/common/avatar","widgets/zdc/services/user","widgets/button/image","widgets/zdc/gameboard/helpfulness/ignoreButton","widgets/zdc/services/helpfulness"],themes:[""],localized:!0,constructor:function(a,b,c,d){function g(){setTimeout(function(){a.fire({name:"removeItem",bubble:!0})},0),f.once("initialized",function(){f.removeGameHelpers({gid:a.get("gid"),helperZids:[a.get("zid")]},function(b){})})}var e=a._super,f=c.getInstance("widgets/zdc/services/helpfulness");a.userService=c.getInstance("widgets/zdc/services/user"),a.declare("id","gid","zid","isNeighbor","displayName","caption","numHelps","lastHelpTimestamp","str_caption","str_cta_button_label"),a.set("t_content",'<div class="$$ zui_clearfix"><div class="$avatar$"></div><div class="$infoContainer$"><div class="$displayNameContainer$ zui_ellipsis"><span class="$displayName$"></span></div><div class="$caption$"></div></div><div class="$actions$"><div class="$CTABtnWrapper$"></div><div class="$ignoreBtnWrapper$"></div></div></div>'),a.bind(a,[["zid","id"]]),a.bindStateToContent("displayName"),a.bindStateToContent("numHelps",function(b){if(!b)return;a.$node("caption").html(a.localize("str_caption",{numHelps:b}))}),a.onStateChange("zid",function(){var c=a.get("zid");c&&a.userService.getUserDataNonCached({uids:c},function(b){b&&a.set("displayName",b.firstName)})}),a.createContent=function(b){e.createContent(function(c){a.need("$",function(d){a.content=d(c),b(a.content),a.$node("displayName").click(function(){a.fire({name:"userNameClick",zid:a.get("zid"),bubble:!0})});var e=a.addChild("avatar","widgets/zdc/common/avatar");e.set({zid:a.get("zid"),size:e.SIZE_TINY,miniprofile:!1,show_tooltip:!1}),e.getContent(function(b){a.$node("avatar").html(b)});var f=a.addChild("CTAButton","widgets/zdc/common/senditemdooberbutton");f.set({sendItemType:f.SEND_ITEM_TYPE_REQUEST,enabled:!0,theme:"zdc",label:a.localize("str_cta_button_label"),size:f.SIZE_SMALL,color:f.COLOR_WHITE}),f.wire("click",function(){a.track(["ZDC_gameboard","helpers","helper_list","CTA_AddFriend","click",a.get("gid")]),g(),a.fire({name:"helpersStrangerCTAClicked",zid:a.get("zid"),bubble:!0})}),f.getContent(function(b){a.$node("CTABtnWrapper").append(b),a.done("cta_button_ready")});var h=a.addChild("ignoreButton","widgets/zdc/gameboard/helpfulness/ignoreButton");h.wire("click",function(){g()}),h.getContent(function(b){a.$node("ignoreBtnWrapper").append(b)})})})},b({})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/helpfulness/strangerhelperlist",version:1,extend:"widgets/list",required:["widgets/list","widgets/zdc/gameboard/helpfulness/strangerhelperlistitem","widgets/zdc/services/helpfulness"],themes:[""],localized:!1,constructor:function(a,b,c,d){function j(){a.once(["zid_set","gid_set"],function(){f.once("initialized",function(){var c=a.get("gid");f.getGameHelpers({gids:[c]},function(d){if(!d||!d.hasOwnProperty(c))return;var e=d[c];a.once("content",function(){a.fire({name:"helpersAdded",helpers:e.notifications,bubble:!1})})})})})}var e=a._super,f=c.getInstance("widgets/zdc/services/helpfulness"),g=500,h=300,i=300;a.set("sort","lastHelpTimestamp<"),a.declare("zid","gid"),a.onStateChange("zid",function(){a.done("zid_set")}),a.onStateChange("gid",function(){a.done("gid_set"),a.removeItems(),j()}),a.createContent=function(b){e.createContent(function(c){a.need("$",function(d){a.content=d(c),b(a.content)})})},a.makeItemWidgetClass=function(a){return"widgets/zdc/gameboard/helpfulness/strangerhelperlistitem"},a.makeItemWidgetName=function(a){return a.zid},a.removeItem=function(b){var c;for(var d=a.get("items"),f=d.length;--f>=0;){if(!d[f])continue;if(a.makeItemWidgetName(d[f])==b){c=a.getItemWidget(d[f]);break}}c&&c.$root().fadeTo(h,0,function(){c.$root().slideUp(i,function(){e.removeItem.call(a,b)})})},a.once("getItemsData",function(){f.wire({helperAdded:function(b){if(!b.hasOwnProperty("helper")||!b.helper||b.helper.hasOwnProperty("isNeighbor")&&b.helper.isNeighbor===!0)return;a.addItem(b.helper)},helperRemoved:function(b){a.removeItem(a.makeItemWidgetName(b.helper))},helperUpdated:function(b){if(!b.hasOwnProperty("helper")||!b.helper||b.helper.hasOwnProperty("isNeighbor")&&b.helper.isNeighbor===!0)return;var c=b.helper;a.updateItemData({zid:c.zid},{numHelps:c.numHelps,isNeighbor:c.isNeighbor})}})}),a.getItemsData=function(b){function c(a){if(!a.hasOwnProperty("helpers"))return;var c=[],d;for(var e in a.helpers)a.helpers.hasOwnProperty(e)&&(d=a.helpers[e],d.hasOwnProperty("isNeighbor")&&!d.isNeighbor&&c.push(d));b(c)}a.wire("helpersAdded",c)},b({})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/helpfulness/actions",version:1,extend:"widgets/base",required:["widgets/zdc/gameboard/helpfulness/friendhelpers","widgets/zdc/gameboard/helpfulness/strangerhelperlist","widgets/zdc/services/helpfulness"],themes:[""],localized:!0,constructor:function(a,b,c,d){function j(){a.once(["friendListContentReady","strangerListContentReady"],function(){a.set("isEmpty",h.get("isEmpty")&&i.get("isEmpty"))})}var e=c.getInstance("widgets/zdc/services/helpfulness"),f=500,g=300,h=null,i=null;a.declare("zid","gid","isEmpty","str_preamble","str_view_summary_lnk_label","str_empty_state_msg"),a.declareAndSet({t_content:'<div class="$$ zui_clearfix"><div class="$inner$"><div class="$actionsWrapper$"><div class="$preamble$">%str_preamble%</div><div class="$scrollbox$"><div class="$friendHelpersWrapper$"></div><div class="$strangerHelpersWrapper$"></div></div></div><div class="$messageWrapper$" style="display: none"><div class="$messageCentering$"><div class="$message$">%str_empty_state_msg%</div></div></div></div><div class="$viewSummaryLnk$"><a>%str_view_summary_lnk_label%</a></div></div>'}),a.bindStateToContent("isEmpty",function(b){b?a.$node("actionsWrapper").fadeTo(g,0,function(){a.$node("actionsWrapper").hide(),a.$node("messageWrapper").fadeTo(f,1)}):a.$node("messageWrapper").fadeTo(g,0,function(){a.$node("messageWrapper").hide(),a.$node("actionsWrapper").fadeTo(f,1)})}),a.createContent=function(b){a.need("$",function(c){var d=a.content=c(a.useTemplate("t_content"));b(d),h=a.addChild("friendHelpers","widgets/zdc/gameboard/helpfulness/friendhelpers"),h.getContent(function(b){a.$node("friendHelpersWrapper").append(b),a.done("friendListContentReady")}),a.bind(h,["zid","gid"]),h.wire("Changed:isEmpty",function(b){j()}),i=a.addChild("strangerHelpers","widgets/zdc/gameboard/helpfulness/strangerhelperlist"),i.getContent(function(b){a.$node("strangerHelpersWrapper").append(b),a.done("strangerListContentReady")}),i.set("lazyLoadInterval",50),i.wire("Changed:isEmpty",function(b){j()}),a.bind(i,["zid","gid"]),a.$node("viewSummaryLnk").click(function(){a.fire({name:"helpersViewSummaryClicked"})})})}}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/helpfulness/controller/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_gameboard_helpfulness_controller_controller:[]})}})

ZY.ZUI.module({name:"widgets/zdc/common/scorebadge",version:1,extend:"widgets/base",themes:[""],constructor:function(a,b,c,d){var e="tiny",f="small",g="thirtyfive",h="medium",i="large",j="xlarge",k="xxlarge",l="blue",m="green";a.declare("size","score","units","color","scoreDigitCss","adaptFontSizeToNumDigits"),a.bindStateToClass("adaptFontSizeToNumDigits"),a.declareAndSet({t_content:'<div class="$$"><div class="$scorebadgeInner$"><div class="$score$"></div><div class="$units$"></div></div></div>',adaptFontSizeToNumDigits:!0}),a.bindStateToContent("units"),a.bindStateToClass("scoreDigitCss"),a.bindStateToClass("size","%size%"),a.bindStateToClass("color"),a.bindStateToContent("score",function(c){var d=Number(c);d=isNaN(d)?0:parseInt(d,10),c>9999?(a.set("scoreDigitCss","threedigits"),d=Math.round(c/1e3).toString()+"k"):c>999?a.set("scoreDigitCss","fourdigits"):c>99&&a.set("scoreDigitCss","threedigits"),a.$node("score").text(d)}),a.createContent=function(b){a.need("$",function(c){a.content=c(a.useTemplate("t_content")),b(a.content)})},b({SIZE_TINY:e,SIZE_SMALL:f,SIZE_THIRTYFIVE:g,SIZE_MEDIUM:h,SIZE_LARGE:i,SIZE_XLARGE:j,SIZE_XXLARGE:k,COLOR_BLUE:l,COLOR_GREEN:m})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/helpfulness/header/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_gameboard_helpfulness_header_header:{str_header_helps_label:{original:"helps"},str_header_rewards_label:{original:"rewards"},str_helps_ttip_text:{original:"Earn rewards and make game progress by receiving and giving helps."},str_rewards_ttip_text:{original:"Earn rewards and make game progress by giving zFriends help. It pays to be nice!"}}})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/helpfulness/header",version:1,extend:"widgets/base",required:["widgets/zdc/common/scorebadge","widgets/zdc/common/tooltip","widgets/zdc/common/expando","widgets/zdc/services/helpfulness"],themes:[""],localized:!0,constructor:function(a,b,c,d){function g(){a.once(["zid_set","gid_set"],function(){e.once("initialized",function(){var c=a.get("gid");e.getGameHelpers({gids:[c]},function(d){if(!d||!d.hasOwnProperty(c))return;var e=d[c];a.set("numHelps",e.numHelps),a.set("numRewards",e.numRewards),a.done("data_ready")})})})}var e=c.getInstance("widgets/zdc/services/helpfulness"),f;a.declare("zid","gid","numHelps","numRewards","str_header_helps_label","str_header_rewards_label","str_helps_ttip_text","str_rewards_ttip_text"),a.declareAndSet({t_content:'<div class="$$ zui_clearfix"><div class="$expandoWrapper$"></div><div class="$helpsScoreWrapper$"><div class="$helpsScoreBadgeWrapper$"></div><div class="$helpsScoreText$">%str_header_helps_label%</div></div><div class="$rewardsScoreWrapper$"><div class="$rewardsScoreBadgeWrapper$"></div><div class="$rewardsScoreText$">%str_header_rewards_label%</div></div></div>',expanded:!1}),a.onStateChange("zid",function(c){a.done("zid_set")}),a.onStateChange("gid",function(){a.done("gid_set"),g()}),a.createContent=function(b){a.need("$",function(c){var d=a.content=c(a.useTemplate("t_content")),e=a.addChild("helpsScoreBadge","widgets/zdc/common/scorebadge");e.set("size",e.SIZE_TINY),e.getContent(function(b){a.$node("helpsScoreBadgeWrapper").append(b)}),a.bind(e,[["numHelps","score"]]);var g=a.addChild("helpsTooltip","widgets/zdc/common/tooltip",{$parentNode:a.$node("helpsScoreWrapper"),title:a.localize("str_helps_ttip_text")});g.getContent(function(b){a.$root().append(b)});var h=a.addChild("rewardsScoreBadge","widgets/zdc/common/scorebadge");h.set("size",h.SIZE_TINY),h.set("color",h.COLOR_GREEN),h.getContent(function(b){a.$node("rewardsScoreBadgeWrapper").append(b)}),a.bind(h,[["numRewards","score"]]);var i=a.addChild("rewardsTooltip","widgets/zdc/common/tooltip",{$parentNode:a.$node("rewardsScoreWrapper"),title:a.localize("str_rewards_ttip_text")});i.getContent(function(b){a.$root().append(b)}),f=a.addChild("expando","widgets/zdc/common/expando"),f.set("size",f.SIZE_LARGE),f.set("color",f.COLOR_GRAY),f.set("alt",f.ALT1),f.getContent(function(b){a.$node("expandoWrapper").append(b),a.done("expando_ready")}),a.bind(f,["expanded"]),a.$root().click(function(){a.get("expanded")||a.track(["ZDC_gameboard","helpers","","","click",a.get("gid")]),a.set("expanded",!a.get("expanded"))}),b(d)})},e.once("initialized",function(){e.wire("helperStatsUpdated",function(c){var d=c.data;a.set("numHelps",d.numHelps),a.set("numRewards",d.numRewards)})})}})

ZY.ZUI.module({name:"widgets/button/imagebutton",version:1,extend:"widgets/button",themes:[""],constructor:function(a,b,c,d){function e(b){var c=a.$node("img");c.show(),b.url&&c.attr("src",b.url)}function f(a){a&&a.url&&((new Image).src=a.url)}a.set("theme",undefined),b({setImage:function(b){a.once("content",function(){var c=a.$node(),d=a.$node("img");b.width!==undefined&&d.css("width",b.width+"px"),b.height!==undefined&&d.css("height",b.height+"px"),e(b.enabled),b.hover&&c.mouseenter(function(){a.get("enabled")&&e(b.hover)}).mouseleave(function(){a.get("enabled")&&e(b.enabled)}),b.active&&c.mousedown(function(){a.get("enabled")&&e(b.active)}).mouseup(function(){a.get("enabled")&&e(b.enabled)});if(b.disabled){var f=function(c){e(a.get("enabled")?b.enabled:b.disabled)};a.onStateChange("enabled",f),f()}}),f(b.enabled),f(b.hover),f(b.active),f(b.disabled)}})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/helpfulness/summary/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_gameboard_helpfulness_summary_summary:{str_helps_description:{original:"<strong>helps</strong> received from <strong>{numHelpers}</strong> players"},str_rewards_description:{original:"<strong>rewards</strong> earned by helping <strong>{numHelped}</strong> players"},str_preamble:{original:"Earn rewards and make game progress by receiving and giving helps."},str_helps_help_icon_text:{original:"Earn rewards and make game progress by receiving and giving helps."},str_rewards_help_icon_text:{original:"Earn rewards and make game progress by giving zFriends help. It pays to be nice!"},str_view_thank_link:{original:"View and Thank"},str_share_btn_label:{original:"Share Success"},str_success_text:{original:"Successfully shared"}}})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/helpfulness/summary",version:1,extend:"widgets/base",required:["widgets/zdc/common/scorebadge","widgets/zdc/common/expando","widgets/zdc/common/helpicon","widgets/zdc/common/facepile","widgets/button/imagebutton","widgets/zdc/services/helpfulness"],themes:[""],localized:!0,constructor:function(a,b,c,d){function m(b,c,d){a.set(d,b.get(c)),b.wire("Changed:"+c,function(b){a.set(d,b.newValue)})}function n(){var b=a.$node("facepileWrapper");b.fadeTo(j,1,function(){b.slideDown(k,function(){b.show()})})}function o(){var b=a.$node("facepileWrapper");b.fadeTo(i,0,function(){b.slideUp(k,function(){b.hide()})})}function p(){g.once("content",function(){g.removeItems(g.getAvatarCount())})}function q(){a.once(["zid_set","gid_set"],function(){f.once("initialized",function(){var c=a.get("gid");f.getGameHelpers({gids:[c]},function(d){if(!d||!d.hasOwnProperty(c))return;var e=d[c];a.set("numHelps",e.numHelps),a.set("numRewards",e.numRewards),a.set("numHelped",e.numHelped),a.set("numHelpers",e.numHelpers),a.set("helpers",e.featured)})})})}function r(){a.once("content",function(){a.need("$",function(b){var c=a.$node("shareButtonCentering");e.hide();var d=b(a.useTemplate("t_shared_success"));c.append(d),setTimeout(function(){d.remove(),e.setEnabled(!0),e.show()},l)})})}var e,f=c.getInstance("widgets/zdc/services/helpfulness"),g,h=5,i=300,j=300,k=500,l=5e3;a.declare("zid","gid","numHelps","numRewards","numHelped","numHelpers","helpers","milestoneReached","shareEnabled","str_helps_description","str_rewards_description","str_preamble","str_view_thank_link","str_rewards_help_icon_text","str_helps_help_icon_text","str_share_btn_label","str_success_text"),a.onStateChange("zid",function(){a.done("zid_set")}),a.onStateChange("gid",function(){a.done("gid_set"),q()}),a.bindStateToClass("milestoneReached"),a.bindStateToClass("shareEnabled"),m(f,"shareEnabled","shareEnabled"),a.bindStateToContent("milestoneReached",function(b){b?(e.set("size",e.SIZE_LARGE),e.set("color",e.COLOR_BLUE)):(e.set("size",e.SIZE_SMALL),e.set("color",e.COLOR_WHITE)),e.getContent(function(b){a.$node("shareButtonCentering").append(b)})}),a.declareAndSet({t_content:'<div class="$$"><div class="$background$"></div><div class="$content$"><div class="$preamble$">%str_preamble%</div><div class="$helpsScoreWrapper$ zui_clearfix"><div class="$helpsScoreBadgeWrapper$"></div><div class="$helpsScoreDetails$"><div class="$helpsScoreExplanation$ zui_clearfix"></div><div class="$facepileWrapper$"></div></div></div><div class="$rewardsScoreWrapper$ zui_clearfix"><div class="$rewardsScoreBadgeWrapper$"></div><div class="$rewardsScoreDetails$"></div></div><div class="$shareButtonWrapper$"><div class="$shareButtonCentering$"></div></div></div></div>',milestoneReached:!1,t_helps_score_explanation:'<span class="$helpsScoreText$">%text%<span class="$helpsScoreHelpIconWrapper$"></span><span> </span><a class="$viewAndThank$">%str_view_thank_link%</a></span>',t_rewards_score_explanation:'<span class="$rewardsScoreText$">%text%<span class="$rewardsScoreHelpIconWrapper$"></span></span>',t_shared_success:'<span class="$sharedSuccessMessage$">%str_success_text%</span>'}),a.bindStateToContent("numHelpers",function(b){b||(b=0);var c=a.addChild("helpsHelpIcon","widgets/zdc/common/helpicon");c.set("tooltipHeader",a.localize("str_helps_help_icon_text")),c.getContent(function(c){a.$node("helpsScoreExplanation").html(a.useTemplate("t_helps_score_explanation",{text:a.localize("str_helps_description",{numHelpers:b})})),a.$node("helpsScoreHelpIconWrapper").append(c),a.$node("viewAndThank").click(function(){a.fire({name:"helpersViewAndThankClicked"})})})}),a.bindStateToContent("numHelped",function(b){b||(b=0);var c=a.addChild("rewardsHelpIcon","widgets/zdc/common/helpicon");c.set("tooltipHeader",a.localize("str_rewards_help_icon_text")),c.getContent(function(c){a.$node("rewardsScoreDetails").html(a.useTemplate("t_rewards_score_explanation",{text:a.localize("str_rewards_description",{numHelped:b})})),a.$node("rewardsScoreHelpIconWrapper").append(c)})}),a.bindStateToContent("helpers",function(a){if(!a){o(),p();return}var b=!1;for(var c in a)a.hasOwnProperty(c)&&(b=!0,g.addUser({zid:c}));b?n():(o(),p())}),a.createContent=function(b){a.need("$",function(d){var f=a.content=d(a.useTemplate("t_content")),i=a.addChild("helpsScoreBadge","widgets/zdc/common/scorebadge");i.set("adaptFontSizeToNumDigits",!1),i.set("size",i.SIZE_SMALL),i.getContent(function(b){a.$node("helpsScoreBadgeWrapper").append(b)}),a.bind(i,[["numHelps","score"]]);var j=a.addChild("rewardsScoreBadge","widgets/zdc/common/scorebadge");j.set("adaptFontSizeToNumDigits",!1),j.set("size",j.SIZE_SMALL),j.set("color",j.COLOR_GREEN),j.getContent(function(b){a.$node("rewardsScoreBadgeWrapper").append(b)}),a.bind(j,[["numRewards","score"]]),g=a.addChild("facepile","widgets/zdc/common/facepile"),g.set("columns",h),g.set("max_display",h),g.set("avatar_size","tiny"),g.getContent(function(b){a.$node("facepileWrapper").append(b)}),e=a.addChild("shareBtn","widgets/button/imagebutton"),e.set({enabled:!0,theme:"zdc",label:a.localize("str_share_btn_label")}),e.setImage({width:16,height:15,enabled:{url:c.zui().baseUrl+a.def.name+"/fb_icon_15.png"}}),e.wire("click",function(){a.track(["ZDC_gameboard","helpers","helper_summary","CTA_FBShare","click",a.get("gid")]),a.fire({name:"helpersShareButtonClicked",bubble:!0,onSuccess:r})}),b(f)})},f.once("initialized",function(){f.wire("helperStatsUpdated",function(c){var d=c.data;a.set("numHelps",d.numHelps),a.set("numRewards",d.numRewards),a.set("numHelped",d.numHelped),a.set("numHelpers",d.numHelpers)})}),a.once("content",function(){function b(a){if(a.hasOwnProperty("helper")){var b=a.helper;g.promoteUser({zid:b.zid}),n()}}f.wire({helperAdded:b,helperUpdated:b})}),b({})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/helpfulness/controller",version:1,extend:"widgets/base",required:["widgets/zdc/gameboard/helpfulness/actions","widgets/zdc/gameboard/helpfulness/summary","widgets/zdc/gameboard/helpfulness/header","widgets/zdc/services/gameboard","widgets/zdc/services/helpfulness"],themes:[""],localized:!0,constructor:function(a,b,c,d){function i(b,c,d){a.set(d,b.get(c)),b.wire("Changed:"+c,function(b){a.set(d,b.newValue)})}function j(b){a.once(["summary_ready","actions_ready"],function(){h!=b&&a.children[h].hide(),h=b;if(a.get("expanded")){var d=a.get("gid");h=="summary"?(a.track(["ZDC_gameboard","helpers","helper_summary","","view",d]),a.get("shareEnabled")&&a.track(["ZDC_gameboard","helpers","helper_summary","CTA_FBShare","view",d])):a.track(["ZDC_gameboard","helpers","helper_list","","view",d]),a.children[h].show()}else a.children[h].hide()})}var e=c.getInstance("widgets/zdc/services/helpfulness"),f=c.getInstance("widgets/zdc/services/gameboard"),g=c.getInstance("widgets/zdc/services/user"),h="summary";a.declare("zid","gid","strangerActionIsAdd","expanded","active","actionsPanelIsEmpty","shareEnabled"),a.bindStateToClass("expanded"),a.bindStateToClass("actionsPanelIsEmpty"),f.fireWire({name:"gameboard.attached",callback:function(b){a.set("gid",b.gameId)}}),i(g,"currentUserZid","zid"),i(e,"shareEnabled","shareEnabled"),a.set("expanded",e.get("helpersExpandedByDefault")),a.declareAndSet({t_content:'<div class="$$"><div class="$headerWrapper$"></div><div class="$views$"><div class="$summaryWrapper$"></div><div class="$actionsWrapper$"></div></div></div>',expanded:!1,visible:!0,actionsPanelIsEmpty:!0}),a.onStateChange("zid",function(){a.done("zid_set")}),a.onStateChange("gid",function(b){j("summary"),a.set("expanded",e.get("helpersExpandedByDefault"));var c=b.newValue;c&&(a.done("gid_set"),a.track(["ZDC_gameboard","helpers","","","view",c]))}),a.bindStateToContent("expanded",function(b){j(h),a.fire({name:"helpersToggled",bubble:!0})}),a.createContent=function(b){a.need("$",function(c){var d=a.content=c(a.useTemplate("t_content"));b(d);var e=a.addChild("header","widgets/zdc/gameboard/helpfulness/header");a.bind(e,["zid","gid","expanded"]),e.bind(a,["expanded"]),e.getContent(function(b){a.$node("headerWrapper").append(b),a.done("header_ready")});var f=a.addChild("summary","widgets/zdc/gameboard/helpfulness/summary");a.bind(f,["zid","gid"]),f.getContent(function(b){a.get("expanded")||f.hide(),a.$node("summaryWrapper").append(b),a.done("summary_ready")}),f.wire("helpersViewAndThankClicked",function(){j("actions")});var g=a.addChild("actions","widgets/zdc/gameboard/helpfulness/actions");a.bind(g,["zid","gid"]),g.getContent(function(b){g.hide(),a.$node("actionsWrapper").append(b),a.done("actions_ready")}),g.wire("helpersViewSummaryClicked",function(){j("summary")}),g.bind(a,[["isEmpty","actionsPanelIsEmpty"]])})}}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/rts/feedAd",version:1,extend:"widgets/listitem",themes:[""],localized:!1,required:["widgets/zdc/common/ads"],constructor:function(a,b,c,d){var e={type:"easeOutQuad",interval:1e3},f={type:"easeOutQuad",interval:600},g=a.nodeClass("animating");a.declare("widgetClass","feedType","adParams","animate","id","dispId","dispTs","ts","cta","adHeight"),a.declareAndSet({t_content:'<div class="$$"></div>'}),a.bindStateToContent("adHeight",function(b){var c=a.get("animate"),d=a.$root(),f=d.parent();c?(f.addClass(g),f.animate({height:b},e.interval,e.type,function(){f.removeClass(g),f.height("auto")})):f.height("auto"),a.fire({name:"rts_feedAd_view",feedType:a.get("feedType"),bubble:!0})}),a.bindStateToContent("adParams",function(b){var c=a.addChild("ads","widgets/zdc/common/ads");b.owner=a.get("id"),c.getContent(function(d){c.set("adParams",b),c.wire("adHeightSet",function(b){a.set("adHeight",b.height)}),a.$root().append(d),a.done("adsReady")})}),a.createContent=function(b){a.need("$",function(c){a.content=c(a.useTemplate("t_content")),b(a.content)})},b({})}})

ZY.ZUI.module({name:"jquery/transform",version:1,extend:"base",singleton:!0,constructor:function(a,b,c,d){a.need("$",function(b){(function(a,b,c,d){function j(a){return parseFloat(a)}function k(){var a={transformProperty:"",MozTransform:"-moz-",WebkitTransform:"-webkit-",OTransform:"-o-",msTransform:"-ms-"};for(var b in a)if(typeof i[b]!="undefined")return a[b];return null}function l(){if(typeof b.Modernizr!="undefined")return Modernizr.csstransforms;var a=["transformProperty","WebkitTransform","MozTransform","OTransform","msTransform"];for(var c in a)if(i[a[c]]!==d)return!0}function p(b,c){if(b[c]===null||!!b.style&&b.style[c]!==null){var d=parseFloat(a.css(b,c));return d&&d>-1e4?d:0}return b[c]}var e=/progid:DXImageTransform\.Microsoft\.Matrix\(.*?\)/,f=/^([\+\-]=)?([\d+.\-]+)(.*)$/,g=/%/,h=c.createElement("modernizr"),i=h.style,m=k(),n=m!==null?m+"transform":!1,o=m!==null?m+"transform-origin":!1;a.support.csstransforms=l(),m=="-ms-"&&(n="msTransform",o="msTransformOrigin"),a.extend({transform:function(b){b.transform=this,this.$elem=a(b),this.applyingMatrix=!1,this.matrix=null,this.height=null,this.width=null,this.outerHeight=null,this.outerWidth=null,this.boxSizingValue=null,this.boxSizingProperty=null,this.attr=null,this.transformProperty=n,this.transformOriginProperty=o}}),a.extend(a.transform,{funcs:["matrix","origin","reflect","reflectX","reflectXY","reflectY","rotate","scale","scaleX","scaleY","skew","skewX","skewY","translate","translateX","translateY"]}),a.fn.transform=function(b,c){return this.each(function(){var d=this.transform||new a.transform(this);b&&d.exec(b,c)})},a.transform.prototype={exec:function(b,c){return c=a.extend(!0,{forceMatrix:!1,preserve:!1},c),this.attr=null,c.preserve?b=a.extend(!0,this.getAttrs(!0,!0),b):b=a.extend(!0,{},b),this.setAttrs(b),a.support.csstransforms&&!c.forceMatrix?this.execFuncs(b):a.browser.msie||a.support.csstransforms&&c.forceMatrix?this.execMatrix(b):!1},execFuncs:function(b){var c=[];for(var d in b)d=="origin"?this[d].apply(this,a.isArray(b[d])?b[d]:[b[d]]):a.inArray(d,a.transform.funcs)!==-1&&c.push(this.createTransformFunc(d,b[d]));return this.$elem.css(n,c.join(" ")),!0},execMatrix:function(b){function k(a,b){return g.test(a)?parseFloat(a)/100*i["safeOuter"+(b?"Height":"Width")]():this.toPx(h,a)}var c,d,f,h=this.$elem[0],i=this,l=/translate[X|Y]?/,o=[];for(var p in b)if(b.hasOwnProperty(p)){switch(a.type(b[p])){case"array":f=b[p];break;case"string":f=a.map(b[p].split(","),a.trim);break;default:f=[b[p]]}a.matrix[p]?(a.cssAngle[p]?f=a.map(f,a.angle.toDegree):a.cssNumber[p]?f=a.map(f,j):f=a.map(f,k),d=a.matrix[p].apply(this,f),l.test(p)?o.push(d):c=c?c.x(d):d):p=="origin"&&this[p].apply(this,f)}c=c||a.matrix.identity(),a.each(o,function(a,b){c=c.x(b)});var q=parseFloat(c.e(1,1).toFixed(6)),r=parseFloat(c.e(2,1).toFixed(6)),s=parseFloat(c.e(1,2).toFixed(6)),t=parseFloat(c.e(2,2).toFixed(6)),u=c.rows===3?parseFloat(c.e(1,3).toFixed(6)):0,v=c.rows===3?parseFloat(c.e(2,3).toFixed(6)):0;if(a.support.csstransforms&&m==="-moz-")this.$elem.css(n,"matrix("+q+", "+r+", "+s+", "+t+", "+u+"px, "+v+"px)");else if(a.support.csstransforms)this.$elem.css(n,"matrix("+q+", "+r+", "+s+", "+t+", "+u+", "+v+")");else if(a.browser.msie){var w=", FilterType='nearest neighbor'",x=this.$elem[0].style,y="progid:DXImageTransform.Microsoft.Matrix(M11="+q+", M12="+s+", M21="+r+", M22="+t+", sizingMethod='auto expand'"+w+")",z=x.filter||a.curCSS(this.$elem[0],"filter")||"";x.filter=e.test(z)?z.replace(e,y):z?z+" "+y:y,this.applyingMatrix=!0,this.matrix=c,this.fixPosition(c,u,v),this.applyingMatrix=!1,this.matrix=null}return!0},origin:function(b,c){if(a.support.csstransforms)return typeof c=="undefined"?this.$elem.css(o,b):this.$elem.css(o,b+" "+c),!0;switch(b){case"left":b="0";break;case"right":b="100%";break;case"center":case d:b="50%"}switch(c){case"top":c="0";break;case"bottom":c="100%";break;case"center":case d:c="50%"}return this.setAttr("origin",[g.test(b)?b:this.toPx(this.$elem[0],b)+"px",g.test(c)?c:this.toPx(this.$elem[0],c)+"px"]),!0},createTransformFunc:function(b,c){if(b.substr(0,7)==="reflect"){var d=c?a.matrix[b]():a.matrix.identity();return"matrix("+d.e(1,1)+", "+d.e(2,1)+", "+d.e(1,2)+", "+d.e(2,2)+", 0, 0)"}return b=="matrix"&&m==="-moz-"&&(c[4]=c[4]?c[4]+"px":0,c[5]=c[5]?c[5]+"px":0),b+"("+(a.isArray(c)?c.join(", "):c)+")"},fixPosition:function(b,c,d,e,f){var h=new a.matrix.calc(b,this.safeOuterHeight(),this.safeOuterWidth()),i=this.getAttr("origin"),j=h.originOffset(new a.matrix.V2(g.test(i[0])?parseFloat(i[0])/100*h.outerWidth:parseFloat(i[0]),g.test(i[1])?parseFloat(i[1])/100*h.outerHeight:parseFloat(i[1]))),k=h.sides(),l=this.$elem.css("position");l=="static"&&(l="relative");var m={top:0,left:0},n={position:l,top:j.top+d+k.top+m.top+"px",left:j.left+c+k.left+m.left+"px",zoom:1};this.$elem.css(n)},toPx:function(b,c){var d=f.exec(a.trim(c));if(d[3]&&d[3]!=="px"){var e="paddingBottom",g=a.style(b,e);return a.style(b,e,c),c=p(b,e),a.style(b,e,g),c}return parseFloat(c)}}})(b,window,window.document),function(a,b,c,d){a.extend(a.transform.prototype,{safeOuterHeight:function(){return this.safeOuterLength("height")},safeOuterWidth:function(){return this.safeOuterLength("width")},safeOuterLength:function(b){function f(){if(e)return e;var a={boxSizing:"box-sizing",MozBoxSizing:"-moz-box-sizing",WebkitBoxSizing:"-webkit-box-sizing",OBoxSizing:"-o-box-sizing"},b=c.body;for(var d in a)if(typeof b.style[d]!="undefined")return e=a[d],e;return null}var d="outer"+(b=="width"?"Width":"Height"),e=null;if(!a.support.csstransforms&&a.browser.msie){b=b=="width"?"width":"height";if(this.applyingMatrix&&!this[d]&&this.matrix){var g=new a.matrix.calc(this.matrix,1,1),h=g.offset(),i=this.$elem[d]()/h[b];return this[d]=i,i}if(this.applyingMatrix&&this[d])return this[d];var j={height:["top","bottom"],width:["left","right"]},k=this.$elem[0],l=parseFloat(a.curCSS(k,b,!0)),m=this.boxSizingProperty,n=this.boxSizingValue;return this.boxSizingProperty||(m=this.boxSizingProperty=f()||"box-sizing",n=this.boxSizingValue=this.$elem.css(m)||"content-box"),this[d]&&this[b]==l?this[d]:(this[b]=l,m&&(n=="padding-box"||n=="content-box")&&(l+=parseFloat(a.curCSS(k,"padding-"+j[b][0],!0))||0+parseFloat(a.curCSS(k,"padding-"+j[b][1],!0))||0),m&&n=="content-box"&&(l+=parseFloat(a.curCSS(k,"border-"+j[b][0]+"-width",!0))||0+parseFloat(a.curCSS(k,"border-"+j[b][1]+"-width",!0))||0),this[d]=l,l)}return this.$elem[d]()}})}(b,window,window.document),function(a,b,c,d){var e=/([\w\-]*?)\((.*?)\)/g,f="data-transform",g=/\s/,h=/,\s?/;a.extend(a.transform.prototype,{setAttrs:function(b){var c="",d;for(var e in b)b.hasOwnProperty(e)&&(d=b[e],a.isArray(d)&&(d=d.join(", ")),c+=" "+e+"("+d+")");this.attr=a.trim(c),this.$elem.attr(f,this.attr)},setAttr:function(b,c){a.isArray(c)&&(c=c.join(", "));var d=this.attr||this.$elem.attr(f);if(!d||d.indexOf(b)==-1)this.attr=a.trim(d+" "+b+"("+c+")"),this.$elem.attr(f,this.attr);else{var g=[],h;e.lastIndex=0,h=e.exec(d);while(h)b==h[1]?g.push(b+"("+c+")"):g.push(h[0]);this.attr=g.join(" "),this.$elem.attr(f,this.attr)}},getAttrs:function(){var a=this.attr||this.$elem.attr(f);if(!a)return{};var b={},c,d;e.lastIndex=0;while((c=e.exec(a))!==null)c&&(d=c[2].split(h),b[c[1]]=d.length==1?d[0]:d);return b},getAttr:function(b){var c=this.getAttrs();return typeof c[b]!="undefined"?c[b]:b==="origin"&&a.support.csstransforms?this.$elem.css(this.transformOriginProperty).split(g):b==="origin"?["50%","50%"]:a.cssDefault[b]||0}}),typeof a.cssAngle=="undefined"&&(a.cssAngle={}),a.extend(a.cssAngle,{rotate:!0,skew:!0,skewX:!0,skewY:!0}),typeof a.cssDefault=="undefined"&&(a.cssDefault={}),a.extend(a.cssDefault,{scale:[1,1],scaleX:1,scaleY:1,matrix:[1,0,0,1,0,0],origin:["50%","50%"],reflect:[1,0,0,1,0,0],reflectX:[1,0,0,1,0,0],reflectXY:[1,0,0,1,0,0],reflectY:[1,0,0,1,0,0]}),typeof a.cssMultipleValues=="undefined"&&(a.cssMultipleValues={}),a.extend(a.cssMultipleValues,{matrix:6,origin:{length:2,duplicate:!0},reflect:6,reflectX:6,reflectXY:6,reflectY:6,scale:{length:2,duplicate:!0},skew:2,translate:2}),a.extend(a.cssNumber,{matrix:!0,reflect:!0,reflectX:!0,reflectXY:!0,reflectY:!0,scale:!0,scaleX:!0,scaleY:!0}),a.each(a.transform.funcs,function(b,c){a.cssHooks[c]={set:function(b,d){var e=b.transform||new a.transform(b),f={};f[c]=d,e.exec(f,{preserve:!0})},get:function(b,d){var e=b.transform||new a.transform(b);return e.getAttr(c)}}}),a.each(["reflect","reflectX","reflectXY","reflectY"],function(b,c){a.cssHooks[c].get=function(b,d){var e=b.transform||new a.transform(b);return e.getAttr("matrix")||a.cssDefault[c]}})}(b,window,window.document),function(a,c,d,e){function i(b,c){var d=parseFloat(a.css(b,c));return d&&d>-1e4?d:0}var f=/^([+\-]=)?([\d+.\-]+)(.*)$/,g=a.fn.animate;a.fn.animate=function(c,d,e,f){var h=a.speed(d,e,f),i=a.cssMultipleValues;return h.complete=h.old,a.isEmptyObject(c)||(typeof h.original=="undefined"&&(h.original={}),a.each(c,function(d,e){if(i[d]||a.cssAngle[d]||!a.cssNumber[d]&&a.inArray(d,a.transform.funcs)!==-1){var f=null;if(b.isArray(c[d])){var g=1,j=e.length;i[d]&&(g=typeof i[d].length=="undefined"?i[d]:i[d].length);if(j>g||j<g&&j==2||j==2&&g==2&&isNaN(parseFloat(e[j-1])))f=e[j-1],e.splice(j-1,1)}h.original[d]=e.toString(),c[d]=parseFloat(e)}})),g.apply(this,[arguments[0],h])};var h="paddingBottom",j=a.fx.prototype.custom;a.fx.prototype.custom=function(b,c,d){var e=a.cssMultipleValues[this.prop],g=a.cssAngle[this.prop];if(e||!a.cssNumber[this.prop]&&a.inArray(this.prop,a.transform.funcs)!==-1){this.values=[],e||(e=1);var k=this.options.original[this.prop],l=a(this.elem).css(this.prop),m=a.cssDefault[this.prop]||0;a.isArray(l)||(l=[l]),a.isArray(k)||(a.type(k)==="string"?k=k.split(","):k=[k]);var n=e.length||e,o=0;while(k.length<n)k.push(e.duplicate?k[0]:m[o]||0),o++;var p,q,r,s=this,t=s.elem.transform,u=a.style(s.elem,h);a.each(k,function(b,c){l[b]?p=l[b]:m[b]&&!e.duplicate?p=m[b]:e.duplicate?p=l[0]:p=0,g?p=a.angle.toDegree(p):a.cssNumber[s.prop]||(q=f.exec(a.trim(p)),q[3]&&q[3]!=="px"&&(q[3]==="%"?p=parseFloat(q[2])/100*t["safeOuter"+(b?"Height":"Width")]():(a.style(s.elem,h,p),p=i(s.elem,h),a.style(s.elem,h,u)))),p=parseFloat(p),q=f.exec(a.trim(c)),q?(r=parseFloat(q[2]),d=q[3]||"px",g?(r=a.angle.toDegree(r+d),d="deg"):!a.cssNumber[s.prop]&&d==="%"?p=p/t["safeOuter"+(b?"Height":"Width")]()*100:!a.cssNumber[s.prop]&&d!=="px"&&(a.style(s.elem,h,(r||1)+d),p=(r||1)/i(s.elem,h)*p,a.style(s.elem,h,u)),q[1]&&(r=(q[1]==="-="?-1:1)*r+p)):(r=c,d=""),s.values.push({start:p,end:r,unit:d})})}return j.apply(this,arguments)},a.fx.multipleValueStep={_default:function(b){a.each(b.values,function(a,c){b.values[a].now=c.start+(c.end-c.start)*b.pos})}},a.each(["matrix","reflect","reflectX","reflectXY","reflectY"],function(b,c){a.fx.multipleValueStep[c]=function(b){var c=b.decomposed,d=a.matrix,e=d.identity();c.now={},a.each(c.start,function(a){c.now[a]=parseFloat(c.start[a])+(parseFloat(c.end[a])-parseFloat(c.start[a]))*b.pos;if((a==="scaleX"||a==="scaleY")&&c.now[a]===1||a!=="scaleX"&&a!=="scaleY"&&c.now[a]===0)return!0;e=e.x(d[a](c.now[a]))});var f;a.each(b.values,function(a){switch(a){case 0:f=parseFloat(e.e(1,1).toFixed(6));break;case 1:f=parseFloat(e.e(2,1).toFixed(6));break;case 2:f=parseFloat(e.e(1,2).toFixed(6));break;case 3:f=parseFloat(e.e(2,2).toFixed(6));break;case 4:f=parseFloat(e.e(1,3).toFixed(6));break;case 5:f=parseFloat(e.e(2,3).toFixed(6))}b.values[a].now=f})}}),a.each(a.transform.funcs,function(b,c){a.fx.step[c]=function(b){var d=b.elem.transform||new a.transform(b.elem),e={};a.cssMultipleValues[c]||!a.cssNumber[c]&&a.inArray(c,a.transform.funcs)!==-1?((a.fx.multipleValueStep[b.prop]||a.fx.multipleValueStep._default)(b),e[b.prop]=[],a.each(b.values,function(c,d){e[b.prop].push(d.now+(a.cssNumber[b.prop]?"":d.unit))})):e[b.prop]=b.now+(a.cssNumber[b.prop]?"":b.unit),d.exec(e,{preserve:!0})}}),a.each(["matrix","reflect","reflectX","reflectXY","reflectY"],function(b,c){a.fx.step[c]=function(b){var d=b.elem.transform||new a.transform(b.elem),e={};if(!b.initialized){b.initialized=!0;if(c!=="matrix"){var f=a.matrix[c]().elements,g;a.each(b.values,function(a){switch(a){case 0:g=f[0];break;case 1:g=f[2];break;case 2:g=f[1];break;case 3:g=f[3];break;default:g=0}b.values[a].end=g})}b.decomposed={};var h=b.values;b.decomposed.start=a.matrix.matrix(h[0].start,h[1].start,h[2].start,h[3].start,h[4].start,h[5].start).decompose(),b.decomposed.end=a.matrix.matrix(h[0].end,h[1].end,h[2].end,h[3].end,h[4].end,h[5].end).decompose()}(a.fx.multipleValueStep[b.prop]||a.fx.multipleValueStep._default)(b),e.matrix=[],a.each(b.values,function(a,b){e.matrix.push(b.now)}),d.exec(e,{preserve:!0})}})}(b,window,window.document),function(a,b,c,d){var e=180/Math.PI,f=200/Math.PI,g=Math.PI/180,h=2/1.8,i=.9,j=Math.PI/200,k=/^([+\-]=)?([\d+.\-]+)(.*)$/;a.extend({angle:{runit:/(deg|g?rad)/,radianToDegree:function(a){return a*e},radianToGrad:function(a){return a*f},degreeToRadian:function(a){return a*g},degreeToGrad:function(a){return a*h},gradToDegree:function(a){return a*i},gradToRadian:function(a){return a*j},toDegree:function(b){var c=k.exec(b);if(c){b=parseFloat(c[2]);switch(c[3]||"deg"){case"grad":b=a.angle.gradToDegree(b);break;case"rad":b=a.angle.radianToDegree(b)}return b}return 0}}})}(b,window,window.document),function(a,b,c,d){typeof a.matrix=="undefined"&&a.extend({matrix:{}});var e=a.matrix;a.extend(e,{V2:function(b,c){a.isArray(arguments[0])?this.elements=arguments[0].slice(0,2):this.elements=[b,c],this.length=2},V3:function(b,c,d){a.isArray(arguments[0])?this.elements=arguments[0].slice(0,3):this.elements=[b,c,d],this.length=3},M2x2:function(b,c,d,e){a.isArray(arguments[0])?this.elements=arguments[0].slice(0,4):this.elements=Array.prototype.slice.call(arguments).slice(0,4),this.rows=2,this.cols=2},M3x3:function(b,c,d,e,f,g,h,i,j){a.isArray(arguments[0])?this.elements=arguments[0].slice(0,9):this.elements=Array.prototype.slice.call(arguments).slice(0,9),this.rows=3,this.cols=3}});var f={e:function(a,b){var c=this.rows,d=this.cols;return a>c||b>c||a<1||b<1?0:this.elements[(a-1)*d+b-1]},decompose:function(){var b=this.e(1,1),c=this.e(2,1),d=this.e(1,2),e=this.e(2,2),f=this.e(1,3),g=this.e(2,3);if(Math.abs(b*e-c*d)<.01)return{rotate:"0deg",skewX:"0deg",scaleX:1,scaleY:1,translateX:"0px",translateY:"0px"};var h=f,i=g,j=Math.sqrt(b*b+c*c);b/=j,c/=j;var k=b*d+c*e;d-=b*k,e-=c*k;var l=Math.sqrt(d*d+e*e);d/=l,e/=l,k/=l,b*e-c*d<0&&(b=-b,c=-c,j=-j);var m=a.angle.radianToDegree,n=m(Math.atan2(c,b));return k=m(Math.atan(k)),{rotate:n+"deg",skewX:k+"deg",scaleX:j,scaleY:l,translateX:h+"px",translateY:i+"px"}}};a.extend(e.M2x2.prototype,f,{toM3x3:function(){var a=this.elements;return new e.M3x3(a[0],a[1],0,a[2],a[3],0,0,0,1)},x:function(a){var b=typeof a.rows=="undefined";if(!b&&a.rows==3)return this.toM3x3().x(a);var c=this.elements,d=a.elements;return b&&d.length==2?new e.V2(c[0]*d[0]+c[1]*d[1],c[2]*d[0]+c[3]*d[1]):d.length==c.length?new e.M2x2(c[0]*d[0]+c[1]*d[2],c[0]*d[1]+c[1]*d[3],c[2]*d[0]+c[3]*d[2],c[2]*d[1]+c[3]*d[3]):!1},inverse:function(){var a=1/this.determinant(),b=this.elements;return new e.M2x2(a*b[3],a*-b[1],a*-b[2],a*b[0])},determinant:function(){var a=this.elements;return a[0]*a[3]-a[1]*a[2]}}),a.extend(e.M3x3.prototype,f,{x:function(a){var b=typeof a.rows=="undefined";!b&&a.rows<3&&(a=a.toM3x3());var c=this.elements,d=a.elements;return b&&d.length==3?new e.V3(c[0]*d[0]+c[1]*d[1]+c[2]*d[2],c[3]*d[0]+c[4]*d[1]+c[5]*d[2],c[6]*d[0]+c[7]*d[1]+c[8]*d[2]):d.length==c.length?new e.M3x3(c[0]*d[0]+c[1]*d[3]+c[2]*d[6],c[0]*d[1]+c[1]*d[4]+c[2]*d[7],c[0]*d[2]+c[1]*d[5]+c[2]*d[8],c[3]*d[0]+c[4]*d[3]+c[5]*d[6],c[3]*d[1]+c[4]*d[4]+c[5]*d[7],c[3]*d[2]+c[4]*d[5]+c[5]*d[8],c[6]*d[0]+c[7]*d[3]+c[8]*d[6],c[6]*d[1]+c[7]*d[4]+c[8]*d[7],c[6]*d[2]+c[7]*d[5]+c[8]*d[8]):!1},inverse:function(){var a=1/this.determinant(),b=this.elements;return new e.M3x3(a*(b[8]*b[4]-b[7]*b[5]),a*-(b[8]*b[1]-b[7]*b[2]),a*(b[5]*b[1]-b[4]*b[2]),a*-(b[8]*b[3]-b[6]*b[5]),a*(b[8]*b[0]-b[6]*b[2]),a*-(b[5]*b[0]-b[3]*b[2]),a*(b[7]*b[3]-b[6]*b[4]),a*-(b[7]*b[0]-b[6]*b[1]),a*(b[4]*b[0]-b[3]*b[1]))},determinant:function(){var a=this.elements;return a[0]*(a[8]*a[4]-a[7]*a[5])-a[3]*(a[8]*a[1]-a[7]*a[2])+a[6]*(a[5]*a[1]-a[4]*a[2])}});var g={e:function(a){return this.elements[a-1]}};a.extend(e.V2.prototype,g),a.extend(e.V3.prototype,g)}(b,window,window.document),function(a,b,c,d){typeof a.matrix=="undefined"&&a.extend({matrix:{}}),a.extend(a.matrix,{calc:function(a,b,c){this.matrix=a,this.outerHeight=b,this.outerWidth=c}}),a.matrix.calc.prototype={coord:function(b,c,d){d=typeof d!="undefined"?d:0;var e=this.matrix,f;switch(e.rows){case 2:f=e.x(new a.matrix.V2(b,c));break;case 3:f=e.x(new a.matrix.V3(b,c,d))}return f},corners:function(a,b){var c=typeof a=="undefined"&&typeof b=="undefined",d;return!this.c||!c?(b=b||this.outerHeight,a=a||this.outerWidth,d={tl:this.coord(0,0),bl:this.coord(0,b),tr:this.coord(a,0),br:this.coord(a,b)}):d=this.c,c&&(this.c=d),d},sides:function(a){var b=a||this.corners();return{top:Math.min(b.tl.e(2),b.tr.e(2),b.br.e(2),b.bl.e(2)),bottom:Math.max(b.tl.e(2),b.tr.e(2),b.br.e(2),b.bl.e(2)),left:Math.min(b.tl.e(1),b.tr.e(1),b.br.e(1),b.bl.e(1)),right:Math.max(b.tl.e(1),b.tr.e(1),b.br.e(1),b.bl.e(1))}},offset:function(a){var b=this.sides(a);return{height:Math.abs(b.bottom-b.top),width:Math.abs(b.right-b.left)}},area:function(a){var b=a||this.corners(),c={x:b.tr.e(1)-b.tl.e(1)+b.br.e(1)-b.bl.e(1),y:b.tr.e(2)-b.tl.e(2)+b.br.e(2)-b.bl.e(2)},d={x:b.bl.e(1)-b.tl.e(1)+b.br.e(1)-b.tr.e(1),y:b.bl.e(2)-b.tl.e(2)+b.br.e(2)-b.tr.e(2)};return.25*Math.abs(c.e(1)*d.e(2)-c.e(2)*d.e(1))},nonAffinity:function(){var a=this.sides(),b=a.top-a.bottom,c=a.left-a.right;return parseFloat(parseFloat(Math.abs((Math.pow(b,2)+Math.pow(c,2))/(a.top*a.bottom+a.left*a.right))).toFixed(8))},originOffset:function(b,c){b=b?b:new a.matrix.V2(this.outerWidth*.5,this.outerHeight*.5),c=c?c:new a.matrix.V2(0,0);var d=this.coord(b.e(1),b.e(2)),e=this.coord(c.e(1),c.e(2));return{top:e.e(2)-c.e(2)-(d.e(2)-b.e(2)),left:e.e(1)-c.e(1)-(d.e(1)-b.e(1))}}}}(b,window,window.document),function(a,b,c,d){typeof a.matrix=="undefined"&&a.extend({matrix:{}});var e=a.matrix,f=e.M2x2,g=e.M3x3;a.extend(e,{identity:function(a){a=a||2;var b=a*a,c=new Array(b),d=a+1;for(var f=0;f<b;f++)c[f]=f%d===0?1:0;return new e["M"+a+"x"+a](c)},matrix:function(){var a=Array.prototype.slice.call(arguments);switch(arguments.length){case 4:return new f(a[0],a[2],a[1],a[3]);case 6:return new g(a[0],a[2],a[4],a[1],a[3],a[5],0,0,1)}},reflect:function(){return new f(-1,0,0,-1)},reflectX:function(){return new f(1,0,0,-1)},reflectXY:function(){return new f(0,1,1,0)},reflectY:function(){return new f(-1,0,0,1)},rotate:function(b){var c=a.angle.degreeToRadian(b),d=Math.cos(c),e=Math.sin(c),g=d,h=e,i=-e,j=d;return new f(g,i,h,j)},scale:function(a,b){return a=a||a===0?a:1,b=b||b===0?b:a,new f(a,0,0,b)},scaleX:function(a){return e.scale(a,1)},scaleY:function(a){return e.scale(1,a)},skew:function(b,c){b=b||0,c=c||0;var d=a.angle.degreeToRadian(b),e=a.angle.degreeToRadian(c),g=Math.tan(d),h=Math.tan(e);return new f(1,g,h,1)},skewX:function(a){return e.skew(a)},skewY:function(a){return e.skew(0,a)},translate:function(a,b){return a=a||0,b=b||0,new g(1,0,a,0,1,b,0,0,1)},translateX:function(a){return e.translate(a)},translateY:function(a){return e.translate(0,a)}})}(b,window,window.document),a.done("initialized")}),b({once:a.once})}})

ZY.ZUI.module({name:"modernizr",version:1,builder:function(a,b){return function(){return function(a,b,c){function d(a){p.cssText=a}function e(a,b){return d(prefixes.join(a+";")+(b||""))}function f(a,b){return typeof a===b}function g(a,b){return!!~(""+a).indexOf(b)}function h(a,b){for(var d in a)if(p[a[d]]!==c)return b=="pfx"?a[d]:!0;return!1}function i(a,b,d){for(var e in a){var g=b[a[e]];if(g!==c)return d===!1?a[e]:f(g,"function")?g.bind(d||b):g}return!1}function j(a,b,c){var d=a.charAt(0).toUpperCase()+a.slice(1),e=(a+" "+t.join(d+" ")+d).split(" ");return f(b,"string")||f(b,"undefined")?h(e,b):(e=(a+" "+u.join(d+" ")+d).split(" "),i(e,b,c))}var k="2.6.0",l={},m=b.documentElement,n="modernizr",o=b.createElement(n),p=o.style,q,r={}.toString,s="Webkit Moz O ms",t=s.split(" "),u=s.toLowerCase().split(" "),v={},w={},x={},y=[],z=y.slice,A,B={}.hasOwnProperty,C;!f(B,"undefined")&&!f(B.call,"undefined")?C=function(a,b){return B.call(a,b)}:C=function(a,b){return b in a&&f(a.constructor.prototype[b],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;if(typeof b!="function")throw new TypeError;var c=z.call(arguments,1),d=function(){if(this instanceof d){var e=function(){};e.prototype=b.prototype;var f=new e,g=b.apply(f,c.concat(z.call(arguments)));return Object(g)===g?g:f}return b.apply(a,c.concat(z.call(arguments)))};return d}),v.cssanimations=function(){return j("animationName")},v.csstransitions=function(){return j("transition")};for(var D in v)C(v,D)&&(A=D.toLowerCase(),l[A]=v[D](),y.push((l[A]?"":"no-")+A));return l.addTest=function(a,b){if(typeof a=="object")for(var d in a)C(a,d)&&l.addTest(d,a[d]);else{a=a.toLowerCase();if(l[a]!==c)return l;b=typeof b=="function"?b():b,enableClasses&&(m.className+=" "+(b?"":"no-")+a),l[a]=b}return l},d(""),o=q=null,l._version=k,l._domPrefixes=u,l._cssomPrefixes=t,l.testProp=function(a){return h([a])},l.testAllProps=j,l}(this,this.document)}.apply(window)}})

ZY.ZUI.module({name:"jquery/doober",version:1,extend:"base",required:"jquery/easing",singleton:!0,constructor:function(a,b,c,d){a.need("$",function(b){ZYDoober=function(a,c,d,e){var f=function(a,c,d,e,f,g,h,i,j){var k=this;this.ieNoAlternate=!1,this.origin=c;var l=this.origin.x+d/2,m=this.origin.x+d;if(a.general===undefined){var n=a;a={},a.general=n}g===undefined&&(g=0),h===undefined&&(h="easeInOutQuad"),i===undefined&&(i.start=1,i.end=1),i.half=(i.end-i.start)/2+i.start,this.element=b(document.createElement("DIV")),this.element.addClass("shell"),this.element.css("left",this.origin.x+"px"),this.element.css("top",this.origin.y+"px"),this.inner=b(document.createElement("DIV"));var o=a.general;b.browser.msie===!0&&(a.ie===undefined?this.ieNoAlternate=!0:o=a.ie),this.inner.addClass(o),this.ieNoAlternate=!0,this.ieNoAlternate||this.inner.transform({scaleX:i.start,scaleY:i.start}),this.element.append(this.inner),a.adjust&&a.adjust(this.element);var p=.5,q=.5;h=="easeOutBounce"&&(p=.3,q=.6);var r={},s={};this.ieNoAlternate?(r.marginTop=-e,s.marginTop=g):(r.marginTop=-e,r.scaleX=i.half,r.scaleY=i.half,s.marginTop=g,s.scaleX=i.end,s.scaleY=i.end),this.inner.animate(r,f*p,"easeOutQuad").animate(s,f*q,h),this.element.animate({left:l},f/2,"easeInQuad").animate({left:m},f/2,"easeOutQuad",function(){j!==undefined&&j(k.element)})};f.prototype.attachedTo=function(a){b(a).append(this.element),this.element.css("position","absolute"),this.element.css("margin-left",-(this.inner.width()/2)+"px")};var g=function(a,c,d,e){var f=this;f.oncomplete=e,f.adjust=d,f.uid=a,f.core=b(a),f.hCenter=f.core.outerWidth()/2+(f.core.outerWidth(!0)-f.core.outerWidth()),f.vCenter=f.core.height()/2,f.coins={},f.coins.total=6,f.coins.displayed=f.coins.total,f.coins.spread=50,f.coins.interval=Math.round(f.coins.spread*2/f.coins.total),f.coins.distributed=0,f.coins.position=0,f.val=b(document.createElement("DIV")),b.browser.msie?f.val.addClass("numberIE"):f.val.addClass("number"),f.val.text(c)};return g.prototype.play=function(){var a=this;a.startAnimation()},g.prototype.startAnimation=function(){var a=this;a.direction=1;var c=function(){a.tossCoin()};for(var d=1;d<=a.coins.total/2;d++){var e=Math.round(Math.random()*50);setTimeout(c,(100+e)*d)}a.core.append(a.val),a.val.css("left",a.hCenter-a.val.width()/2+"px"),a.val.show(),a.val.css("z-index","900"),b.browser.msie?a.val.animate({top:-50},500,"easeOutBack").delay(500).fadeOut(250,function(){a.val.remove()}):(a.val.css("opacity","0"),a.val.animate({opacity:1,top:-50},500,"easeOutBack").delay(500).fadeOut(250,function(){a.val.remove()}))},g.prototype.tossCoin=function(){function d(b){a.killCoin(b)}var a=this,b=50+Math.round(Math.random()*20),c=13;for(var e=1;e<=2;e++){a.direction*=-1;var g=(a.coins.position+Math.floor(Math.random()*25)-0)*a.direction;a.coins.position+=a.coins.interval,(new f({general:"microCoin",ie:"microCoinIE",adjust:a.adjust},{x:a.hCenter,y:-10},g,b,1100,c,"easeOutBounce",{start:.25,end:1},d)).attachedTo(a.uid)}},g.prototype.killCoin=function(a){var b=this,c=Math.round(Math.random()*500),d=a.children().first();setTimeout(function(){d.animate({scaleX:2,scaleY:2,opacity:0},100,"easeOutQuad",function(){b.coins.displayed--,a.remove(),b.coins.displayed===0&&b.oncomplete&&b.oncomplete()})},c)},g}(),a.done("initialized")}),b({once:a.once})}})

ZY.ZUI.module({name:"widgets/zdc/common/dooberbutton",version:1,extend:"widgets/base",required:["widgets/button","jquery/doober","jquery/easing"],bubble:!0,themes:[""],constructor:function(a,b,c,d){var e=c.getInstance("widgets/button");c.getInstance("jquery/doober"),c.getInstance("jquery/easing"),a.declare("enabled","theme","size","color","label","customDooberImageUrl"),a.bind(e,["enabled","theme","size","color","label"]),a.bindStateToClass("size"),a.declareAndSet({animating:!1,t_content:'<div class="$$"></div>',enabled:!0,theme:"zdc",size:e.SIZE_TINY,color:e.COLOR_WHITE,label:a.localize("str_button_label"),animationComplete:!1}),a.bindStateToClass("animating"),a.createContent=function(b){a.need("$",function(c){var d=a.content=c(a.useTemplate("t_content"));a.addChild("button",e),e.getContent(function(b){a.$node("").append(b),a.done("button_created")}),e.wire("click",function(b){a.fire(b)}),e.wire("Changed:enabled",function(b){a.set("enabled",b.newValue)}),a.wire("Changed:enabled",function(a){e.set("enabled",a.newValue)}),a.once("button_created",function(){b(a.content)})})},b({SIZE_TINY:e.SIZE_TINY,SIZE_SMALL:e.SIZE_SMALL,SIZE_MEDIUM:e.SIZE_MEDIUM,SIZE_LARGE:e.SIZE_LARGE,SIZE_XLARGE:e.SIZE_XLARGE,COLOR_BLUE:e.COLOR_BLUE,COLOR_WHITE:e.COLOR_WHITE,startDooberAnimation:function(){a.set("animating",!0),a.need("$",function(b){var c,d=a.get("customDooberImageUrl");d&&(c=function(a){b(a).find(".microCoin").css("background-image","url('"+d+"')")});var e=new ZYDoober(a.$root(),"",c,function(){a.set("animating",!1),a.set("animationComplete",!0),a.done("animationComplete")});e.play()})}})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/rts/feedItem/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_gameboard_rts_feedItem_feedItem:{str_success:{original:"Claimed successfully!"},str_failure:{original:"Try another one."},str_defaultFailureMsg:{original:"Sorry this item can't be redeemed."},str_usedOneJolt:{original:"-1 Jolt"},str_joltNeeded:{original:"Jolt needed!"},str_dismiss:{original:"Dismiss"}}})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/rts/feedItem",version:1,extend:"widgets/listitem",required:["widgets/zdc/common/dooberbutton","widgets/zdc/common/avatar","widgets/zdc/common/rail/tab/chat/prettydate","widgets/zdc/common/tooltip","widgets/zdc/services/user","widgets/zdc/services/locales","widgets/zdc/services/graph","jquery/transform","modernizr"],themes:[""],localized:!0,metadata:{id:[0,Infinity],feedType:[undefined,"public","neighbor"],azid:[0,Infinity],showCTA:[undefined,!0,!1],desc:/.*/,cta:/.*/,timesAgo:/.*/,ownFeed:[undefined,!0,!1],href:/.*/},constructor:function(a,b,c,d){function v(){a.once("feedItem.animateOutComplete",function(){a.fire({name:"dismissFeedItem",item:a.get("dispId"),bubble:!0})}),a.set("animateOut",!0)}function w(){var b=a.get("giftSendMessage"),d=a.get("shortMessage");a.once("feedItem.cta_rendered",function(){i&&i.hide(),h.removeContent()}),c.require("widgets/zdc/common/helpicon",function(){var e=c.getInstance("widgets/zdc/common/helpicon"),f="",g=[];e.getContent(function(c){a.$node("content").append(a.useTemplate("t_successMessage"));var h=a.$node("successErrorTooltip");if(a.get("error")){b=b||a.localize("str_defaultFailureMsg"),d=d||a.localize("str_failure");if(b.length>r||b.length<d.length)b=d;a.$node("successMessage").html(d).fadeIn(j),a.$node("successMessage").addClass("error")}else d=d||a.localize("str_success"),a.$node("successMessage").html(d).fadeIn(j);f='<div class="settings-tipsy">'+b+"</div>",g.push(f),e.set({gravity:"se",lineSpacing:5,tooltipSubHeaders:g}),h.append(c)})})}function x(){a.once("feedItem.content_rendered",function(){var b=a.get("giftSendMessage"),c=a.get("shortMessage");a.get("error")?(b=b||a.localize("str_defaultFailureMsg"),c=c||a.localize("str_failure")):c=c||a.localize("str_success"),b.length>r&&(b=c);var d=a.get("error")?a.$node("entry"):a.$node("description");d=a.$node("entry"),d.after(a.useTemplate("t_responseFade"));var e=a.$node("response");a.$node("responseMessage").html(b),e.height(d.height()),d.fadeTo(k,0),e.fadeTo(k,1)})}function y(){a.once("feedItem.cta_rendered",function(){i&&i.hide(),h.removeContent()}),a.$node("content").append(a.useTemplate("t_responseMessage"));var b=a.get("shortMessage");a.get("error")?(b=b||a.localize("str_failure"),a.$node("successMessage").addClass("error")):b=b||a.localize("str_success"),a.$node("successMessage").html(b).fadeIn(j)}function z(){a.get("deleteOnComplete")?a.set("showDismiss",!0):a.get("newFadeUX")?y():w(),a.fire("ctaMessageDisplayed")}function A(){a.$root().closest(".zui_zdc_gameboard_rts_rtsList_itemSlot").remove()}function B(b,d,e){var f={zid:b,size:"medium-zdc",miniprofile:!0,gravity:"sw",thumbnail:d.profilePicThumb,displayName:d.firstName+" "+d.lastName},g=a.addChild("zui_sidebar_rtsadapter_avatar_"+b,"widgets/zdc/common/avatar",f);a.done("feedItem.id_ready");var h=e(a.useTemplate("t_feedItem",{authorName:d.firstName+" "+d.lastName,description:a.get("desc")}));a.$root().append(h).attr("feed-id",a.get("id")),d.snId==1&&a.$node("author_name").addClass("disabled");if(a.get("feedType")!="public"){var i=Math.round(c.now()/1e3),j=a.get("ts"),k=j;a.get("timesAgo")&&(k=a.get("timesAgo")),a.$node("description").after(a.useTemplate("t_timestamp",{timestamp:j,timeAgo:k}));if(j){var l=a.addChild("feedItem"+j,"widgets/zdc/common/rail/tab/chat/prettydate",{date:j*1e3});l.getContent(function(b){a.$node("timestamp").html(b)})}}g.getContent(function(b){a.$node("picture_wrapper").html(b),a.done("feedItem.avatar_rendered")}),a.wire("avatarClick",function(b){a.fire({name:"rts_feedItem_avatarClick",feedType:a.get("feedType"),fbid:b.fbid,bubble:!0})}),a.wire("userNameClick",function(b){a.fire({name:"rts_feedItem_userNameClick",feedType:a.get("feedType"),zid:b.zid,bubble:!0})}),a.done("feedItem.content_rendered")}function C(b){var c=b.x||b.clientX,d=b.y||b.clientY;!b.isTrigger&&c&&c==t&&d&&d==u&&a.done("c")}function D(b){a.once("c",function(){if(a.get("showDismiss")){v(),a.fire({name:"rts_feedItem_dismiss_click"});return}a.fire({name:"rts_feedItem_CTA_click",feedType:a.get("feedType"),href:a.get("href"),age:a.get("ts"),selfRef:a,original:b,bubble:!0})})}a.declare("animate","animateOut","azid","id","cached","cta","desc","doober","href","img","locale","title","ts","timesAgo","showCTA","ownFeed","helpers","giftSendMessage","shortMessage","feedType","showDismiss","statusMessage","error","success","newFadeUX","deleteOnComplete","dispId","dispTs","state","str_success","str_failure","str_defaultFailureMsg","str_dismiss"),a.bindStateToClass("ownFeed","own"),a.bindStateToClass("deleteOnComplete","delComp"),a.bindStateToClass("success","success");var e=c.getInstance("widgets/zdc/services/user"),f=c.getInstance("widgets/zdc/services/locales"),g=c.getInstance("widgets/zdc/services/graph"),h,i=null,j=500,k=1e3,l={type:"easeOutQuad",interval:1e3},m={type:"easeOutQuad",interval:600},n=a.nodeClass("animating"),o=a.nodeClass("cssTransition"),p=c.getConstructor("modernizr"),q=!1,r=400,s=0,t,u;c.getInstance("jquery/transform"),a.declareAndSet({mirror:!1,t_content:'<div class="$$" />',t_feedItem:'<div class="$item$"><div class="$entry$"><div class="$picture_wrapper$"></div><div class="$content$"><a href="#" onclick="return false" class="$author_name$">%authorName%</a><div class="$feed_content$"><div class="$feed_text$"><div class="$description$">%description%</div></div></div></div></div><div class="$ctadiv$"/></div>',t_timestamp:'<div class="$timestamp$" name="%timestamp%">%timeAgo%</div>',t_feedImage:'<img class="$image$" src="%imgSrc%">',t_successMessage:'<div class="$message_container$ zui-clearfix"><div class="$successMessage$"></div><div class="$successErrorTooltip$"></div></div>',t_responseMessage:'<div class="$message_container$ zui-clearfix"><div class="$successMessage$"></div></div>',t_responseFade:'<div class="$response$"><div class="$responseMessage$"></div></div>'}),a.bindStateToContent("giftSendMessage",function(){a.get("newFadeUX")&&x(),s&&a.get("deleteOnComplete")&&setTimeout(v,s),a.once("feedItem.cta_rendered",function(){a.get("cached")?z():a.get("error")?(a.fire({name:"rts_feedItem_cta_error",feedType:a.get("feedType"),age:a.get("ts"),bubble:!0}),z()):(a.get("feedType")==="public"&&a.fire({name:"successfulPublicFeedClick",href:a.get("href"),bubble:!0}),a.set("success",!0),h.once("animationComplete",z),h.startDooberAnimation())})}),a.bindStateToContent("animate",function(b){var c=["feedItem.content_rendered","feedItem.avatar_rendered"];a.get("img")&&c.push("feedItem.img_rendered"),a.get("showCTA")&&c.push("feedItem.cta_rendered"),a.once(c,function(){var c=a.$root(),d=c.parent();if(b){var e=c.outerHeight();d.addClass(n),!q||!p.csstransitions?d.animate({height:e},l.interval,l.type,function(){d.removeClass(n),d.height("auto")}):(d.addClass(o),d.css({height:e}),setTimeout(function(){d.removeClass(o),d.removeClass(n),d.height("auto")},l.interval))}else d.height("auto");a.fire({name:"rts_feedItem_view",feedType:a.get("feedType"),bubble:!0})})}),a.bindStateToContent("animateOut",function(b,c){if(b===!0){var d=a.$root(),e=d.outerHeight();d.css({position:"relative"}),d.animate({top:-e,"margin-bottom":-e},m.interval,m.type,function(){a.done("feedItem.animateOutComplete")})}else b===!1&&a.done("feedItem.animateOutComplete")}),a.bindStateToContent("img",function(b){a.once("feedItem.content_rendered",function(){window.ZY&&ZY.Util&&(b=ZY.Util.getSecureUrl(b)),a.$node("feed_content").addClass("zy-has-image").prepend(a.useTemplate("t_feedImage",{imgSrc:b})),a.done("feedItem.img_rendered")})}),a.bindStateToContent("helpers",function(b,c){if(b.length){var d=b[0],f;e.getUserDataNonCached({uids:d},function(b){if(b){var e={size:"tiny",miniprofile:!1,zid:d,gravity:"sw"};f=a.addChild("helper_avatar_"+d,"widgets/zdc/common/avatar",e),f.getContent(function(b){c(b).appendTo(a.$node("content")).css("margin-left","200px").transform({origin:["left","bottom"]}).animate({"margin-left":0},"linear",function(){c(this).animate({rotate:-5},100,function(){c(this).animate({rotate:0},300)})})})}})}}),a.bindStateToContent("id",function(b,c){var d=a.get("feedType"),f=a.get("azid").toString();d=="public"?e.getUserDataNonCached({uids:f,attributes:["firstName","lastName","profilePicThumb"]},function(a){a?B(f,a,c):A()}):d=="neighbor"&&g.getInfoForZid({zid:f},function(a){a?B(f,a,c):A()})}),a.bindStateToContent("showDismiss",function(b,c){if(b){var d=a.localize("str_dismiss");h||a.set({cta:d,showCTA:!0}),a.once("feedItem.cta_rendered",function(){h.set({enabled:!0,label:d})})}}),a.bindStateToContent("ownFeed",function(b,c){b&&(a.set("helpers",[]),a.get("deleteOnComplete")&&a.set("showDismiss",!0))}),a.bindStateToContent("showCTA",function(b,c){a.once("feedItem.content_rendered",function(){b&&a.get("cta")&&!h&&(h=a.addChild("ctaButton","widgets/zdc/common/dooberbutton",{theme:"zdc",color:"white",size:"tiny",label:a.get("cta"),enabled:!0,customDooberImageUrl:a.get("doober")}),h.getContent(function(b){a.$node("ctadiv").append(b),a.children.ctaButton.button.rawClick(C),a.children.ctaButton.wire("click",D),c(b).mousemove(function(a){t=a.originalEvent.x||a.originalEvent.clientX,u=a.originalEvent.y||a.originalEvent.clientY})}),a.done("feedItem.cta_rendered"))})}),a.bindStateToClass("mirror"),a.bindStateToContent("mirror",function(b,c){a.$root().attr("dir",b?"rtl":"ltr")}),a.onStateChange("locale",function(){a.set("mirror",f.isMirroredLanguage(a.get("locale")))}),a.once("feedItem.content_rendered",function(){if(a.$node("author_name").hasClass("disabled"))return;a.$node("author_name").click(function(){a.fire({name:"userNameClick",zid:a.get("azid"),bubble:!0})})}),a.createContent=function(b){a.need("$",function(c){var d=c(a.useTemplate("t_content"));b(d)})},b({resetCta:function(){a.children.ctaButton.set("enabled",!0)},getFeedId:function(b){var c=b||function(){};a.once("feedItem.id_ready",function(){c(a.get("id"))})},getActorZidAndImageUrl:function(b){var c=b||function(){};a.once("feedItem.id_ready",function(){c({azid:a.get("azid"),imgUrl:a.get("img"),href:a.get("href")})})}})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/rts/feedXpromo/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_gameboard_rts_feedXpromo_feedXpromo:{str_play_game:{original:"Play {gamename}"},str_message:{original:"Play {gamename} with your zFriends and get 1 extra Jolt!"},str_zero_title:{original:"Out of Jolts!"},str_zero_message:{original:"Keep an eye on your Jolt meter to see when you have more to use."},str_play_game_v2:{original:"Play Now!"},str_message_v2:{original:"Find hidden objects, speak to spirits and solve murders in this supernatural crime thriller!"},str_zero_title_v2:{original:"Out of Jolts!"},str_zero_message_v2:{original:"Keep an eye on your Jolt meter to see when you have more to use."},str_header:{original:"Play the Best Hidden Objects game!"}}})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/rts/feedXpromo",version:1,extend:"widgets/base",required:["widgets/button"],themes:[""],localized:!0,constructor:function(a,b,c,d){function i(b){a.track({counter:"Right_rail_xpromo_"+b,kingdom:a.get("xpromo"),phylum:a.get("phylum"),"class":a.get("expVersion"),genus:a.get("xpromoSampleId")})}function j(){a.get("zero")&&a.once("content_rendered",function(){a.need("$",function(b){a.$node("zerodiv").delay(g).animate({opacity:0},h,function(){a.set("zero",!1)})})})}a.declare("alias","xpromo","feedType","game_id","dispId","dispTs","name","message","header","expire","label","zero","str_zero_title_v2","str_zero_message_v2","str_message_v2","str_play_game_v2","str_header","visible","widgetClass","phylum","expVersion","xpromoSampleId","ts","data");var e,f={type:"easeOutQuad",interval:1e3},g=5e3,h=1e3;a.declareAndSet({animate:!1,promoType:"t_xpromo",t_content:'<div class="$$"><div class="$zerodiv$"><div class="$zerotitle$">%str_zero_title_v2%</div><div class="$zeromessage$">%str_zero_message_v2%</div></div></div>',t_xpromo:'<div class="$$"><div class="$wrapper$"><div class="$header$">%header% </div><div class="$background$"></div><div class="$message$">%message%</div><div class="$cta$"/></div></div>',t_xpromo_v2:'<div class="$$"><div class="$background_v2$"><div class="$cta_v2$"/></div></div>'}),a.bindStateToClass("alias"),a.bindStateToClass("zero"),a.bindStateToContent("xpromo",function(b,c){var d=a.get("promoType");a.set("label",a.localize("str_play_game_v2",{gamename:name}));var e=a.addChild("ctaButton","widgets/button",{theme:"zdc",color:"blue",size:"small",label:a.get("label"),enabled:!0});e.getContent(function(b){d=="t_xpromo_v2"?a.$node("cta_v2").append(b):a.$node("cta").append(b),a.children.ctaButton.wire("click",function(){i("click"),a.fire({name:"rts_feedXpromo_cta_click",alias:a.get("alias"),gameId:a.get("xpromo"),bubble:!0}),ZY.ZDCPageNavigator.launchGame(a.get("xpromo"),null,null)})}),setTimeout(function(){a.done("content_rendered")},1e3),j()}),a.bindStateToContent("data",function(b){var c="url("+b.image+")";a.get("promoType")=="t_xpromo"&&(a.$node("background").css("background-image",c),a.$node("header").text(b.header),a.$node("message").text(b.message)),a.get("promoType")=="t_xpromo_v2"&&a.$node("background_v2").css("background-image",c)}),a.bindStateToContent("animate",function(){a.once("content_rendered",function(){var b=a.$root(),c=b.parent(),d=b.outerHeight();c.addClass("animating"),c.animate({height:d},f.interval,f.type,function(){c.removeClass("animating"),c.height("auto"),i("view")})})}),a.createContent=function(b){a.need("$",function(c){var d=c(a.useTemplate(a.get("promoType")));b(d)})},b({})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/rts/rtsList",version:1,extend:"widgets/list",required:["jquery/mousewheel","widgets/zdc/gameboard/rts/feedItem","widgets/zdc/gameboard/rts/feedAd","widgets/zdc/gameboard/rts/feedXpromo","widgets/zdc/services/gameboard","widgets/zdc/services/feeds"],themes:[""],constructor:function(a,b,c,d){function p(b,d){var f=c.now(),h=a.get("items")||[];b.feedType=o,b.animate=a.get("active")&&h.length>=j,b.dispTs=f+d+e,b.dispId=e++,g.handleFeedQueue({source:b}),h.length?a.addItem(b):a.set("items",[b])}function q(b){if(b&&b.length){var d=c.now(),f=a.get("items")||[];for(var h=0;h<b.length;h++)b[h].feedType=o,b[h].animate=!1,b[h].dispTs=d+e,b[h].dispId=e++,g.handleFeedQueue({source:b[h]});if(f.length)for(var h=0;h<b.length;h++)a.addItem(b[h]);else a.set("items",b)}}function r(b){a.removeItem(b.item)}function s(){if(h.length&&!a.get("tickerPaused")){var b=h.shift();p(b,0)}}function t(){!i&&h.length&&(s(),i=setInterval(s,k))}function u(a){h.push(a),t()}function v(){h=[]}function w(){clearInterval(i),i=null}function x(){t()}function y(){h=[],a.removeItems()}function z(b){var c=b.feedItem,d=0;c.feedType=a.get("feedType"),c.animate=!0,c.expire&&(d=c.expire+k),p(c,d)}var e=0,f=c.getInstance("widgets/zdc/services/gameboard"),g=c.getInstance("widgets/zdc/services/feeds"),h=[],i=null,j,k,l=0,m=0,n=c.getInstance("jquery/mousewheel"),o;a.declare("feedType","active"),a.declareAndSet({tickerPaused:!1,newFadeUX:"newFadeUX"}),a.set({sort:"dispTs<",active:!1,lazyLoadViewPortPadding:10,lazyLoadInterval:Infinity}),a.bindStateToClass("active"),a.bindStateToContent("active",function(b){a.set("lazyLoadInterval",b?1e3:Infinity)}),a.bindStateToClass("newFadeUX"),f.wire("gameboard.awake",x),f.wire("gameboard.asleep",w),a.bindStateToContent("feedType",function(b){var c;o=b,g.fireWire({name:"discardFeeds."+b,callback:y}),g.fireWire({name:"immediateFeed."+b,callback:z});var d=g.getOpts({type:b});a.set("maxItems",c=d[0]),j=d[1]||c,k=d[2]*1e3,a.set("newFadeUX",d[3]?"newFadeUX":""),g.fireWire({name:"newFeeds."+b,callback:function(b){var c=b.feedItems,d=a.get("items")||[],e=j-d.length;e>0&&q(c.splice(0,e)),c.length&&(h=c,t()),l&&(a.fire({name:"rts_feedItems_view",feedType:o,value:l,bubble:!0}),l=0),m&&(a.fire({name:"rts_feedAds_view",feedType:o,value:m,bubble:!0}),m=0)}})}),a.wire("dismissFeedItem",r),a.wire("rts_feedItem_CTA_click",function(b){a.get("tickerPaused")&&g.handleFeedClick(b)}),a.wire("rts_feedItem_view",function(a){g.handleFeedView(a),l++,a.bubble=!1}),a.wire("rts_feedAd_view",function(a){m++,a.bubble=!1}),a.makeItemWidgetClass=function(a){return a.hasOwnProperty("widgetClass")?a.widgetClass:"widgets/zdc/gameboard/rts/feedItem"},a.makeItemWidgetName=function(a){return a.dispId},a.getItemsData=function(a){},a.once("content",function(){n.once("initialized",function(){a.need("$",function(b){n.containScrollWheel(a.$node(""))})})})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/rts/rtsNeighborList/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_gameboard_rts_rtsNeighborList_rtsNeighborList:{str_emptyStateTitle:{original:"Help your zFriends as you would like them to help you!"},str_emptyStateBody:{original:"Your zFriends have not posted any feeds yet. Get them moving by sending them a gift!"},str_emptyStateTitle_noFriends:{original:"More zFriends, More Help!"},str_emptyStateCta:{original:"Select Free Gift"},str_emptyStateCta_noFriends:{original:"Invite Friends"}}})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/rts/rtsNeighborList",version:1,extend:"widgets/zdc/gameboard/rts/rtsList",required:["widgets/facepile","widgets/button"],themes:[""],localized:!0,constructor:function(a,b,c,d){var e;a.set("feedType","neighbor"),a.declare("emptyStateData","emptyStateCtaCallback","str_emptyStateTitle","str_emptyStateBody","str_emptyStateTitle_noFriends","str_emptyStateCta","str_emptyStateCta_noFriends"),a.declareAndSet({t_emptyState:'<div class="$empty_state$"><div class="$empty_state_title$">%str_emptyStateTitle%</div><div class="$empty_state_body$">%str_emptyStateBody%</div><div class="$empty_state_facepile$" /><div class="$empty_state_button_wrapper$" /></div>',t_emptyState_noFriends:'<div class="$empty_state$"><div class="$empty_state_title$">%str_emptyStateTitle_noFriends%</div><div class="$empty_state_button_wrapper$" /></div>'}),a.bindStateToContent("emptyStateCtaCallback",function(){a.once("emptyStateCtnt",function(){var b=a.get("emptyStateData");if(e&&b){a.addChild("emptyStateBtn","widgets/button");var c=b.hasFriends?a.localize("str_emptyStateCta"):a.localize("str_emptyStateCta_noFriends");a.children.emptyStateBtn.set({theme:"zdc",color:"white",size:"medium",label:c,multiple_use:!0}),a.children.emptyStateBtn.getContent(function(b){e.find("."+a.nodeClass("empty_state_button_wrapper")).append(b)}),a.children.emptyStateBtn.wire("click",function(){var b=a.get("emptyStateCtaCallback");b()})}})}),a.createEmptyMessage=function(b){a.need("$",function(c){var d=a.get("emptyStateData");if(d.hasFriends){e=c(a.useTemplate("t_emptyState")),a.addChild("facepile","widgets/facepile"),a.children.facepile.set("columns",d.columns),a.children.facepile.set("max_display",d.maxDisplay),a.children.facepile.set("avatar_size","small");for(var f=0;f<d.friends.length;f++)a.children.facepile.addUser({zid:d.friends[f].zid,fbid:d.friends[f].fbid});a.children.facepile.getContent(function(b){e.find("."+a.nodeClass("empty_state_facepile")).append(b)})}else e=c(a.useTemplate("t_emptyState_noFriends"));b(e),a.done("emptyStateCtnt")})},b({})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/rts/rtsPublicList/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_gameboard_rts_rtsPublicList_rtsPublicList:{str_empty_state_help:{original:"Nice! You helped your zFriends."},str_empty_state_watch:{original:"Keep your eyes open for more requests."}}})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/rts/rtsPublicList",version:1,extend:"widgets/zdc/gameboard/rts/rtsList",themes:[""],localized:!0,constructor:function(a,b,c,d){a.set("feedType","public"),a.declare("str_empty_state_help","str_empty_state_watch"),a.declareAndSet({t_emptyState:'<div class="$empty_state$">%str_empty_state_help%<div>%str_empty_state_watch%</div></div>'}),a.createEmptyMessage=function(b){a.need("$",function(c){var d=c(a.useTemplate("t_emptyState"));b(d)})}}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/rts/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_gameboard_rts_rts:{str_everybody:{original:"Everybody"},str_neighbors:{original:"My zFriends"},str_loading_title:{original:"One Sec."},str_loading_message1:{original:"We're gathering all of your info together to give you the best gaming experience."},str_loading_message2:{original:"We're getting everything just right for you so you have a really good time."},str_loading_message3:{original:"We're getting our game face on."},str_loading_message4:{original:"We're spiffing up the joint."},str_loading_message5:{original:"We're getting decent."},str_adsHeader:{original:"Advertisements"}}})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/rts",version:1,extend:"widgets/base",required:["widgets/zdc/gameboard/rts/rtsPublicList","widgets/zdc/gameboard/rts/rtsNeighborList"],themes:[""],localized:!0,constructor:function(a,b,c,d){function f(b,c){var d=c?"click":"view";switch(b){case"publicList":a.track(["ZDC_gameboard","rts","everyone_tab","",d]);break;case"neighborList":a.track(["ZDC_gameboard","rts","zfriends_tab","",d])}d=="click"&&a.fire({name:"rts_tab_click",rtsList:b,bubble:!0})}function g(b,c){a.children[b].set("active",!0),a.done("activeTabSet"),f(b,c)}function h(a,b){var c=e.tabs,d=e.selectedTab;if(!a||!a.length||!b)return!1;if(!c||!d||a.length!=c.length||b!=d)return!0;for(var f=0,g=a.length;f<g;f++)if(a[f]!=c[f])return!0;return!1}function i(){a.$node("viewport").hover(function(){a.children.publicList.set("tickerPaused",!0),a.children.neighborList.set("tickerPaused",!0)},function(){a.children.publicList.set("tickerPaused",!1),a.children.neighborList.set("tickerPaused",!1)})}var e={};a.declare("useTabs","emptyStateData","emptyStateCtaCallback","str_everybody","str_neighbors"),a.bindStateToContent("useTabs",function(a){var b=a.tabs,c=a.selectedTab;h(b,c)&&(e=a,g(c,!0)),g(c,!1)}),a.bindStateToContent("emptyStateCtaCallback",function(b){a.once(["neighborList"],function(){a.children.neighborList.set("emptyStateCtaCallback",b)})}),a.declareAndSet({t_content:'<div class="$$"><div class="$viewport$"></div></div>'}),a.createContent=function(b){a.need("$",function(c){var d=a.content=c(a.useTemplate("t_content"));a.addChild("publicList","widgets/zdc/gameboard/rts/rtsPublicList"),a.children.publicList.getContent(function(b){a.$node("viewport").append(b),a.done("publicList")}),a.addChild("neighborList","widgets/zdc/gameboard/rts/rtsNeighborList"),a.children.neighborList.set("emptyStateData",a.get("emptyStateData")),a.children.neighborList.getContent(function(b){c(b).addClass(a.nodeClass("rtsList")),a.$node("viewport").append(b),a.done("neighborList")}),i(),a.once(["publicList","neighborList"],function(){b(d),a.track(["ZDC_gameboard","rts"])})})},b({publicNeighborToggle:function(b){a.once(["publicList","neighborList"],function(){var c=b=="publicList"?"neighborList":"publicList";a.children[c].set("active",!1),a.children[b].set("active",!0),f(b,!0)})},toggleButtonsRendered:function(a){for(var b=0;b<a.length;b++)f(a[b],!1)}})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tab/gameActivity",version:1,extend:"widgets/zdc/common/rail/tab",required:["widgets/zdc/gameboard/rts","widgets/zdc/services/gameboard","widgets/zdc/services/game","widgets/zdc/services/helpfulness","widgets/zdc/gameboard/helpfulness/controller","widgets/zdc/common/togglebuttons"],themes:[""],localized:!0,constructor:function(a,b,c,d){function q(){a.once("content",function(){a.$node("helpers").css("height",m),a.$node("rts").css("top",m)})}function r(){a.once("content",function(){a.$node("helpers").css("height",l),a.$node("rts").css("top",l)})}var e=c.getInstance("widgets/zdc/gameboard/rts"),f=c.getInstance("widgets/zdc/gameboard/helpfulness/controller"),g=c.getInstance("widgets/zdc/services/helpfulness"),h=c.getInstance("widgets/zdc/services/gameboard"),i=c.getInstance("widgets/zdc/services/game"),j=c.getInstance("widgets/zdc/common/togglebuttons"),k={tabs:["publicList","neighborList"],selectedTab:"publicList"},l=30,m=210,n=h.getComponentOpts(),o=n?n.helperScoreEnabled:!0;a.addChild("rts",e),a.addChild("helpers",f);var p={columns:4,friends:{40000007166:"1305011287",40100002352:"538606525",40100062768:"814230018",40100172667:"4808675",40100173647:"1352403381",40101586550:"100001628365162",40101762352:"100002852403144",40102248903:"100003153235317"},hasFriends:!0,maxDisplay:8};e.set("emptyStateData",p),e.set("useTabs",k),a.declare("str_streamTitle","str_everybody","str_neighbors","showHelpers","railOpts"),a.declareAndSet({t_body:'<div class="$toggle_buttons$"></div><div class="$helpers$" /><div class="$rts$" />',t_heading:'<div class="$label$">%str_streamTitle%</div>'}),a.once("content",function(){j.getContent(function(b){a.$node("toggle_buttons").append(b)}),j.wire("toggleButtonsChanged",function(a){var b=a.selected;e.publicNeighborToggle(k.tabs[b])})}),f.wire({helpersToggled:function(a){f.get("expanded")?q():r()}}),a.bindStateToClass("showHelpers"),a.bindStateToContent("railOpts",function(b){a.once("content",function(){var c=[],d=1;b.everybody&&(c.push(a.localize("str_everybody")),d=0),b.zfriends&&c.push(a.localize("str_neighbors")),j.set({buttons:c,selected:0}),e.toggleButtonsRendered(k.tabs),e.publicNeighborToggle(k.tabs[d]),a.set("showHelpers",b.helpers&&o)})}),a.createContent=function(b){a.need("$",function(c){a.content=c(a.useTemplate("t_content")),a.$node("body").html(a.useTemplate("t_body")),a.$node("heading").html(a.useTemplate("t_heading")),a.once(["helpersContent"],function(){b(a.content)}),o?f.getContent(function(b){a.$node("helpers").append(b),a.done("helpersContent")}):a.done("helpersContent"),e.getContent(function(b){a.$node("rts").append(b),a.done("rtsContent")})})},b({})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tab/guides/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_common_rail_tab_guides_guides:{str_search_result_count:{original:"{num} results found"},str_placeholder:{original:"Search for Guides, News etc."},str_searchError:{original:"Oops, Something went wrong. Try again !!!"},str_initialError:{original:"Oops, Something went wrong."},str_rateLimit:{original:"You've exceeded the maximum search limit"}}})}})

ZY.ZUI.module({name:"widgets/zdc/game/rightRailExcerptList/rightRailExcerpt",version:1,extend:"widgets/base",themes:[""],localized:!1,required:[],constructor:function(a,b,c,d){a.declare("data"),a.declareAndSet({t_content:'<a class="$$ $main$ zui_clearfix"><div class="$screenshot$"><div class="$image$"></div></div><div class="details"><div class="about"><div class="$title$"></div><div class="$info$"></div></div></div></a><div class="$loweEdge$"></div>'}),a.bindStateToContent("data",function(b){a.$node("title").html(b.title),a.$node("info").html(b.excerpt),a.$node("image").css("background-image","url("+b.thumbnail+")")}),a.createContent=function(b){a.need("$",function(c){a.content=c(a.useTemplate("t_content")),b(a.content)})},a.once("content",function(){a.$node().click(function(){a.fire({name:"excerpt_click",bubble:!0,postId:a.get("data").post_id})})}),b({})}})

ZY.ZUI.module({name:"widgets/zdc/game/rightRailExcerptList",version:1,extend:"widgets/base",themes:[""],localized:!1,required:["widgets/zdc/game/rightRailExcerptList/rightRailExcerpt"],constructor:function(a,b,c,d){function f(){a.$node().unbind("scroll"),a.fire({name:"scroll_trigger",bubble:!0})}function g(){function b(){var b=a.$node("items").children().last().position().top;return b}var c=b();a.$node().scroll(function(){a.$node().scrollTop()>=c-a.$node().height()-120&&f()})}function h(b){if(b&&!d.isEmpty(b)){for(var c=0;c<b.length;c++){var f=a.addChild("item_"+c,"widgets/zdc/game/rightRailExcerptList/rightRailExcerpt");f.set("data",b[c]),f.getContent(function(b){a.$node("items").append(b)}),e++}g()}}var e=0;a.declare("items"),a.declareAndSet({t_content:'<div class="$$ zui_clearfix"><div class="$items$ zui_clearfix"></div></div>'}),a.bindStateToContent("items",function(b){if(b&&!d.isEmpty(b)){a.$node("items").empty(),a.$node("items").scrollTop(0);for(var c=0;c<b.length;c++){var f=a.addChild("item_"+e,"widgets/zdc/game/rightRailExcerptList/rightRailExcerpt");f.set("data",b[c]),f.getContent(function(b){a.$node("items").append(b)}),e++}g()}}),a.createContent=function(b){a.need("$",function(c){a.content=c(a.useTemplate("t_content")),b(a.content)})},a.once("content",function(){}),b({appendItems:h})}})

ZY.ZUI.module({name:"widgets/zdc/game/rightRailExcerptList/rightRailPost/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_game_rightRailExcerptList_rightRailPost_rightRailPost:[]})}})

ZY.ZUI.module({name:"widgets/zdc/game/rightRailExcerptList/rightRailPost",version:1,extend:"widgets/modaldialog",themes:[""],localized:!0,required:[],constructor:function(a,b,c,d){a.declare("data"),a.declareAndSet({t_content1:'<div class="$post$"><h2 class="$title$"></h2><div class="$post_content$"></div></div>'}),a.createDialogContent=function(b){b(a.useTemplate("t_content1"))},a.bindStateToContent("data",function(b){a.$node("post_content").empty(),a.$node("post_content").append(b.content),a.$node("title").text(b.title)}),a.once("content",function(){}),b({})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tab/guides",version:1,extend:"widgets/base",themes:[""],localized:!0,required:["widgets/zdc/game/rightRailExcerptList","widgets/zdc/game/rightRailExcerptList/rightRailPost"],constructor:function(a,b,c,d){var e=c.getInstance("widgets/zdc/services/game"),f,g,h,i,j,k=0,l=!1;a.declare("gameId","str_search_result_count","str_placeholder","str_initialError","str_searchError","str_rateLimit"),a.declareAndSet({t_content:'<div class="$$" style="height: 100%;"><div class="$search$" style="width:100%;"><div class="$searchBox$"><input type="text" class="$searchText$" placeholder=""><div class="$crossInput$" title="close" alt="close"></div><div class="$searchIcon$"></div> </div></div><div class="$searchResultNumber$" style="display:none;" ></div><div class="$errorInSearch$" style="display:none;" >%str_initialError%</div><div class="$searchList$" style="height: 100%;display: none;"></div><div class="$excerptList$" style="height: 100%;"></div><div class="$popUp$ excerptPopUp"><div class="$overlay$"></div><div class="$closePopUp$ excerptClosePopUp"></div><div class="$popUpContent$"><div></div></div></div></div>'}),a.createContent=function(b){a.need("$",function(c){a.content=$(a.useTemplate("t_content")),b(a.content)})},a.bindStateToContent("gameId",function(b){e.fetch({gids:b},function(b){f=b.alias,e.getCategoryData({alias:b.alias,pageNumber:0,MainGLP:!1,categoryName:"guides"},function(b){b.excerpts&&!d.isEmpty(b.excerpts)?(l=!1,g||(g=a.addChild("DefaultExcerptList","widgets/zdc/game/rightRailExcerptList")),g.set({items:b.excerpts}),g.getContent(function(b){a.$node("excerptList").empty(),a.$node("excerptList").append(b)}),a.$node("errorInSearch").css("display","none")):a.$node("errorInSearch").css("display","block")})})}),a.once("content",function(){function c(){j=a.$node("searchText").val().trim();if(!j)return;h&&a.removeChild("_searchExcerptList"),e.getSearchResultsRightRail({keyword:j,start_value:0,alias:f},function(b){b.hasOwnProperty("e")&&b.e==1?(a.$node("errorInSearch").text(a.localize("str_searchError")).css("display","block"),a.$node("excerptList").addClass("topPaddingInc")):b.hasOwnProperty("e")&&b.e==601?(a.$node("errorInSearch").text(a.localize("str_rateLimit")).css("display","block"),a.$node("excerptList").addClass("topPaddingInc")):(window&&window._gaq&&window._gaq.push(["_trackEvent","RightRail","Search",f]),l=!0,k=b.data.length,a.$node("searchResultNumber").empty(),a.$node("searchResultNumber").text(a.localize("str_search_result_count",{num:b.count})),a.$node("searchResultNumber").show(),h=a.addChild("SearchExcerptList","widgets/zdc/game/rightRailExcerptList"),h.set({items:b.data}),h.getContent(function(b){a.$node("searchList").empty(),a.$node("searchList").append(b)}),a.$node("errorInSearch").css("display","none"),a.$node("searchList").css("display","block"),a.$node("excerptList").removeClass("topPaddingInc"),a.$node("excerptList").css("display","none"))})}a.$node("searchIcon").click(function(){c()});var b=a.localize("str_placeholder");a.$node("searchText").attr("placeholder",b),a.$node("searchText").keyup(function(a){a.which=a.which||a.keyCode,a.which==13&&c()}),a.$node("searchText").keyup(function(){$(this).val()!=""?a.$node("crossInput").css("display","block"):(a.$node("crossInput").css("display","none"),a.$node("searchList").css("display","none"),a.$node("searchResultNumber").text(""),a.$node("excerptList").css("display","block"))}),a.$node("crossInput").click(function(){a.$node("searchText").val(""),a.$node("searchList").css("display","none"),a.$node("excerptList").css("display","block"),a.$node("searchResultNumber").text(""),$(this).css("display","none")}),a.wire("scroll_trigger",function(){l&&e.getSearchResultsRightRail({keyword:j,start_value:k,alias:f},function(a){k+=a.data.length,h.appendItems(a.data)})}),a.wire("excerpt_click",function(b){e.getArticleData({alias:f,postId:b.postId},function(c){var d=c.post.content+'<p style="padding-top:10px;font-size: 18px;font-weight:bold;">For feedback/commenting please <a href="'+c.post.source_url+'" target="_blank" style="font-size:18px;">click here</a> </p>';$(".tempPopUp").remove(),a.$node("popUpContent>div").html(""),a.$node("popUpContent>div").append(d),a.$node("popUpContent>div").prepend('<h2 class="popUpHeading">'+c.post.title+"</h2>"),a.$node("popUp").css("display","block"),$("body").append(a.$node("popUp").clone().addClass("tempPopUp")),$(window).resize(function(){$(".excerptClosePopUp").css("top",$(".tempPopUp .zui_zdc_common_rail_tab_guides_popUpContent").position().top-20)}),$(".zy-game-frame-wrapper").css("top","-10000px"),$(".excerptClosePopUp").click(function(){$(".excerptPopUp").css("display","none"),$(".zy-game-frame-wrapper").css("top","0"),a.track({counter:"GLP_Guide_Pageviews",kingdom:a.get("gameId"),phylum:b.postId,"class":"Close"})}),$(".tempPopUp a").attr("target","_blank"),setTimeout(function(){$(".excerptClosePopUp").css("top",$(".tempPopUp .zui_zdc_common_rail_tab_guides_popUpContent").position().top-20)},1e3),$.expr[":"].Contains=function(a,b,c){return $(a).text().toUpperCase().indexOf(c[3].toUpperCase())>=0},$(".excerptPopUp a:Contains('PLAY')").remove()}),a.track({counter:"GLP_Guide_Pageviews",kingdom:a.get("gameId"),phylum:b.postId,"class":"View"})})}),b({})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/tabs/max",version:1,extend:"widgets/zdc/common/rail/tabs",themes:[""],localized:!1,constructor:function(a,b,c,d){var e=5,f=400,g=300,h=500,i=!0;a.set({t_tab:'<div class="$tab$ $%key%$" title="%name%"><div class="$tabIcon$"/><span class="$tabLabel$"></span><div class="$tabCaret$"/></div>'}),a.declare("tabCaretHidden","tabsWidth"),a.bindStateToClass("tabCaretHidden"),a.bindStateToContent("tabsWidth",function(){a.done("tabsWidthKnown")}),a.updateUiTabsShown=function(b,c,j){a.need("$",function(k){a.once("tabsWidthKnown",function(){function q(){function k(){function c(){i=!1,p>1&&a.set("tabCaretHidden",!1),j()}function e(){++b==l.length&&c()}var b=0;++m==f&&(l.length?d.each(l,function(b){var c=a.$node(b);i?(c.css(o),e()):(b==a.get("selected")&&a.set("tabCaretHidden",!0),c.animate(o,h,e))}):c())}var c=a.get("dataSet"),f=c.length;d.each(b,function(a){p+=a}),p<2?(a.$node().parent().slideUp().hide(),a.$node().parent().siblings().animate({top:"10px"}),a.set("tabCaretHidden",!0)):(a.$node().parent().show(),a.$node().parent().siblings().animate({top:"60px"}),a.set("tabCaretHidden",!1));var n=a.get("tabsWidth");totalSpacersWidth=(p-1)*e,shownTabCount=0,widthRemaining=n,currentLeft=0,d.each(c,function(c){var d=c.key,f={left:currentLeft};if(b[d]){var h=++shownTabCount<p?e:0,j=p-shownTabCount+1,l=Math.round((widthRemaining-e*(j-1))/j),m=l+h;f.right=n-currentLeft-l,currentLeft+=m,widthRemaining-=m}else f.right=currentLeft;i?(a.$node(d).css(f),k()):a.$node(d).animate(f,g,k)})}var k=[],l=[],m=0,n={opacity:0,top:-40},o={opacity:1,top:0},p=0;for(var r in b)b.hasOwnProperty(r)&&b[r]!=c[r]&&(b[r]?l:k).push(r);if(k.length){var s=0,t=function(){++s==k.length&&q()};d.each(k,function(b){var c=a.$node(b);i?(c.css(n),t()):c.animate(n,f,t)})}else q()})})}}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/takeover",version:1,extend:"widgets/base",required:["widgets/zdc/common/closebutton"],themes:[""],constructor:function(a,b,c,d){var e;a.declareAndSet({t_content:'<div class="$$"><div class="$overlay$"/><div class="$takeoverOuter$"><div class="$closeButton$"/><div class="$takeoverBody$"/></div></div>'}),a.createContent=function(b){a.need("$",function(c){a.content=c(a.useTemplate("t_content")),b(a.content),a.createBodyContent&&a.createBodyContent(function(c){a.$node("takeoverBody").append(c)}),e=a.addChild("close","widgets/zdc/common/closebutton",{theme:"round"}),e.getContent(function(b){a.$node("closeButton").append(b)}),e.wire("click",function(b){a.hide(),a.fire({name:"takeover_close",bubble:!0})})})},a.once("content",function(b){a.$node("overlay").css("opacity","0.5").fadeIn()}),b({hide:function(){a.once("content",function(){a.$node().parent().fadeOut()})},show:function(){a.once("content",function(){a.$node().parent().fadeIn()})}})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/takeover/avatarftueinterstitial/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_common_rail_takeover_avatarftueinterstitial_avatarftueinterstitial:{str_button_text:{original:"Get Yours"},str_shopmall:{original:"Shop Avatar Mall"},str_buttongrey1:{original:"Look Great Now!"},str_buttongrey2:{original:"Get your Own Avatar"},str_buttonorange1:{original:"Look Great Now!"},str_buttonorange2:{original:"Get your Own Avatar"}}})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/takeover/avatarftueinterstitial",version:1,extend:"widgets/zdc/common/rail/takeover",required:["widgets/zdc/common/rail/takeover","widgets/zdc/services/experiments","widgets/button"],localized:!0,themes:[""],constructor:function(a,b,c,d){var e,f=c.getInstance("widgets/zdc/services/experiments"),g=260;a.declare("str_button_text","str_buttongrey1","str_buttongrey2","str_buttonorange1","str_buttonorange2"),a.declareAndSet({t_bodyContent:'<div class="$contents$"><div class="$titleImage$"></div><div class="$animImage$"></div><div class="$buttonContainer$ buttonContainer"></div></div>',t_bodyContentOrange2:'<div class="$contentsNew$"><div class="$orangeWaving2$"></div><div class="$orangeBg2$"></div><div class="$buttonContainerNew$ buttonContainer"></div></div>',t_bodyContentOrange1:'<div class="$contentsNew$"><div class="$orangeWaving1$"></div><div class="$orangeBg1$"></div><div class="$buttonContainerNew$ buttonContainer"></div></div>',t_bodyContentGrey1:'<div class="$contentsNew$"><div class="$greyWaving1$"></div><div class="$greyBg1$"></div><div class="$buttonContainerNew$ buttonContainer"></div></div>',t_bodyContentGrey2:'<div class="$contentsNew$"><div class="$greyWaving2$"></div><div class="$greyBg2$"></div><div class="$buttonContainerNew$ buttonContainer"></div></div>'}),a.createBodyContent=function(b){a.need("$",function(c){var d=c(a.useTemplate("t_bodyContentOrange2")),f="str_buttonorange2";e=a.addChild("button","widgets/button"),e.set({theme:"zdc",size:"xlarge",color:"white",label:a.localize(f)}),e.setPrimary(),e.setEnabled(),e.getContent(function(b){d.find(".buttonContainer").append(b),a.done("buttonContent")}),e.wire("click",function(){a.fire("gotoZAvatar"),a.fire({name:"trackZAvatarFTUE",bubble:!0,source:"right_rail",exitMethod:"start"}),a.hide()}),a.wire("takeover_close",function(){a.fire({name:"trackZAvatarFTUE",bubble:!0,source:"right_rail",exitMethod:"close"})}),a.once("buttonContent",function(){b(d),a.done("avatarFTUEInterstitialContent"),a.repositionButton()})})},a.repositionButton=function(){var b=a.$node("buttonContainerNew");b.css("left",(g-b.width())/2+"px")},b({})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/takeover/inviteinterstitial/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_common_rail_takeover_inviteinterstitial_inviteinterstitial:{str_title_B:{original:"Have friends over to play"},str_body_B:{original:"Get more play by inviting more friends to join you on Zyngagames.com. They'll see it only in their Zynga Inbox, it won't post to Facebook."},str_count:{original:"+{num}"},str_button_text:{original:"Invite Friends"},str_sent_invite_msg:{original:"Invites sent to their Zynga Inbox."},str_sent_button_text:{original:"Okay"},str_new_variant_title:{original:"Be more{break}popular!"},str_new_variant_body:{original:"Invite more friends who like games to Zyngagames.com."},str_new_variant_message:{original:"{boldOpen}Note:{boldClose} The invite goes to their Zynga Inbox, not Facebook wall."}}})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail/takeover/inviteinterstitial",version:1,extend:"widgets/zdc/common/rail/takeover",required:["widgets/zdc/common/rail/takeover","widgets/button"],localized:!0,themes:[""],constructor:function(a,b,c,d){var e,f;a.declare("str_title_B","str_body_B","str_count","str_button_text","str_sent_invite_msg","str_sent_button_text","str_new_variant_title","str_new_variant_body","str_new_variant_message","facepileData","accessToken","uiVariant"),a.declareAndSet({t_bodyContent:'<div class="$outsideWrapper$"><div class="$contents$"><div class="$title$"></div><div class="$bodyText$"></div><div class="$facepile$"></div><div class="$actionArea$"><div class="$messageContainer$">%str_sent_invite_msg%</div><div class="$buttonContainer$ buttonContainer" /></div><div class="$envelopeBg$" /><div class="$bottomMessaging$" /></div></div>'}),a.createBodyContent=function(b){a.need("$",function(c){var d=c(a.useTemplate("t_bodyContent"));e=a.addChild("button","widgets/button"),e.set({theme:"zdc",size:"large",color:"gold",label:a.localize("str_button_text")}),e.setPrimary(),e.setEnabled(),e.getContent(function(b){d.find(".buttonContainer").append(b),a.done("buttonContent")}),e.wire("click",function(){a.$node("buttonContainer").fadeOut(200,function(){a.$node("messageContainer").fadeIn(200),f=a.addChild("button","widgets/button"),f.set({theme:"zdc",size:"small",color:"gold",label:a.localize("str_sent_button_text")}),f.setPrimary(),f.setEnabled(),f.getContent(function(b){a.$node("buttonContainer").html("").append(b).fadeIn(200)}),f.wire("click",function(){a.hide()})})}),a.once("buttonContent",function(){b(d),a.done("inviteInterstitialContent"),a.fire({name:"invite_interstitial_content",bubble:!0})})})},a.bindStateToContent("facepileData",function(b,c){a.once("inviteInterstitialContent",function(){var d=0,e=8;a.$node("facepile").html("");for(var f=0;f<b.length;f++){if(d<e){var g=b[f],h="https://graph.facebook.com/"+g+"/picture?type=square";a.get("accessToken")&&(h+="&access_token="+a.get("accessToken")),a.$node("facepile").append('<div class="fb-pic"><img src="'+h+'" /></div>')}d++}if(d===0)Math.random();else if(d>e){a.$node("facepile").find(".fb-pic:last").remove();var i=d-e+1;a.$node("facepile").append(c('<div class="facepileExtra">'+a.localize("str_count",{num:i})+"</div>"))}})}),a.bindStateToContent("uiVariant",function(b,c){a.once("inviteInterstitialContent",function(){b=parseInt(b,10),b<2&&(b=1),a.$node("outsideWrapper").addClass("ui"+b),b<2?(a.$node("envelopeBg").css("opacity","0.2"),a.$node("title").html(a.localize("str_new_variant_title",{"break":"<br>"})),a.$node("bodyText").text(a.localize("str_new_variant_body")),a.$node("bottomMessaging").html(a.localize("str_new_variant_message",{boldOpen:"<b>",boldClose:"</b>"}))):(a.$node("title").text(a.localize("str_title_B")),a.$node("bodyText").text(a.localize("str_body_B")))})}),b({})}})

ZY.ZUI.module({name:"widgets/zdc/common/rail",required:["fullscreen","widgets/zdc/common/rail/tabs/max","widgets/zdc/common/rail/tab/chat","widgets/zdc/common/rail/tab/addFriends","widgets/zdc/common/rail/tab/suggestedFriends","widgets/zdc/common/rail/tab/gameActivity","widgets/zdc/common/rail/tab/guides","widgets/zdc/common/rail/ad","widgets/zdc/common/rail/min","widgets/zdc/common/rail/viewnav","widgets/zdc/common/rail/takeover/inviteinterstitial","widgets/zdc/common/rail/takeover/avatarftueinterstitial","widgets/zdc/services/helpfulness","widgets/zdc/services/messaging","widgets/zdc/services/gameboard","widgets/zdc/services/game","widgets/zdc/services/experiments"],version:1,extend:"widgets/base",themes:["","zdc"],constructor:function(a,b,c,d){function v(b){var c={chat:!0,everybody:!0,suggested:!0,zfriends:!0},d={everybody:!0,zfriends:!0},e=a.get("railOpts"),f=[],g=!1;for(var h in e)if(e.hasOwnProperty(h)&&e[h]&&c[h]){if(d[h]){if(g)continue;g=!0,h="activity"}f.push(h)}var i={name:"rail_load_tab",visible:f},j=a.children.tabs.tabKeyToRailOptNameMap;i.gameId=b,i.selected=j[a.get("selectedTab")],a.fire(i)}function w(){if(!a.children.ad){var b=a.addChild("ad","widgets/zdc/common/rail/ad");b.getContent(function(b){a.$node("adShell").html(b),a.done("ad_created")}),a.wire("adHeightSet",function(b){b.owner==q.owner&&a.set("adHeight",p?b.height:0)})}}function x(){return"viewNavBottom"}function y(){a.once("content",function(){p=a.get("showAds");var b=c.getInstance("widgets/zdc/services/experiments"),d=b.getExperimentValue({name:"zdcFriendFinderV2"}),e=b.getExperimentValue({name:"zdcFriendFinderAds"});d>=2&&e>=2&&(p=!1);var f=a.children.tabs?a.children.tabs.get("selected"):"none";if(f=="none")return;var g=x(),h=35;f=="gameActivity"&&(p=!1,g=="viewNavMiddle"&&(g="viewNavBottom")),a.set("viewNavPosition",g);var i=h;a.set("adHeight",0);if(p){u++;var j=u%q.refs.length,k=q.refs[j];w(),a.once("ad_created",function(){a.children.ad.set("adParams",{ref:k,publicUri:q.publicUri,commonWebPrefix:q.commonWebPrefix,owner:q.owner})})}a.$node("body").css("bottom",i)})}function z(b){a.need("$",function(d){var f=b+"Tab";if(!a.$node(f).length){var g=d(a.useTemplate("t_tab",{tabName:b}));a.$node("tabContent").append(g);var h="widgets/zdc/common/rail/tab/"+b;c.require(h,function(){var c=a.addChild(f,h);b=="guides"&&c.set("gameId",e),c.getContent(function(b){g.html(b),a.done(f+"_created"),a.fire(f+"_created")})})}else b=="guides"&&a.children.guidesTab.set("gameId",e)})}function A(b){return a.$node(b+"Tab")}function B(b){a.once("content",function(){f&&A(f).css("display","none"),b&&b!="none"&&(z(b),A(f=b).css("display","block")),y()})}function C(b){var c={chat:!0,everybody:!0,suggested:!0,zfriends:!0},d={everybody:!0,zfriends:!0},e=a.get("railOpts"),f=[],g=!1;for(var h in e)if(e.hasOwnProperty(h)&&e[h]&&c[h]){if(d[h]){if(g)continue;g=!0,h="activity"}f.push(h)}var i={name:"rail_user_click_tab",visible:f,lastSelected:null},j=a.children.tabs.tabKeyToRailOptNameMap;i.selected=j[a.get("selectedTab")],b&&(i.lastSelected=j[b]),a.fire(i)}var e,f,g=c.getInstance("widgets/zdc/services/helpfulness"),h=c.getInstance("widgets/zdc/services/messaging"),i=c.getInstance("widgets/zdc/services/gameboard"),j=c.getInstance("widgets/zdc/services/game"),k=c.getInstance("widgets/zdc/services/experiments"),l=100,m=500,n=500,o=150,p=!0,q={},r=null,s=null,t=null,u=0;a.declare("selectedTab","maximized","railOpts","showAds","rejectedTerms","chatSeen","viewNavPosition","fullscreenEnabled","onlineFriends","railWidth","adHeight"),a.declareAndSet({showHelpersV2:!0,useFixedRail:!1,t_content:'<div class="$$"><div class="$maxShell$"><div class="$toaster$" /><div class="$body$"><div class="$tabsShell$"/><div class="$tabContent$"/></div><div class="$minimizeShell$"><div class="$minimize$"/></div><div class="$adShell$"/><div class="$takeoverShell$"/><div class="$viewnavShell$"/></div><div class="$minShell$"/></div>',t_tab:'<div class="$tab$ $%tabName%Tab$"/>',notifications:{}}),a.bindStateToClass("maximized"),a.bindStateToClass("viewNavPosition"),a.bindStateToClass("useFixedRail","fixedRail"),a.onStateChange(["maximized","selectedTab"],function(){a.set("chatSeen",a.get("maximized")&&a.get("selectedTab")=="chat")}),a.once("chatTab_created",function(){a.bind(a.children.chatTab,[["chatSeen","seen"]]),a.bind(a.children.chatTab,"onlineFriends")}),a.set("viewNavPosition","viewNavNoFullscreen"),a.bindStateToContent("railOpts",function(b){a.children.min.set("railOpts",b),a.children.tabs.set("railOpts",b),a.once("gameActivityTab_created",function(){a.children.gameActivityTab.set("railOpts",b),v(e)})}),a.bindStateToContent("railWidth",function(b){a.once("tabs_created",function(){a.children.tabs.set("tabsWidth",b)})}),a.bindStateToContent("rejectedTerms",function(b){a.once("chatTab_created",function(){a.children.chatTab.setRejectedTerms(b)})}),a.bindStateToContent("adHeight",function(b){var c=35+b;a.$node("body").css("bottom",c),b===0?a.$node("adShell").hide():a.$node("adShell").show().css({height:b,bottom:35})}),a.createContent=function(b){a.need("$",function(d){a.content=d(a.useTemplate("t_content"));var e=a.addChild("tabs","widgets/zdc/common/rail/tabs/max");e.getContent(function(b){a.$node("tabsShell").html(b),a.done("tabs_created")}),a.$node("adShell").hide(),a.$node("body").css("bottom","0px");var f=a.addChild("viewnav","widgets/zdc/common/rail/viewnav");a.bind(f,["viewNavPosition","maximized"]),f.set({buttonIsMaximize:!1,maximized:a.get("maximized")}),a.get("fullscreenEnabled")&&c.getConstructor("fullscreen").supportsFullScreen&&(f.set("showFullScreenButton",!0),f.set("showTooltip",!1),a.set("viewNavPosition",x())),f.getContent(function(b){a.$node("viewnavShell").html(b),a.done("viewnav_created")});var g=a.addChild("min","widgets/zdc/common/rail/min");g.getContent(function(b){a.$node("minShell").html(b),a.done("min_created")}),a.bind(g,"notifications"),a.bind(e,"notifications"),a.once(["tabs_created","min_created","viewnav_created"],function(){b(a.content)})})},a.openToaster=function(b,c,d){a.once("content",function(){var e=a.$node("toaster"),f=a.$node("body"),g=l;d&&(g=d),b?(e.animate({height:g},m,function(){c&&c()}),f.animate({top:g},m)):(e.css("height",g),f.css("top",g)),a.children.min.openToaster(b)})},a.closeToaster=function(b,c){a.once("content",function(){var d=a.$node("toaster"),e=a.$node("body");b?(d.animate({height:0},n,function(){c&&c()}),e.animate({top:0},n)):(d.css("height",0),e.css("top",0)),a.children.min.closeToaster(b)})},a.bindStateToContent("selectedTab",function(b,c){a.clearTabNotification(b,!0)}),a.onStateChange(["showAds"],y),a.once("content",function(){function c(b){var c=b.name=="maximize";a.set("maximized",c),c&&(b.selectTab&&a.children.tabs.set("selected",b.selectTab),a.clearTabNotification(a.get("selectedTab"),!0)),b.bubble=!1}var b=a.children.tabs;a.set("selectedTab",b.get("selected")),B(b.get("selected")),ZY.Events.register("refreshAds",function(){a.removeChild("ad"),y()}),ZY.ZUIWidgetProxy.wire("changeAdPosition",function(b){if(b.value)a.$node("body").css("height","515px"),a.$node("body").css("bottom","auto"),a.$node("adShell").css("top","520px"),a.$node("adShell").css("bottom","auto");else{a.$node("body").css("height","auto"),a.$node("adShell").css("top","auto"),a.$node("adShell").css("bottom","35px");var c=35;a.$node("adShell").css("display")!="none"&&(c+=a.$node("adShell").height()),a.$node("body").css("bottom",c+"px")}}),b.wire("Changed:selected",function(c){a.set("selectedTab",c.newValue),B(b.get("selected")),a.refreshAds()}),b.wire("user_clicked_tab",function(b){a.set("selectedTab",b.tabId),C(b.oldValue)}),a.wire("maximize",c),a.wire("minimize",c),a.wire("hidead",function(b){a.set("showAds",!1)}),a.wire("showad",function(b){a.set("showAds",!0)}),i.fireWire({name:"gameboard.railOpts",callback:function(b){a.log("gameboard railopts",b),e=b.gameId,a.fire("railOpts",b),a.set("railOpts",b.railOpts)}}),i.fireWire({name:"gameboard.attached",callback:function(b){e=b.gameId,g.getGameHelpers({gids:[e]},function(c){if(!c||!c.hasOwnProperty(e))return;a.setNotifications({gameActivity:c[e].numNotifications})}),a.fire({name:"rail_gameboard_attached"})}}),h.wire("newCount",function(b){a.setNotifications({chat:b.count})}),g.wire("helperStatsUpdated",function(b){a.setNotifications({gameActivity:b.data.numNotifications})}),a.wire("user_clicked_tab",function(b){if(b.tabId=="chat"){var c=a.get("notifications").chat;c&&a.once("chatTab_created",function(){h.getLastMessagesSummary({},function(b){a.children.chatTab.loadGroupConversation(b.totalLastMessagesFromSameSender>=c?b.lastMessage.msg.conversationId:null)})})}})}),b({setNotifications:function(b){for(var c in b)a.get("maximized")&&c==a.get("selectedTab")&&(b[c]=0,a.clearTabNotification(c,!1));a.set("notifications",d.extend(a.get("notifications"),b))},clearTabNotification:function(b,c){b=="chat"&&h.clearUnreadMessageCount();if(c){var e=d.extend({},a.get("notifications"));e[b]=0,a.set("notifications",e)}},refreshAds:function(){a.once("ad_created",function(){p&&a.children.ad&&a.children.ad.refreshAds()})},showContactListImporter:function(){a.fire({name:"maximize",selectTab:"addFriends"}),a.once("addFriendsTab_created",function(){a.children.addFriendsTab.set("initialTab","contactImporter")})},loadFriendConversation:function(b,c){a.fire({name:"maximize",selectTab:"chat"}),a.once("chatTab_created",function(){a.children.chatTab.loadFriendConversation(b,c)})},loadGroupConversation:function(b,c){a.fire({name:"maximize",selectTab:"chat"}),a.once("chatTab_created",function(){a.children.chatTab.loadGroupConversation(b,c)})},getTabs:function(b){a.once("content",function(){b(a.children.tabs)})},getTab:function(b,c){var d=b+"Tab";a.once(["content",d+"_created"],function(){c(a.children[d])})},getToasterElement:function(b){return b?a.$node("toaster"):a.children.min.getToasterElement()},setInviteInterstitialData:function(b){a.once("content",function(){r?r.show():(r=a.addChild("takeover","widgets/zdc/common/rail/takeover/inviteinterstitial"),r.set(b),r.getContent(function(b){a.$node("takeoverShell").html(b),r.show()}))})},hideInviteInterstitial:function(){r&&r.hide()},showAvatarFTUEInterstitial:function(){a.once("content",function(){t=a.addChild("takeover","widgets/zdc/common/rail/takeover/avatarftueinterstitial"),t.wire("gotoZAvatar",function(){a.fire("gotoZAvatar")}),t.getContent(function(b){a.$node("takeoverShell").html(b),t.show()}),r=null})},showTakeover:function(){a.$node("takeoverShell").show()},hideAvatarFTUEInterstitial:function(){t&&t.hide()},setAdParams:function(a){for(var b in a)a.hasOwnProperty(b)&&(q[b]=a[b]);return q.owner="railAd",!0},openToaster:a.openToaster,closeToaster:a.closeToaster})}})

ZY.ZUI.module({name:"widgets/zdc/common/smartshield",version:1,extend:"widgets/base",themes:[""],constructor:function(a,b,c,d){function h(){a.need("$",function(b){var c=b(window).width(),d=b(window).height(),h=c-f;a.$node("overlay_left").css("clip","rect(0 "+h+"px "+d+"px 0)"),a.$node("overlay_top").css("clip","rect(0 "+c+"px "+e+"px "+h+"px)"),a.$node("overlay_bottom").css("clip","rect("+g+"px "+c+"px "+d+"px "+h+"px)")})}var e,f,g;a.declare("specialOverlay"),a.declareAndSet({t_content:'<div class="$$"><div class="$overlay_left$" /><div class="$overlay_top$" /><div class="$overlay_bottom$" /></div>'}),a.bindStateToContent("specialOverlay",function(){var b=a.get("specialOverlay");e=b.top,f=b.width,g=b.top+b.height,a.need("$",function(a){a(window).bind("resize",h),setTimeout(h,0)})}),a.createContent=function(b){a.need("$",function(c){a.content=c(a.useTemplate("t_content")),b(a.content)})}}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/captchaview/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_gameboard_captchaview_captchaview:{str_header:{original:"Hello {fname}!"},str_btn:{original:"Play Now!"},str_heading_text:{original:"Fill in the text below (just this once!) and start playing"}}})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/captchaview",version:1,extend:"widgets/base",themes:[""],localized:!0,required:["widgets/button"],constructor:function(a,b,c,d){a.declare("fname","gid","recaptchaObject","str_header","str_btn","str_heading_text"),a.declareAndSet({t_content:'<div class="$$"><div class="$bodyWrapper$"><div class="$header$"/><div class="$headingText$"/><div id="$captchadiv$"/><div class="$buttons$"/></div></div>'}),a.createContent=function(b){a.need("$",function(c){a.content=c(a.useTemplate("t_content"));var d=a.get("fname");a.$node("header").text(a.localize("str_header",{fname:d})),a.$node("headingText").text(a.localize("str_heading_text",{fname:d}));var e=a.addChild("submitButton","widgets/button");e.set({enabled:!0,multiple_use:!0,theme:"zdc",color:"white",size:"large",label:a.localize("str_btn")}),e.getContent(function(b){a.$node("buttons").append(b)}),b(a.content),e.wire("click",function(){var b=c("#recaptcha_challenge_field").val(),d=c("#recaptcha_response_field").val();a.get("recaptchaObject").captchaVerify(d,b,a.get("gid"))})})},a.once("in DOM",function(){a.get("recaptchaObject").captchaCreate(a.nodeClass("captchadiv"),c.locale.slice(0,2))}),b({})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/deferredconnect/continueGame/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_gameboard_deferredconnect_continueGame_continueGame:{str_error_defaultError:{original:"An error occured. Try reloading the page."},"str_error_email.alreadyRegistered":{original:"This Facebook account is already connected to another Zynga account ({data})."},"str_error_IDMapping.alreadyAssociated":{original:"Your account is already connected to a Facebook account. Try reloading the page."},"str_error_account.gwfUpdateFailed":{original:"An error occured while trying to remap this Facebook account. Try reloading the page."},"str_error_account.notFound":{original:"Logging in to Facebook lets you import your game without showing us your account info."},str_header:{original:"Continue your game!"},str_not_you:{original:"(Not You?)"},str_message_connect:{original:"Do you want to retrieve your game history?"},str_message_confirm:{original:"Are you ready to start playing?"},str_button_connect:{original:"Connect"},str_button_confirm:{original:"Retrieve Games"},str_or_label:{original:"or"},str_new_game:{original:"Start a new game"}}})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/deferredconnect/continueGame",version:1,extend:"widgets/base",themes:[""],localized:!0,required:["widgets/zdc/loggedout/chiclet/loginbutton","widgets/zdc/services/registration","widgets/zdc/services/fbc"],constructor:function(a,b,c,d){function l(){p("account.notFound")}function m(){a.fire({name:"noFbConnect"})}function n(){f&&g?j.deferredConnect({fbid:f,fbsession:g},function(b){if(b.e===0)a.fire({name:"userFbConnect"});else{var c=b.hasOwnProperty("errors")&&b.errors.length>0&&b.errors[0]?b.errors[0]:"defaultError",d=b.hasOwnProperty("data")?b.data:"";o(c,d)}}):l()}function o(a,b){k.logout({},function(c){f="",g="",p(a,b)})}function p(b,c){a.$node("profilePic").hide(),a.$node("header").html(a.localize("str_header")),a.$node("notYou").hide();if(b){var d="str_error_"+b;a.def.localeStringProperties.hasOwnProperty(d)||(d="str_error_defaultError"),c?a.$node("subHeader").html(a.localize(d,{data:c})):a.$node("subHeader").html(a.localize(d))}else a.$node("subHeader").html(a.localize("str_message_connect"));e.set({enabled:!0,color:"blue",label:a.localize("str_button_connect"),iconName:"fb_icon"}),e.unwire("click"),e.wire("click",function(){r()})}function q(){k.getUserData({},function(b){var c=k.getPictureUri({userData:{fbid:f},type:"square"});c&&(a.$node("profilePic").css("background","url("+c+") no-repeat top center"),a.$node("profilePic").show()),a.$node("header").html(b.first_name+" "+b.last_name),a.$node("notYou").show(),a.$node("subHeader").html(a.localize("str_message_confirm")),e.set({enabled:!0,color:"white",label:a.localize("str_button_confirm"),iconName:"fb_icon"})}),e.unwire("click"),e.wire("click",function(){n()})}function r(){var a={};a.success=function(a){f=a.authResponse.userID,g=a.authResponse.accessToken,q()},a.loginNoPerms=l,a.error=l,k.login(a,function(a){a.success==null&&l()})}var e,f,g,h,i,j=c.getInstance("widgets/zdc/services/registration"),k=c.getInstance("widgets/zdc/services/fbc");a.declare("str_error_defaultError","str_error_email.alreadyRegistered","str_error_IDMapping.alreadyAssociated","str_error_account.gwfUpdateFailed","str_error_account.notFound","str_header","str_not_you","str_message_connect","str_message_confirm","str_message_error","str_button_connect","str_button_confirm","str_or_label","str_new_game"),a.declareAndSet({t_content:'<div class="$$"><div class="$bodyWrapper$"><div class="$header$"/><div class="$profilePic$"/><div class="$notYou$"><a href="#">%str_not_you%</a></div><div class="$subHeader$"/><div class="$connectButton$"/><div class="$orSeperator$">%str_or_label%</div><div class="$startNew$">%str_new_game%</div></div></div>'}),a.createContent=function(b){a.need("$",function(c){a.content=c(a.useTemplate("t_content")),e=a.addChild("connectButton","widgets/zdc/loggedout/chiclet/loginbutton"),e.set({theme:"zdc",size:"large",iconName:"fb_icon"}),e.getContent(function(b){a.$node("connectButton").append(b)}),a.$node("notYou").click(function(){o()}),a.$node("startNew").click(function(){m()}),p(),b(a.content)})},b({})}})

ZY.ZUI.module({name:"widgets/zdc/common/gameimages",version:1,extend:"widgets/base",required:["widgets/zdc/services/game"],themes:[""],constructor:function(a,b,c,d){function l(b){var c=a.get("size"),d=e[b]?e[b]:b;return c===undefined&&(c=h),d+"-"+c+".png"}var e={1:"Poker",75:"City",90:"Ville",91:"Words",114:"Slingo",115:"Hidden",118:"FarmvilleTwo",223:"Castle",235:"Bingo",240:"Chef",243:"Bubble",254:"Ruby",0xcfae78295ed4:"Slingo",100000150:"RubberTacos",100000095:"Fashion",100000078:"MiniPutt",100000128:"Sports"},f=".png",g="s",h="m",i="dw",j={m:"213x154",dw:"450x215"},k=c.getInstance("widgets/zdc/services/game");a.declareAndSet({t_imageSrc:"%assetPath%/%filename%",t_image:'<img class="$image$" />'}),a.declare("game_id","size"),a.bindStateToContent("game_id",function(b){k.fetch({gids:b},function(c){if(b=="5002607"||b=="5002535")console.log("Game Portal Asset: ",c),c.hasPortalAssets=!0,c.portalAssets["450x215"]=!0,c.portalAssets["213x154"]=!0,c.portalAssets["50x50"]=!0,c.portalAssets["35x35"]=!0;if(c&&c.hasPortalAssets)k.getAssetUri({gid:b,size:j[a.get("size")]},function(b){a.$root().attr("src",b)});else{var d=a.useTemplate("t_imageSrc",{filename:l(b)});a.$root().attr("src",d)}a.done("gameIconLoaded")})}),a.createContent=function(b){a.need("$",function(c){var d=c(a.useTemplate("t_image"));b(d)})},b({SIZE_SMALL:g,SIZE_MEDIUM:h,SIZE_DOUBLE_WIDE:i})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/deferredconnect/haveYouPlayed/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_gameboard_deferredconnect_haveYouPlayed_haveYouPlayed:{str_header:{original:"Hello {fname}!"},str_played_question:{original:"Have you ever played {gname} before?"},str_default_game_name:{original:"this game"},str_left_btn:{original:"Yes"},str_right_btn:{original:"No"}}})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/deferredconnect/haveYouPlayed",version:1,extend:"widgets/base",themes:[""],localized:!0,required:["widgets/zdc/common/gameimages","widgets/button"],constructor:function(a,b,c,d){var e,f,g=c.getInstance("widgets/zdc/services/game");a.declare("fname","gid","str_header","str_played_question","str_left_btn","str_right_btn","str_default_game_name"),a.declareAndSet({t_content:'<div class="$$"><div class="$bodyWrapper$"><div class="$header$ zui_ellipsis"/><div class="$sub_header$"/><div class="$gameTile$"/><div class="$buttons$"/></div></div>'}),a.createContent=function(b){a.need("$",function(c){a.content=c(a.useTemplate("t_content"));var d=a.get("fname");a.$node("header").text(a.localize("str_header",{fname:d})),f=a.addChild("rightButton","widgets/button"),f.set({enabled:!0,theme:"zdc",color:"white",size:"large",label:a.localize("str_right_btn")}),f.getContent(function(b){a.$node("buttons").append(b)}),e=a.addChild("lefttButton","widgets/button"),e.set({enabled:!0,theme:"zdc",color:"white",size:"large",label:a.localize("str_left_btn")}),e.getContent(function(b){a.$node("buttons").append(b)}),b(a.content)})},a.bindStateToContent("gid",function(b){var c=a.addChild("gameImage","widgets/zdc/common/gameimages");c.set({game_id:b,size:c.SIZE_MEDIUM}),c.getContent(function(b){a.$node("gameTile").append(b)}),g.fetch({gids:b},function(b){!b||!b.name?a.$node("sub_header").text(a.localize("str_played_question",{gname:a.localize("str_default_game_name")})):a.$node("sub_header").text(a.localize("str_played_question",{gname:b.name}))})}),a.once("content",function(){e.wire("click",function(){a.fire({name:"userPlayedGid",gid:a.get("gid")})}),f.wire("click",function(){a.fire({name:"neverPlayedGid",gid:a.get("gid")})})}),b({})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/game",version:1,extend:"widgets/base",required:["widgets/zdc/services/game","widgets/zdc/services/gameboard"],themes:[""],constructor:function(a,b,c,d){function t(){return g||(g=a.$node("game_frame")),g}function u(a){if(a){var b=t();return b.attr(a)}return null}function v(){var a=t();return a.width()}function w(){var a=t();return a.height()}function x(){var b=a.get("gameInfo");return b&&b.hasOwnProperty("fixed")&&b.fixed?!0:!1}function y(){return{width:v(),height:w(),fixed:x()}}function z(){return window.frames[a.get("id")].SNAPI}function A(){var b=a.$node().width()-v(),c=a.$node().height()-w();b/=2,c/=2,b<0&&(b=0),c<0&&(c=0),t().css({left:b,top:c})}function B(){x()&&($(window).resize(A),A())}function C(b){a.need("$",function(c){var d=t();if(d){var f=a.$node();b?(f.removeClass(o),d.removeClass(o),e=!1):(f.addClass(o),d.addClass(o),e=!0)}})}function D(){++l==1&&a.gameSend("beforeDialogOpen",{},function(){C(!1)})}function E(){l>0&&--l===0&&(e&&C(!0),a.gameSend("afterDialogClose",{}))}function F(){f=!1,a.gameSend("sleep",{},function(){f=!0,D()}),k.setState({active:k.ACTIVE_STATE_ASLEEP})}function G(){f?(f=!1,E()):a.gameSend("wake",{}),k.setState({active:k.ACTIVE_STATE_AWAKE})}function H(a){return function(b){r[a].push(b)}}function I(a,b){if(!r.hasOwnProperty(a))return;for(var c=0;c<r[a].length;c++)b(r[a][c]);r[a]=[]}function J(b){c.require(["widgets/zdc/services/game"],function(){var c=a.get("gameInfo");j.fetchCached({gids:c.gameId,attr:["railOpts"]},function(a){if(a.railOpts){var e=d.extend({},a.railOpts,b);m&&(e.activity=!0,e.zfriends=!0,e.select="activity"),j.setAttr({gid:c.gameId,attr:{railOpts:e}})}})})}function K(b){b.hasOwnProperty("requests")&&c.require(["widgets/zdc/services/discovery"],function(){var d=c.getInstance("widgets/zdc/services/discovery"),e={},f=a.get("gameInfo");e[f.gameId]=b.requests,d.setRequests(e)})}function L(a){a.hasOwnProperty("percent")&&a.percent>=100&&k.setState({loading:k.LOADING_STATE_READY})}function M(){i.listen("railOpts",J),i.listen("inbox",K),i.listen("gameLoading",L);for(var a in r)r.hasOwnProperty(a)&&i.listen(a,H(a))}function N(a,b,c){return i.send(a,b,c)}function O(b,c){a.once("attached",function(){I(b,c),i.listen(b,c)})}function P(a){return i.has(a)}function Q(b,c){var d=a.get("gameInfo").gameId;a.once("gameonce."+b+"."+d,function(){c()}),i.once(b,function(){a.done("gameonce."+b+"."+d)})}function R(){a.need("$",function(b){var c=a.$node("gradient");if(a.children.ads){var d=a.children.ads.$root(),e=Math.floor((c.width()-d.width())/2)-20;d.css("margin-left",e+"px")}c.height(a.$node("game_frame").height())})}function S(){var b=a.get("gameInfo"),c=function(b){a.$node().css("background","url("+b+")"),setTimeout(R,0)};if(b.hasPortalAssets)j.getAssetUri({gid:b.gameId,size:"background"},c);else if(b.gameBackgroundPath){var d=new Image;d.onload=function(){c(b.gameBackgroundPath)},d.src=b.gameBackgroundPath}}function T(a){m=a}var e=!1,f=!1,g,h=!1,i=null,j=c.getInstance("widgets/zdc/services/game"),k=c.getInstance("widgets/zdc/services/gameboard"),l=0,m=!1,n="fixed",o="offscreen",p="zy-frozen",q=1e3,r={feedHandled:[],feedsFiltered:[],publishFeed:[],setLocale:[],zFriends:[]},s=1;a.declare("alias","attached","adParams","authenticated","gameInfo","id","offscreen"),a.declareAndSet({show_fast_load:!1,t_content:'<div class="$$"><div class="$fast_load$"><div class="$fast_load_icon$" /><div class="$fast_load_text$">Fast Load</div></div></div>',t_gameframe:'<div class="$gradient$" /><iframe class="$game_frame$" zdczid="'+ZY.Env.user.zid+'" frameborder="0" allowTransparency="true" />'}),a.bindStateToClass("alias"),a.bindStateToClass("show_fast_load"),a.bindStateToContent("show_fast_load",function(b,c){b&&setTimeout(function(){a.$node("fast_load").fadeOut()},q)}),a.bindStateToContent("gameInfo",function(b,c){if(b&&b.gameId){k.setState({gameId:b.gameId,loading:k.LOADING_STATE_STARTED}),a.set("alias",b.product);var d=a.$node();h?a.$node("gradient").hide():(d.append(a.useTemplate("t_gameframe")),h=!0),c.browser.mozilla?d.addClass("browser-mozilla"):d.addClass("browser-other");var e=["width: 100%","height: 100%"],f=["hidden"];b.fixed&&f.push(n),a.get("authenticated")&&S();var g=t().addClass(f.join(" ")).attr("style",e.join(";")).load(function(){g.removeClass("hidden")})}}),a.bindStateToContent("offscreen",function(a,b){C(!a)}),a.bindStateToContent("id",function(a,b){t().attr("id",a).attr("name",a)}),a.onStateChange("attached",function(){a.get("attached")&&(i=k.getGameMessagesInstance({id:a.get("id")}),M(),k.setState({loading:k.LOADING_STATE_ATTACHED,controller:a}),a.gameOnce("handleFeed",function(){k.setState({loading:k.LOADING_STATE_READY})}),a.done("attached"))}),a.bindStateToContent("authenticated",function(a,b){a&&S()}),a.createContent=function(b){a.need("$",function(c){var d=a.content=c(a.useTemplate("t_content"));b(d),B(),c(window).bind("resize",function(){R()})})},b({getDimensions:y,getAttr:u,getHeight:w,getSNAPI:z,getWidth:v,hasFixedDimensions:x,freeze:D,moveOnscreen:C,unfreeze:E,sleep:F,wake:G,gameSend:N,gameListen:O,gameHas:P,gameOnce:Q,showingStartingPoint:T})}})

ZY.ZUI.module({name:"widgets/zdc/gameboard/gamebackground",version:1,extend:"widgets/base",themes:[""],localized:!1,required:[],constructor:function(a,b,c,d){a.declare("backgroundUrl"),a.declareAndSet({t_content:'<div class="$$"><div class="$gameBackground$"><div class="$container$"></div></div>'}),a.createContent=function(b){a.need("$",function(c){a.content=c(a.useTemplate("t_content")),b(a.content)})},a.bindStateToContent("backgroundUrl",function(b){a.$node("gameBackground").css("background-image","url("+b+")")}),b({changeContent:function(b,c){c&&a.addChild("child",c),a.once("content",function(){a.$node("container").fadeOut("slow",function(){a.$node("container").empty(),a.$node("container").append(b)}),a.$node("container").fadeIn("slow")})}})}})

ZY.ZUI.module({name:"widgets/zdc/profile/rwelcomewfn/static-locale/en_US",required:"zloc",builder:function(){ZY.ZUI.ZLoc.init("en_US",{widgets_zdc_profile_rwelcomewfn_rwelcomewfn:{str_title:{original:""}}})}})

ZY.ZUI.module({name:"widgets/zdc/profile/rwelcomewfn",version:1,extend:"widgets/modaldialog",themes:["","zdc"],localized:!0,constructor:function(a,b,c,d){var e=a._super;a.declare("backgroundUrl"),a.declareAndSet({showOverlay:!0,closeOnOverlayClick:!1,showCloseButton:!1,allowRightRailInteraction:!1,t_dialog_content:'<div class="$container$"/>'}),a.doCenter=function(a,b,c){},a.bindStateToContent("backgroundUrl",function(b){a.$node("overlay").css("background-image","url("+b+")")}),a.createDialogContent=function(b){a.need("$",function(c){var d=c(a.useTemplate("t_dialog_content"));b(d)})},b({addContent:function(b){a.once("content",function(){a.$node("container").append(b)})},open:function(){e.open()}})}})
if(!ZY.Rail){ZY.Rail=function(){function s(a){a+=10;var b=a+"px";j={minimized:{"margin-right":"120px"},maximized:{"margin-right":b}},k={minimized:{"padding-right":"120px"},maximized:{"padding-right":b}},l={minimized:{width:"120px"},maximized:{width:b}},m={minimized:{right:"120px"},maximized:{right:b}}}function t(a,b,c,d,e,f,g){a=a||"ZDC_gameboard",b=b||"rts",g=g||1,!e&&ZY.Env.gameboardInfo&&ZY.Env.gameboardInfo.gameId&&(e=ZY.Env.gameboardInfo.gameId),ZY.ZTrack.log2({counter:a,kingdom:b,phylum:c,"class":d,family:e,genus:f,value:g},!0)}function u(a){var b=a?"expand":"collaspe",c=ZY.ZDCPageNavigator.getCurrentPage(),d=c=="play"?ZY.Env.canon_id:c;t("zdc_right_rail","collapse",null,null,b,d)}function v(a){i=$(".zy-game-frame-wrapper");var b=a?"maximized":"minimized";$("#content-outer").css(j[b]),$("#header-outer>div").css(k[b]),h.css(l[b]),i.css(m[b]),ZY.Events.fire("Rail.Toggled",{maximized:a,marginRightCss:l[b]})}function w(){b.wire({"Changed:maximized":function(a){v(a.newValue)},conversationActionMenuClick:function(a){if(a&&a.hasOwnProperty("action")&&a.action&&a.hasOwnProperty("zid")&&a.zid&&a.hasOwnProperty("comments")&&a.comments)switch(a.action){case"view_profile":ZY.ZDCPageNavigator.navigateToProfile(a.zid);break;case"add_friend":ZY.ZFriends.addZid(a.zid);break;case"report_abuse":ZY.Util.asyncLoadJS([ZY.Env.minified_common_static_uri+"/Report.js"],function(){ZY.Report.reportBlock(a.zid,a.comments)});break;default:}},rts_suggestedFriends_view:function(a){ZY.Env.gameboardInfo?(t(null,null,"suggested_zfriend","view",ZY.Env.gameboardInfo.gameId,a.value),a.bubble=!1):t("ZDC_right_rail","suggested_zfriends",null,null,"view")},select_change:function(a){a.tabId=="suggestedFriends"&&ZY.Env.gameboardInfo&&t("zdc_friend_finder","open","manual",ZY.Env.gameboardInfo.gameId,"gamepage","view")},rts_feedItem_CTA_click:function(a){t(null,null,a.feedType=="neighbor"?"zfriend_feed":"everyone_feed","CTA_click",null,a.value),t("zOps","FeedClick"+(a.feedType=="neighbor")?"zFriends":"Everyone"),a.bubble=!1},rts_feedItems_view:function(a){t(null,null,a.feedType=="neighbor"?"zfriend_feed":"everyone_feed","view",null,a.value),a.bubble=!1},rts_feedAds_view:function(a){var b;switch(a.feedType){case"neighbor":b="zfriend_feed";break;case"public":b="everyone_feed";break;default:b=a.feedType}t(null,"right_rail_ads",b,"view",null,a.value),a.bubble=!1},rts_feedItem_cta_error:function(a){t(null,null,a.feedType=="neighbor"?"zfriend_feed":"everyone_feed","CTA_error",null,a.itemOverLimit),a.bubble=!1},helpersStrangerCTAClicked:function(a){a&&a.hasOwnProperty("zid")&&ZY.ZFriends.addZid(a.zid)},helpersShareButtonClicked:function(a){return!1},maximize:function(a){u(!0)},minimize:function(a){u(!1)},rail_user_click_tab:function(a){var b=ZY.ZDCPageNavigator.getCurrentPage(),c=b=="play"?ZY.Env.canon_id:b;t("zdc_right_rail","tabs_click",a.selected,a.lastSelected,a.visible.join(),c)},rail_load_tab:function(a){var b=a.gameId;t("zdc_right_rail","tabs_load",a.selected,null,a.visible.join(),b)},takeover_close:function(a){ZY.Events.fire("Takeover.close")},fullscreenButtonClick:function(a){t("zdc_browser_fullscreen",a.action,ZY.ZDCPageNavigator.currentPageIsGameboard()?"game_page":"any_page",d.getGameId(),null,null,null),ZY.Env.user.fullscreen_tooltip_seen||_setFullscreenTooltipSeen()},fullscreenTooltipView:function(a){t("zdc_browser_fullscreen","msg_view",ZY.ZDCPageNavigator.currentPageIsGameboard()?"game_page":"any_page",d.getGameId(),null,null,null)},railOpts:function(a){ZY.Constants.ZDC_GAME_ID==a.gameId&&b.hideRetentionTests()}}),ZY.Events.register("ZyngaOnPageLoaded",function(){v(b.get("maximized"))})}function x(){var a=$(window),b=g.length>0?g:$("#header"),c=b.height(),d,e,f=$("#content");$(window).scroll(function(){d=a.scrollTop(),e=$("body").innerHeight()-$(window).height(),h.css({top:d>c?e:c+e-d})})}function y(a){x(),ZY.ZUI.require("widgets/zdc/common/rail",function(){b=ZY.ZUI.getInstance("widgets/zdc/common/rail");var c=$(window).width(),d=!1,e=!1,g=0;b.set({useFixedRail:!0,showAds:!0,rejectedTerms:ZY.Env.reject_terms,fullscreenEnabled:ZY.Env.browser_fullscreen_enabled});var h={publicUri:ZY.Env.public_uri,commonWebPrefix:ZY.Env.common_web_prefix,refs:ZY.Env.user.adInfo.rr_bottom};b.setAdParams(h),ZY.Barrier.done("rail_widget_instantiated"),ZY.Barrier.once("widgetproxy",function(){ZY.ZUIWidgetProxy.attach("railWidget",b)}),w(),b.getContent(function(e){e.appendTo($(a)),ZY.Barrier.done("rail_widget_content"),d=c>=f,b.set("railWidth",n),b.set("maximized",d),v(d)}),ZY.Events.register("iframe.refresh",function(){b.refreshAds()})})}var a={},b,c,d,e=ZY.ZUI.commons(),f=1024,g,h,i,j,k,l,m,n,o,p,q,r;return a.withRailWidget=function(a){ZY.Barrier.once("rail_widget_instantiated",function(){a(b)})},a.isMaximized=function(){return b.get("maximized")},a.selectedTab=function(){return b.get("selectedTab")},a.showContactListImporter=function(){ZY.Barrier.once("rail_widget_instantiated",function(){b.showContactListImporter()})},a.loadFriendConversation=function(a,c){ZY.Barrier.once("rail_widget_instantiated",function(){b.loadFriendConversation(a,c)})},a.loadGroupConversation=function(a){b.loadGroupConversation(a)},a.openSendMessageDialog=function(a,b,c){e.need("startchatdialog",function(e){e.set("toZid",a),e.set("centerToNode",b),c&&e.set("offsetTop",c),e.open()})},a.popAvatarFTUEInterstitial=function(){ZY.Barrier.once("rail_widget_content",function(){b.wire("gotoZAvatar",function(){ZY.Events.fire("gotoZAvatar")}),b.wire("trackZAvatarFTUE",function(a){ZY.Events.fire("trackZAvatarFTUE",a)}),b.showAvatarFTUEInterstitial(),b.set("maximized",!0)})},a.init=function(){ZY.ZUI.require("widgets/zdc/services/gameboard",function(a){d=a()}),ZY.ZUI.require("widgets/zdc/services/experiments",function(a){r=a(),q=r.getExperimentValue({name:"zdcFriendFinderV2"}),ZY.ZUI.require("widgets/zdc/services/socialgraph",function(a){p=a(),ZY.ZUI.require("widgets/zdc/services/game",function(a){o=a(),q==4?o.fetchAllZdcGids({},function(a){p.fetchSuggestedFriends({gameId:ZY.Constants.ZDC_GAME_ID,maxLimit:8},function(){});for(var b in a)if(a.hasOwnProperty(b)){var c=a[b];c.id!=1&&c.id!=100000142&&c.id!=100000156&&p.fetchSuggestedFriends({gameId:c.id,maxLimit:8},function(){})}}):q>=1&&p.fetchSuggestedFriends({gameId:ZY.Constants.ZDC_GAME_ID,maxLimit:20},function(){})})})}),ZY.Barrier.done("rail_init")},a.setNotification=function(a){ZY.Barrier.once("rail_widget_instantiated",function(){b.setNotifications(a)})},a.load=function(a,b){b.feedOpts&&(ZY.feedOpts=b.feedOpts,ZY.Barrier.done("ZY.feedOptsLoaded")),g=$("#header"),h=$("#rail-right-outer"),n=b.width||300,s(n),ZY.Barrier.once("ZY.User.userloaded",function(){y(a)})},a}();}
if(!ZY.ToasterManager){ZY.ToasterManager=function(){function v(a){o=a,ZY.Events.fire("ToastersVisibilityChanged",o)}function w(a){g[a]||(g[a]=[])}function x(){ZY.Data.set({zid:ZY.Env.user.zid,key:ZY.Data.types.ALERTS},{queue:k},!0)}function y(a,b){ZY.ZTrack.track(a,null,b)}function z(){!k.length&&!l.length&&t.closeToaster(!0,function(){v(!1)})}function A(a){if(a.doNotQueue)return;k.unshift(a);if(k.length>=b){for(var c=b-1;c<f.length;c++){var d=f[c];d&&d.remove&&d.remove.apply&&d.remove()}k=k.slice(0,b),f=f.slice(0,b)}x()}function B(a,b){return l.length?(m&&(clearTimeout(m),m=null),m=setTimeout(function(){m=null,n=setTimeout(function(){n=null;var c=l.shift();c&&(A(c),h(c,!1),c.doNotQueue&&B(a,b))},b),z()},a),!0):(z(),!1)}function C(){var a=k.shift();p=!1,x(),a&&a.alertType&&g[a.alertType]&&g[a.alertType][a.userInfo.zid]&&delete g[a.alertType][a.userInfo.zid];var b,c;k.length?(b=d,c=e):b=c=0,B(b,c)}function D(a,b,c){g[b]&&g[b][a]&&delete g[b][a];if(c===!0){var f,h;k.length?(f=d,h=e):f=h=0,B(f,h)}}function E(a){a.addClass(c)}function F(a){ZY.Barrier.once("ToasterManagerLoad",function(){var b=a.newValue===!0,c=b?j:i,d=b?i:j;d.empty().append(c.children());for(var e=0;e<f.length;e++)f[e].set("theme",b?"default":"collapsed")})}var a={},b=5,c="white",d=500,e=3e3,f=[],g={},h,i,j,k=[],l=[],m=null,n=null,o=!1,p=!1,q={type:"easeInOutQuart",interval:1e3},r={type:"easeInOutQuart",interval:500},s=!1,t=null,u=100;return h=function(a,b,c){var h=!0,k={},l="widgets/zdc/common/toaster/alert",m=a.userInfo&&a.userInfo.zid?a.userInfo.zid:0,n=a.alertType?a.alertType:"",r=a.doNotQueue?a.doNotQueue:!1;switch(n){case"heat_test_confirmation":l="widgets/zdc/common/toaster/heattestcompleted",k={theme:t.get("maximized")?"default":"collapsed",alertId:a.alertId||"",alertType:n,headline:a.headline||"",subHeadline:a.subHeadline||"",image:a.image||"",buttonText:a.buttonText||"",userInfo:a.userInfo||{},height:a.height||""},a.height&&(u=a.height),h=!1;break;case"heat_test":l="widgets/zdc/common/toaster/heattest",k={theme:t.get("maximized")?"default":"collapsed",alertId:a.alertId||"",alertType:n,headline:a.headline||"",subHeadline:a.subHeadline||"",content:a.content||[],userInfo:a.userInfo||{},height:a.height||""},a.height&&(u=a.height),h=!1;break;default:l="widgets/zdc/common/toaster/alert",k={theme:t.get("maximized")?"default":"collapsed",alertType:n,buttonLabel:a.buttonLabel||"",headline:a.headline||"",subHeadline:a.subHeadline||"",userInfo:a.userInfo||{},gameId:a.gameId||"",lifetime:a.lifetime}}ZY.ZUI.require(l,function(){var s=ZY.ZUI.getInstance(l),x=!1;w(n),g[n]&&(g[n][m]=s),s.set(k),s.getContent(function(d){o||(t.openToaster(!0,$.noop,u),v(!0));var e=$(d),f=null;h?(f=$('<div class="toaster-mananger-wrapper clear" />'),f.append(e),(t.get("maximized")?i:j).append(f)):(f=e,(t.get("maximized")?i:j).append(f)),b?E(f):$.browser.msie||e.css({top:"-"+u+"px",opacity:0}).show().animate({top:"10px",opacity:1},q.interval,q.type,function(){E(f)}),r&&(p=!0,D(m,n,!1),ZY.Events.fire("ToasterViewed",a)),c&&typeof c=="function"&&c()}),s.wire("removed",function(){r?(p=!1,D(m,n,!0)):C()}),s.wire("click",function(b){if(x)return;x=!0,n=="heat_test"&&b.optionId!=null&&(a.optionId=b.optionId),y("toasterClicked",$.extend(a,{phylum:"CTA"}));if(a.clickData){var c=a.clickData;switch(n){case"messages":ZY.Rail&&ZY.Rail.loadFriendConversation(c.zid);break;case"notifications":ZY.URLUpdater&&ZY.URLUpdater.set(c.url);break;case"requests":ZY.ZDCPageNavigator&&ZY.ZDCPageNavigator.navigateToProfile(c.zid);break;case"game_invites":if(ZY.URLUpdater){var d="/play/"+c.game+"?zplay_joinkey="+c.joinkey+"&zplay_chat="+c.chatGroupId;ZY.URLUpdater.set(d)}var e={zid:ZY.Env.user.zid,counter:"ZDC_MP",kingdom:"toaster",phylum:"click_join","class":"wf",gameId:c.gameId,snId:1,clientId:6,snForUid:ZY.Constants.SN_FACEBOOK};ZY.ZTrack.log2(e);break;case"heat_test":ZY.Events.fire("ToasterClicked",a);break;default:}}a.hasOwnProperty("click")&&a.onclick.apply&&a.onclick()}),s.wire("closed",function(){y("toasterClicked",$.extend(a,{phylum:"close"}));if(n=="game_invites"&&a.clickData){var b=a.clickData,c={zid:ZY.Env.user.zid,counter:"ZDC_MP",kingdom:"toaster",phylum:"close","class":"wf",gameId:b.gameId,snId:1,clientId:6,snForUid:ZY.Constants.SN_FACEBOOK};ZY.ZTrack.log2(c)}ZY.Events.fire("ToasterClosed",k)}),s.wire("mouseenter",function(){p=!0}),s.wire("mouseleave",function(){p=!1,B(d,e)}),y("toasterViewed",a),f.unshift(s)})},a.isVisible=function(){return o},a.init=function(){ZY.Events.register("Comms.viewingConversation",function(a){a&&a.zid&&g.messages&&g.messages[a.zid]&&g.messages[a.zid].remove&&g.messages[a.zid].remove.apply&&g.messages[a.zid].remove()}),ZY.Barrier.done("ToasterManagerInit")},a.load=function(a,b){ZY.Barrier.once(["initUserService","ZY.Cache.StoreInit","rail_init"],function(){ZY.Rail.withRailWidget(function(a){t=a,t.wire("Changed:maximized",F),t.once(["content","min_created"],function(){function c(){++b,b===k.length&&ZY.Barrier.done("ToasterManagerLoad")}i=t.getToasterElement(!0),j=t.getToasterElement(!1);var a=ZY.Data.get({zid:ZY.Env.user.zid,key:ZY.Data.types.ALERTS},!0),b=0;if(a&&a.hasOwnProperty("queue")&&a.queue.length){k=a.queue;for(var d=0;d<k.length;d++)h(k[d],!0,c);k[0]&&k[0].hasOwnProperty("height")&&(u=k[0].height),t.openToaster(!1,$.noop,u),v(!0)}else ZY.Barrier.done("ToasterManagerLoad")})})})},a.add=function(a){var b=a.userInfo&&a.userInfo.zid?a.userInfo.zid:null,c=a.alertType?a.alertType:null;a.doNotQueue=a.doNotQueue?a.doNotQueue:!1;if(c){w(c);if(b&&g[c][b])return}if(p||l.length){l.push(a);return}A(a),h(a,!1)},a.demoToasters=function(b){var c=[{alertType:"requests",buttonLabel:"View Profile",userInfo:ZY.User,headline:"zFriend Request",subHeadline:'from <a href="#">Simon Tan</a>'},{alertType:"messages",buttonLabel:"Send Message",userInfo:{zid:40100062731},headline:"New Message",subHeadline:'from <a href="#">Dylan Long Name Sproule</a>'},{alertType:"notifications",buttonLabel:"View Post",userInfo:{zid:40100113195},headline:"Wall Post",subHeadline:'from <a href="#">Shane Hall</a>'}],d=0,e=0,f=setInterval(function(){e++;var b=$.extend({},c[d]);b.headline+=" #"+e,a.add(b),d++,d>=c.length&&(d=0)},b||3e3)},a}();}
if(!ZY.GameboardGameframe){ZY.Gameframe=ZY.GameboardGameframe=function(){function r(){return"game-frame-"+d.gameId+"-"+(new Date).getTime()}function s(a,b){e.push(setTimeout(a,b))}function t(){for(var a=0;a<e.length;a++)clearTimeout(e[a]);e=[]}function u(a){return a.win===ZCOM.Ifpc.findFrame(n)?(ZCOM.Ifpc.setDefaultTarget(a.id),!0):!1}function v(){f.set("offscreen",!1),f.wake()}function w(a,b){a.animate(b,p,"easeInOutQuart")}function x(){f.gameOnce("zFriends",function(){ZY.ZUI.require("widgets/zdc/services/socialgraph",function(a){a().getFriends({},function(a){var b=[],c,d,e=["fname","lname","zid","fbid"],g={fname:"n",lname:"l",zid:"z",fbid:"f"};for(var h in a)if(a.hasOwnProperty(h)){c={};var i=a[h];for(var j=0;j<e.length;j++){var k=e[j];i.hasOwnProperty(k)&&g.hasOwnProperty(e[j])&&(d=g[e[j]],c[d]=i[e[j]])}b.push(c)}f.gameSend("zFriends",b)})})})}function y(){f.set("authenticated",!0);var a=$(".zui_zdc_gameboard_game"),b=$("#rail-right-outer");b.css("display","block"),w(b,{right:"0"}),j.find(".zui_zdc_gameboard_game").removeClass("welcome-zynga"),x()}function z(a,e){if(e!=window.location.pathname)return;if(c)return;ZY.ZTrack.log(ZY.Env.user.zid,"ZDC_gameboard","rts_notloaded",a,d.gameId,ZY.BrowserDetector.OS,ZY.BrowserDetector.browser);var f=[],g=[],h=ZY.Barrier.debug();for(var i in h.handlers)h.handlers.hasOwnProperty(i)&&h.handlers[i].length&&g.push("NOT:"+i);for(i in h.lookup)h.lookup.hasOwnProperty(i)&&h.lookup[i]&&f.push("DONE:"+i);ZY.ZoomTrack.addData({timeout:a,OS:ZY.BrowserDetector.OS,browser:ZY.BrowserDetector.browser+", ver : "+ZY.BrowserDetector.version,hash:e,ifpc:b,doneBarriers:f,pendingBarriers:g}),ZY.ZoomTrack.send()}function A(a,b){var c=null;if(!a||!(c=a.split("?")[1]))return null;var d=c.split("&");for(var e=0,f=d.length;e<f;e++){var g=d[e].split("=");if(g.length==2&&g[0]==b)return g[1]}return null}function B(a){ZY.Controller.nannigansTracking("dau",!0),ZY.Controller.appnexusTracking("dau",!0),ZY.Env.gameboardInfo.hasPlayed||(ZY.Controller.nannigansTracking("appInstall",!0),ZY.Controller.appnexusTracking("install",!0)),ZY.ZUI.require(["widgets/zdc/gameboard/game"],function(b){f=b(),ZY.ZUIWidgetProxy.attach("widgets/zdc/gameboard/game",f),ZY.ZUIWidgetProxy.wire("modalOpen",function(){f.sleep()}),ZY.ZUIWidgetProxy.wire("modalClose",function(){f.wake()}),n=r(),f.set("gameInfo",d),f.set("id",n),f.getContent(function(a){a.appendTo(j),j.find(".zui_zdc_gameboard_game").addClass("welcome-zynga"),h=j.find(".zui_zdc_gameboard_game_game_frame").addClass("zy-game-frame"),f.set("offscreen",!1),window.gameController=f,f.set("attached",!0),ZY.ZAuth.authenticateGame()&&y(),f.gameOnce("session",function(){f.gameSend("session",o[d.gameId])}),f.gameOnce("handleFeed",function(){ZY.ZTrack.log2({value:(new Date).getTime()-i,counter:"ZDC_gameboard",kingdom:"handlefeed_ts","class":d.gameId,family:ZY.BrowserDetector.OS,genus:ZY.BrowserDetector.browser}),i=null,ZY.ZoomTrack.milestone("handleFeed.received")}),ZY.Barrier.done("ZyngaGameControllerReady")}),ZCOM.Ifpc.init({connectedCallback:u,subframes:{xdReceiverUrl:ZY.Env.public_uri+"/xd_receiver_zdc.html"}}),m=!0,a&&a(f)})}var a={},b,c,d,e=[],f,g,h,i,j,k,l,m=!1,n,o={},p=800,q="offscreen";return a.postSession=function(a){if(o.hasOwnProperty(d.gameId))return;o[d.gameId]=a,a=a||null;var e=$("<form></form>");e.attr("method","post"),e.attr("target",n),e.attr("action",decodeURI(d.framesrc)),$.each(a,function(a,b){var c=$("<input></input>");c.attr("type","hidden"),c.attr("name",a),c.attr("value",b),e.append(c)}),$(document.body).append(e),e.submit(),e.remove(),i=(new Date).getTime(),ZY.ZoomTrack.milestone("iframe.start.loading"),ZY.Barrier.once("ZY.User.userloaded",function(){ZY.ZTrack.log(ZY.Env.user.zid,"ZDC_gameboard","","","logged_in","view",d.gameId)}),d.railOpts.everybody&&A(location.search,"crt")!="feed"&&(b=!1,ZCOM.Ifpc.onWindowConnected(window.frames[f.get("id")],function(a){b=!0}),c=!1,f.gameOnce("handleFeed",function(){c=!0}))},a.unload=function(){ZY.Barrier.undone("ZyngaGameControllerReady"),t(),ZY.ZDCPageNavigator.getCurrentPage()!="play"&&setTimeout(function(){f&&(f.sleep(),f.set("offscreen",!0))},0)},a.init=function(){ZY.Events.register("RemoveGameFrame",function(){j&&j.html("")})},a.load=function(a,b,c){function e(a){var b=ZY.Events,c=d.gameId,e={75:"cityville",118:"farmville2",223:"castleville",240:"chefville",241:"coasterville"},f=e[c],g="zy-starting-point-"+f,h="zy-starting-point "+g,i=ZY.ZUI;k.addClass(h),i.require("widgets/zdc/startingpoint/layout1",function(){function o(){a.gameSend("closeZSC",{})}function p(){o(),a.showingStartingPoint(!1),k.removeClass(h),f.die(),b.unregister("ZyngaOnPageLoaded",e)}var e,f=i.getInstance("widgets/zdc/startingpoint/layout1"),g=+d.userLevel,j=+c===118,l=j?"zdcSpVideoAdFarm2":"zdcSpVideoAd",m=+ZY.Env.experiments[l]===1,n=m&&g>1&&!d.userPayer||document.location.search.indexOf("showSPVid=")>0;f.setGameID(c),n&&f.showVideoAd(),f.getContent(function(a){a.appendTo(k)}),e=function(a){a!=="play"&&p()},f.once("dismiss",p),a.showingStartingPoint(!0),f.once("progress",function(b){var c=i.atom();a.gameListen("gameLoading",function(a){var d=a&&a.percent;d&&(b.increaseTo(d),d>=50&&c.set("50+"),d>=100&&c.set("100"))}),c.once("50+",o),c.once("100",o)}),f.once("inbox",function(b){b.onOutgoingGameMessage(a.gameSend),$.each(["inboxMessages","inboxFollowUp","inboxZeroStateStrings"],function(c,d){a.gameListen(d,function(a){b.incomingGameMessage(d,a)})})}),b.register("ZyngaOnPageLoaded",e)}),ZY.Rail.withRailWidget(function(a){a.set("maximized",!0)})}a.remove(),j||(j=$(".zy-game-frame-wrapper"),k=$(".main-wrapper"),l=$(".main-bg-wrapper")),d=ZY.Gameboard.getInfo(),ZY.ZUI.require("widgets/zdc/services/gameboard",function(a){g=a(),g.wire("gameboard.attached",function(a){j.css("display","block"),d=ZY.Gameboard.getInfo(),d.fixedHeight&&j.css("minHeight",d.fixedHeight)}),g.wire("gameboard.asleep",function(a){j.css("display","none"),l.css("height","auto")}),g.wire("gameboard.awake",function(a){j.css("display","block")}),ZY.Data.viewing.page="gameboard";if(ZY.Env.user.auth===!1)ZY.FtueView.renderWelcomeZDC();else if(d.needsCaptchaVerification)ZY.CaptchaView.showCaptchaView(function(){window.location.reload()});else if(ZY.Env.experiments.ZDC_concept_heattest&&!ZY.Util.getCookie("ZDC_heatTestCookie"))ZY.HeatTest.showHeatTest();else{if(m){var b=g.getGameId();if(b==d.gameId){v(),f.get("authenticated")||ZY.ZAuth.authenticateGame()&&y();return}o={},f.set("authenticated",!1),ZY.Barrier.undone("Gameboard.sessionReceived"),h.removeAttr("src")}j.html(""),ZY.Env.gameboardInfo.offerConnect?(ZY.referencedGame=ZY.Env.gameboardInfo.gameId,ZY.GameboardFtueView.showDeferredConnect(B)):B(function(a){d.hasPlayed&&+d.startingPoint===1&&e(a)})}})},a}();}
if(!ZY.GameboardFtueView){ZY.FtueView=ZY.GameboardFtueView=function(){function g(){d===0&&(d=1,window.gameController.moveOnscreen(!1))}function h(){d==1&&(d=0,window.gameController.moveOnscreen(!0))}function i(){b===null&&ZY.ZUI.require("widgets/zdc/common/smartshield",function(){b=ZY.ZUI.getInstance("widgets/zdc/common/smartshield"),b.set({specialOverlay:{top:0,width:0,height:0}}),b.getContent(function(a){$("body").append(a)})})}function j(){b!==null&&(b.die(),b=null)}function k(){ZY.ZUI.require("widgets/zdc/zauth/registration",function(){f=ZY.ZUI.getInstance("widgets/zdc/zauth/registration"),f.set({gameLandingUrl:"/game/"+ZY.ZDCPageNavigator.getPageParam(),publicUri:ZY.Env.public_uri,style:"small"}),f.wire("user_close",function(a){ZY.Events.fire("registrationDialogClosed")}),f.wire("registration_success",function(a){ZY.Controller.nannigansTracking("regSubmit",!1),ZY.Controller.googleTracking("84i8CKbNsAQQws6N4gM"),ZY.Controller.appnexusTracking("registration",!1)}),f.getContent(function(a){e.addContent(a)})})}function l(){ZY.ZUI.require("widgets/zdc/profile/rwelcomewfn",function(){e=ZY.ZUI.getInstance("widgets/zdc/profile/rwelcomewfn"),e.set({backgroundUrl:ZY.Env.gameboardInfo.gameBackgroundPath,shown:!0,overlayOffsets:{bottom:"20px"}}),e.getContent(function(a){$("#content").append(a),e.open(),k()})})}function m(a){ZY.ZUI.require("widgets/zdc/gameboard/deferredconnect/continueGame",function(){var b=ZY.ZUI.getInstance("widgets/zdc/gameboard/deferredconnect/continueGame");b.wire("userFbConnect",function(b){a()}),b.wire("noFbConnect",function(b){a()}),b.getContent(function(a){c.changeContent(a)})})}function n(a){ZY.ZUI.require("widgets/zdc/gameboard/deferredconnect/haveYouPlayed",function(){var b=ZY.ZUI.getInstance("widgets/zdc/gameboard/deferredconnect/haveYouPlayed");b.set("fname",ZY.Env.user.firstName),b.set("gid",ZY.Env.gameboardInfo.gameId),b.wire("userPlayedGid",function(b){m(a)}),b.wire("neverPlayedGid",function(b){a()}),b.getContent(function(a){c.changeContent(a)})})}function o(a){var b=!1,d=function(){b||(c.changeContent(""),c.die(),b=!0,a())};ZY.ZUI.require("widgets/zdc/gameboard/gamebackground",function(){c=ZY.ZUI.getInstance("widgets/zdc/gameboard/gamebackground"),c.set("backgroundUrl",ZY.Env.gameboardInfo.gameBackgroundPath),c.getContent(function(a){$("#content").append(a),ZY.Env.disableFbConnect==1?d():n(d)})})}var a={},b=null,c,d=0,e,f;return a.showOverlayFreezeGame=g,a.hideOverlayUnfreezeGame=h,a.showSmartShield=i,a.hideSmartShield=j,a.renderWelcomeZDC=l,a.showDeferredConnect=o,a.unload=function(){e&&e.removeContent()},a.load=function(){},a}();}
if(!ZY.GameboardCaptchaView){ZY.CaptchaView=ZY.GameboardCaptchaView=function(){function d(a,b,c){ZY.Server.get(ZY.Env.common_web_prefix+"zauth_user_CaptchaVerifier",{resp:a,chall:b,gid:c},function(a){a=="1"?Recaptcha.callback():Recaptcha.reload()})}function e(a,b){Recaptcha.create(c,a,{theme:"red",lang:b,callback:Recaptcha.focus_response_field})}function f(a){ZY.ZUI.require("widgets/zdc/gameboard/captchaview",function(){var c=ZY.ZUI.getInstance("widgets/zdc/gameboard/captchaview");Recaptcha.captchaVerify=d,Recaptcha.callback=a,Recaptcha.captchaCreate=e,c.set({fname:ZY.Env.user.firstName,gid:ZY.Env.gameboardInfo.gameId,recaptchaObject:Recaptcha}),c.getContent(function(a){b.changeContent(a,c)})})}function g(a){var c=!1,d=function(){c||(b.changeContent(""),b.die(),c=!0,a())};ZY.ZUI.require("widgets/zdc/gameboard/gamebackground",function(){b=ZY.ZUI.getInstance("widgets/zdc/gameboard/gamebackground"),b.set("backgroundUrl",ZY.Env.gameboardInfo.gameBackgroundPath),b.getContent(function(a){a.appendTo($("#content")),f(d)})})}var a={},b,c;return a.renderCaptchaView=f,a.showCaptchaView=g,a.unload=function(){},a.load=function(a,b,d){c=b.public_key},a}();}
if(!ZY.GameboardHeatTest){ZY.HeatTest=function(){function c(){ZY.ZUI.require("widgets/zdc/common/heatTest",function(){var a=ZY.ZUI.getInstance("widgets/zdc/common/heatTest");a.getContent(function(a){$("body").append(a)}),a.wire("heatTestclick",function(a){window.location.reload()})})}function d(a){var d=!1,e=function(){d||(b.changeContent(""),b.die(),d=!0)};ZY.ZUI.require("widgets/zdc/gameboard/gamebackground",function(){b=ZY.ZUI.getInstance("widgets/zdc/gameboard/gamebackground"),b.set("backgroundUrl",ZY.Env.gameboardInfo.gameBackgroundPath),b.getContent(function(a){a.appendTo($("#content")),c()})})}var a={},b;return a.renderHeatTest=c,a.showHeatTest=d,a.unload=function(){},a.load=function(){},a}();}

;
if (typeof ZY.Boot.loaded == "function") { 
	ZY.Boot.loaded({"id":"zyc--profile-a3b34c0871dc2fd51eec5559b68f709d-en_US","includes":["Rail","ToasterManager","Gameboard\/Gameframe","Gameboard\/FtueView","Gameboard\/CaptchaView","Gameboard\/HeatTest"]});
}