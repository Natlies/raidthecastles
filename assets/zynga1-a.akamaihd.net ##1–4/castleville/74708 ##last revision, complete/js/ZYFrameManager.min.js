(function(){var o=function(V){return ZY.PrepareURL(V)+"&overlayed=true&"+(new Date()-0)+"#overlay"};var x,n,z,P=["zSurvey/survey.php"],O,h,j,H,i,d,E={},l,S=q();var b=function(){H.remove();if(l){D(l);l=null}};var s=function(W){if(W&&W.target){var V=$(W.target);if(!V.is("a")){V=V.parents("a")}F(V.attr("href"));i.children("a").parent().removeClass("selected");V.parent().addClass("selected");return false}};var I=function(V){$("#tabs li."+V+" > a").trigger("click")};var w=function(){return $("<iframe/>",{scrolling:"no",border:"0",frameborder:"0",height:"0"})};var t=function(){x=$("#appFrame");z=$("#flashFrame");O=$("#loadingFrame");h=$("#htmlFrame");d=$("#flashTab");n=$("#genericOverlay")};$(function(){i=$("#tabs li");i.children("a").not(".skipZyParams").click(s);$("#z_lang_button").click(U);t()});var k=function(){window.location.hash="#notOnFlash";z.addClass("offscreen")};var c=function(){$("#languageMenuOverlay").hide();$("#z_lang").unbind("mouseleave");$("#z_lang").unbind("mouseenter");$("#z_lang_button").unbind("mouseleave");$("#z_lang").trigger("hide_z_lang")};var u=false;var N=function(){u=true;setTimeout(function(){if(u){c()}},500)};var U=function(){if(!$("#appFrame").hasClass("flashVisible")){M();$("#languageMenuOverlay").show();$("#z_lang").trigger("show_z_lang");return}if($("#languageMenuOverlay").is(":visible")){c()}else{$("#languageMenuOverlay").show();$("#z_lang").trigger("show_z_lang");$("#z_lang").bind("mouseenter",function(){u=false})}};var L=function(){h.addClass("offscreen")};var C=function(){O.addClass("offscreen")};var v=function(){C();k();h.removeClass("offscreen");x.removeClass("flashVisible")};var p=function(){L();k();O.show();O.removeClass("offscreen");x.removeClass("flashVisible")};var e=function(){L();C();z.removeClass("offscreen");z.show();x.addClass("flashVisible");H=j;j=false;i.children("a").parent().removeClass("selected");d.addClass("selected");setTimeout(b,1000)};var a,r,A;var J=function(Y){var V=Y.body,X=Y.documentElement;var W=Math.max(Math.max(V.offsetHeight,V.scrollHeight)+V.offsetTop,Math.max(X.offsetHeight,X.scrollHeight)+X.offsetTop);if(X.clientTop>0){W+=(X.clientTop*2)}return W};var B=function(){try{if(j==null||(j[0].contentWindow&&j[0].contentWindow.location.hash=="#switchToFlash")){e();clearInterval(a);a=null;j[0].contentWindow.location.hash="#switched"}else{if(!r||A==null||A==0){r=j[0].contentWindow.document}var V=J(r);if(V!=A){j.height(V);A=V}}}catch(W){}};var T=function(){j&&j.unbind("ready",T);v()};var F=function(V){if(V.match(/^#switchToFlash/)){M();return}t();if(E[V]){if(j){H=j;b()}j=E[V];l=V;E[V]=null;j.attr("height","").removeClass("preloaded");T()}else{p();if(!j){j=w().appendTo(h)}j.ready(T);j.attr("src",o(V))}r=null;A=0;a=setInterval(B,500)};var M=function(){a&&clearInterval(a);a=null;e()};var m=[];var D=function(W){var V=function(){var X=w();X.addClass("preloaded").attr("src",o(W)).appendTo(h).load(function(){E[W]=X})};m.push(V)};var G=function(){t();var V=m;m=[];setTimeout(function(){for(var W=0;W<V.length;++W){V[W]()}},5000)};var Q=function(){showScreenshot(0.25,3,805306368)};var f=function(){hideScreenshot()};var K=function(V){if(V){R()}else{e()}};var y=function(V,W){if(!S.isOpen()){Q();if(V){S.create(V,W)}n.css("margin-left",n.width()*-0.5);n.show()}};var R=function(){if(n.css("display")!="none"){n.hide();S.closeCurrent();f()}};window.ZYFrameManager={navigateTo:F,simulateTabClick:I,switchToFlash:M,openIFrame:F,preloadUrl:D,readyToPreload:G,freezeFlash:Q,unfreezeFlash:f,close:K,showDialogOverlay:y,hideDialogOverlay:R};function g(W){var Y,V,X,Z;Y=false;for(X=0;X<P.length;X+=1){if(W.search(P[X])!==-1){Y=true}}Z=new RegExp("^(http[s]?://)|(//)");V=new RegExp("^http[s]?://"+window.location.hostname);if(Y||W.search(/overlay=1/)!==-1||(W.search(Z)!==-1&&W.search(V)===-1)){return true}else{return false}}function q(){var V=false;function aa(){if(V){V.close()}}function Y(){return !!V}function X(ad,ag,ab){var ac,ah,af,ae;if(!V){if(typeof ag==="string"){ae="<h1><span>"+ag+"</span></h1>"}else{ae=""}af=$('<div class="overlay"><div class="contentWrapper">'+ae+'<div class="content"></div><a class="close"></a></div></div>');n.empty();af.appendTo(n);$("a.close",af).click(function(){K(true)});ah=$(".content",af);if(typeof ab!=="function"){ab=function(){}}if(g(ad)){ac=W(ad,ah,ab)}else{ac=Z(ad,ah,ab)}ac.close=function(){V=false};V=ac}}function Z(ac,ad,ab){var af,ae;af=$("<div/>",{"class":"tabFrame innerContent clearfix"});af.appendTo(ad);$.ajax({url:ac,dataType:"text",success:function(ag){if(af){af.append(ag);ab(af)}}});ae={};return ae}function W(ac,ad,ab){var af,ae;af=$("<iframe/>",{scrolling:"no",border:"0",frameborder:"0",width:"500px",height:"450px"});af.attr("src",o(ac)).one("load",function(){var ag;ab(af)}).appendTo(ad);ae={};return ae}return{create:X,closeCurrent:aa,isOpen:Y}}})();